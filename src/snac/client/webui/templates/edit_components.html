{% macro displayEditTabs(X, vertical) %}
    {% if vertical == true %}
    <ul class="nav nav-pills nav-stacked" role="tablist">
    {% else %}
    <ul class="nav nav-tabs" role="tablist">
    {% endif %}
        <li class="active"><a href="#nameEntries" id="nameEntriestab" role="tab" data-toggle="tab">Core Data</a></li>
        <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">History <span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="#biogHists" id="biogHiststab" role="tab" data-toggle="tab">BiogHist</a></li>
                <li><a href="#dates" id="existstab" role="tab" data-toggle="tab">Exist Dates</a></li>
                <li><a href="#places" id="placestab" role="tab" data-toggle="tab">Places</a></li>
                <li><a href="#generalContexts" id="generalContextstab" role="tab" data-toggle="tab">General Contexts</a></li>
                <li><a href="#structureOrGenealogies" id="structureOrGenealogiestab" role="tab" data-toggle="tab">Structure or Genealogies</a></li>
            </ul>
        </li>
        <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Demographics <span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="#genders" id="genderstab" role="tab" data-toggle="tab">Genders</a></li>
                <li><a href="#nationalities" id="nationalitiestab" role="tab" data-toggle="tab">Nationalities</a></li>
                <li><a href="#languagesUsed" id="languagesUsedtab" role="tab" data-toggle="tab">Languages Used</a></li>
                <li><a href="#occupations" id="occupationstab" role="tab" data-toggle="tab">Occupations</a></li>
                <li><a href="#subjects" id="subjectstab" role="tab" data-toggle="tab">Subjects</a></li>
            </ul>
        </li>
        <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Relations <span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="#resourceRelations" id="resourceRelationstab" role="tab" data-toggle="tab">Resource Relations</a></li>
                <li><a href="#constellationRelations" id="constellationRelationstab" role="tab" data-toggle="tab">Internal CPF Relations</a></li>
                <li><a href="#sameAs" id="sameAstab" role="tab" data-toggle="tab">External CPF (Same As)</a></li>
                <li><a href="#entityID" id="entityIDtab" role="tab" data-toggle="tab">Other Entity IDs (Same As)</a></li>
            </ul>
        </li>
        <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Corporate Description <span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="#functions" id="functionstab" role="tab" data-toggle="tab">Functions</a></li>
                <li><a href="#legalStatuses" id="legalStatusestab" role="tab" data-toggle="tab">Legal Statuses</a></li>
                <li><a href="#mandates" id="mandatestab" role="tab" data-toggle="tab">Mandates</a></li>
            </ul>
        </li>
        <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Control <span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="#sources" id="sourcestab" role="tab" data-toggle="tab" id="sources-tab">Sources</a></li>
                <li><a href="#conventionDeclarations" id="conventionDeclarationstab" role="tab" data-toggle="tab">Convention Declarations</a></li>
            </ul>
        </li>
    </ul>
{% endmacro %}



{% macro displayGender(X, inEdit, showSubElements, gender, i) %}
    {% import 'widgets.html' as widgets %}

        <div class="panel panel-default" id="gender_panel_{{i}}">
            <div class="panel-body">
                    <div class="col-sm-10" id="gender_datapart_{{i}}">
                        <input type="hidden" id="gender_id_{{i}}" name="gender_id_{{i}}" value="{{gender.id}}"/>
                        <input id="gender_version_{{i}}" name="gender_version_{{i}}" type="hidden" value="{{ gender.version}}"/>
                        <input id="gender_operation_{{i}}" name="gender_operation_{{i}}" type="hidden" value="{{ gender.operation}}"/>
                        <div class="form-group">
                            <label class="control-label col-xs-4" data-content="{{X.term.tooltip}}" data-toggle="popover" data-placement="top">
                               {{ X.term.display }}
                            </label>
                            <div class="col-xs-8" id="select_gender_term_{{i}}">
                                <input type="hidden" id="gender_term_id_{{i}}" name="gender_term_id_{{i}}" value="{{gender.term.id}}"/>
                                <input type="hidden" id="gender_term_term_{{i}}" name="gender_term_term_{{i}}" value="{{gender.term.term}}"/>
                                <input type="hidden" id="gender_term_vocabtype_{{i}}" name="gender_term_vocabtype_{{i}}" value="gender"/>
                                <input type="hidden" id="gender_term_minlength_{{i}}" name="gender_term_minlength_{{i}}" value="0"/>
                                <p class="form-control-static">{{ gender.term.term }}</p>
                            </div>
                        </div>
                        <!--
                        <div class="form-group">
                            <label class="control-label col-xs-2" data-content="{{X.uri.tooltip}}" data-toggle="popover" data-placement="top">
                                {{ X.uri.display }}
                            </label>
                            <div class="col-xs-8">
                                {{ widgets.displayURI(X, inEdit, showSubElements, gender.term.uri) }}
                            </div>
                        </div>
                        -->
                    </div>
                    {{ widgets.scmModal(X, inEdit, showSubElements, "gender", i, gender.term.term, "Gender", gender) }}
                    {{ widgets.optionsList(X, inEdit, showSubElements, "gender", i) }}
                </div>
            </div>

{% endmacro %}

{% macro displayNameEntry(X, inEdit, showSubElements, nameEntry, i, isPrimary) %}
    {% import 'widgets.html' as widgets %}
    {% import _self as components %}
        {% if not inEdit and isPrimary %}
        <div class="panel panel-primary" id="nameEntry_panel_{{i}}">
        {% else %}
        <div class="panel panel-default" id="nameEntry_panel_{{i}}">
        {% endif %}
        <div class="panel-body">
            <div class="col-sm-10" id="nameEntry_datapart_{{i}}">
                <input id="nameEntry_id_{{i}}" name="nameEntry_id_{{i}}" type="hidden" value="{{ nameEntry.id }}"/>
                <input id="nameEntry_version_{{i}}" name="nameEntry_version_{{i}}" type="hidden" value="{{ nameEntry.version }}"/>
                <input id="nameEntry_operation_{{i}}" name="nameEntry_operation_{{i}}" type="hidden" value="{{ nameEntry.operation }}"/>
                <div class="form-group">
                    <div class="col-xs-12">
                        <h4 class="text-center" id="nameEntry_heading_{{i}}">{{nameEntry.original}}</h4>
                        <input id="nameEntry_original_{{i}}" name="nameEntry_original_{{i}}" type="hidden" class="form-control" value="{{ nameEntry.original }}" readonly/>
                        <p class="caption text-center" style="font-size: 11px; font-style:italic; color: #777777; margin-top: 0px; padding-top: 0px;">Computed Name Heading</p>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-xs-12 well well-sm name-components" id="nameEntry_reorderable_{{i}}">
                        <p style="font-weight: bold;" class="text-center">Name Components</p>
                        {% set j = 0 %}
                        {% for component in nameEntry.components %}
                            {{ components.displayComponent(X, inEdit, showSubElements, component, i, j) }}
                            {% set j = j + 1 %}
                        {% endfor %}

                        <span id='nameEntry_component_next_j_{{i}}' style='display:none;'>{{j}}</span>

                        <div class="form-group" id="nameEntry_component_add_div_{{i}}">
                            <div class="col-xs-12 text-center">
                                <button class="btn btn-success snac-hidden" id="nameEntry_component_add_{{i}}"
                                    onClick="return newNameEntryComponent({{i}});" disabled>
                                    <span class="glyphicon glyphicon-plus-sign"></span> Add Component
                                </button>
                            </div>
                        </div>

                    </div>
                </div>
                {% if inEdit %}
                <div class="form-group">
                    <label for="nameEntry_preferenceScore_{{ i }}" class="control-label col-xs-4" data-content="{{X.preferenceScore.tooltip}}" data-toggle="popover" data-placement="top">
                        {{ X.preferenceScore.display }}
                    </label>
                    <div class="col-xs-8" id="checkbox_nameEntry_preferenceScore_{{i}}">
                        <input id="nameEntry_preferenceScore_{{i}}" name="nameEntry_preferenceScore_{{i}}" type="hidden" class="form-control" value="{{ isPrimary ? 'checked' }}"/>
                        <input id="nameEntry_preferenceScore_placeholderOn_{{i}}" type="hidden" class="form-control" value="Preferred"/>
                        <input id="nameEntry_preferenceScore_placeholderOff_{{i}}" type="hidden" class="form-control" value="Not Preferred"/>
                        <p class="form-control-static">{{ isPrimary ? 'Preferred' : 'Not Preferred' }}</p>
                    </div>
                </div>
                {% endif %}

                {% if inEdit or nameEntry.language %}
                <input type="hidden" id="nameEntry_language_id_{{i}}" name="nameEntry_language_id_{{i}}" value="{{nameEntry.language.id}}"/>
                <input type="hidden" id="nameEntry_language_version_{{i}}" name="nameEntry_language_version_{{i}}" value="{{nameEntrys.language.version}}"/>
                <div class="form-group">
                    <label class="control-label col-xs-4" data-content="{{X.language.tooltip}}" data-toggle="popover" data-placement="top">
                        {{ X.language.display }}
                    </label>
                    <div class="col-xs-8">
                        <div class="input-group select2-bootstrap-append">
                            <div id="select_nameEntry_languagelanguage_{{i}}">
                                <input id="nameEntry_languagelanguage_id_{{i}}" name="nameEntry_languagelanguage_id_{{i}}" type="hidden" class="form-control" value="{{ nameEntry.language.language.id }}"/>
                                <input id="nameEntry_languagelanguage_term_{{i}}" name="nameEntry_languagelanguage_term_{{i}}" type="hidden" class="form-control" value="{{ nameEntry.language.language.term }}"/>
                                <input id="nameEntry_languagelanguage_vocabtype_{{i}}" name="nameEntry_languagelanguage_vocabtype_{{i}}" type="hidden" class="form-control" value="language_code"/>
                                <input id="nameEntry_languagelanguage_minlength_{{i}}" name="nameEntry_languagelanguage_minlength_{{i}}" type="hidden" class="form-control" value="0"/>
                                <p class="form-control-static">{{ nameEntry.language.language.term }}</p>
                            </div>
                            <span class="input-group-btn">
                                <button class="btn btn-primary snac-hidden"
                                    id="nameEntry_languagelanguage_magic_{{i}}" disabled
                                    onClick="magicDefaultFill('nameEntry_languagelanguage_id_{{i}}', 'language'); return false;"
                                    title="Apply user's default value">
                                    <i class="fa fa-magic" aria-hidden="true"></i>
                                </button>
                            </span>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-xs-4" data-content="{{X.script.tooltip}}" data-toggle="popover" data-placement="top">
                        {{ X.script.display }}
                    </label>
                    <div class="col-xs-8">
                        <div class="input-group select2-bootstrap-append">
                            <div id="select_nameEntry_languagescript_{{i}}">
                                <input id="nameEntry_languagescript_id_{{i}}" name="nameEntry_languagescript_id_{{i}}" type="hidden" class="form-control" value="{{ nameEntry.language.script.id }}"/>
                                <input id="nameEntry_languagescript_term_{{i}}" name="nameEntry_languagescript_term_{{i}}" type="hidden" class="form-control" value="{{ nameEntry.language.script.term }}"/>
                                <input id="nameEntry_languagescript_vocabtype_{{i}}" name="nameEntry_languagescript_vocabtype_{{i}}" type="hidden" class="form-control" value="script_code"/>
                                <input id="nameEntry_languagescript_minlength_{{i}}" name="nameEntry_languagescript_minlength_{{i}}" type="hidden" class="form-control" value="0"/>
                                <p class="form-control-static">{{ nameEntry.language.script.term }}</p>
                            </div>
                            <span class="input-group-btn">
                                <button class="btn btn-primary snac-hidden"
                                    id="nameEntry_languagescript_magic_{{i}}" disabled
                                    onClick="magicDefaultFill('nameEntry_languagescript_id_{{i}}', 'script'); return false;"
                                    title="Apply user's default value">
                                    <i class="fa fa-magic" aria-hidden="true"></i>
                                </button>
                            </span>
                        </div>
                    </div>
                </div>
                {% endif %}
                <div class="form-group">
                    <label class="control-label col-xs-4" data-content="{{X.rules.tooltip}}" data-toggle="popover" data-placement="top">
                        {{ X.rules.display }}
                    </label>
                    <div class="col-xs-8 well well-sm">
                        {% set j = 0 %}
                        {% for contributor in nameEntry.contributors %}
                            {{ components.displayNameRule(X, inEdit, showSubElements, contributor, i, j) }}
                            {% set j = j + 1 %}
                        {% endfor %}
                        <span id='nameEntry_rule_next_j_{{i}}' style='display:none;'>{{j}}</span>

                        <div class="form-group" id="nameEntry_rule_add_div_{{i}}">
                            <div class="col-xs-12 text-center">
                                <button class="btn btn-success snac-hidden" id="nameEntry_rule_add_{{i}}"
                                    onClick="return newNameEntryRule({{i}});" disabled>
                                    <span class="glyphicon glyphicon-plus-sign"></span> Add Rule
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            {{ widgets.dateModal(X, inEdit, showSubElements, "nameEntry", i, nameEntry.original, "Name Entry", nameEntry) }}
            {{ widgets.scmModal(X, inEdit, showSubElements, "nameEntry", i, nameEntry.original, "Name Entry", nameEntry) }}
            {{ widgets.optionsListWithDate(X, inEdit, showSubElements, "nameEntry", i) }}
        </div>
    </div>

{% endmacro %}

{% macro displayComponent(X, inEdit, showSubElements, component, i, j) %}
        <div class="col-xs-12 reorderable" id="nameEntry_component_{{j}}_panel_{{i}}" style="padding-top: 5px; padding-bottom: 5px;">
            <div id="nameEntry_component_{{j}}_datapart_{{i}}">
                <input type="hidden" id="nameEntry_component_{{j}}_id_{{i}}"
                    name="nameEntry_component_{{j}}_id_{{i}}"
                    value="{{component.id}}"/>
                <input type="hidden" id="nameEntry_component_{{j}}_version_{{i}}"
                    name="nameEntry_component_{{j}}_version_{{i}}"
                    value="{{component.version}}"/>
                <input type="hidden" id="nameEntry_component_{{j}}_operation_{{i}}"
                    name="nameEntry_component_{{j}}_operation_{{i}}"
                    value="{{component.operation}}"/>
                <input type="hidden" class="order-index" id="nameEntry_component_{{j}}_order_{{i}}"
                    name="nameEntry_component_{{j}}_order_{{i}}"
                    value="{{j}}"/>
                <div>
                    <div class="input-group select2-bootstrap-append">
                        <span class="input-group-addon move-handle sizing-addon3 snac-hidden"><i class="fa fa-bars" aria-hidden="true"></i>
                        </span>
                        <div id="select_nameEntry_component_{{j}}_type_{{i}}" style="width: 30%">
                            <input id="nameEntry_component_{{j}}_type_id_{{i}}"
                                name="nameEntry_component_{{j}}_type_id_{{i}}"
                                type="hidden" class="form-control"
                                value="{{ component.type.id }}"/>
                            <input id="nameEntry_component_{{j}}_type_term_{{i}}"
                                name="nameEntry_component_{{j}}_type_term_{{i}}"
                                type="hidden" class="form-control"
                                value="{{ component.type.term }}"/>
                            <input id="nameEntry_component_{{j}}_type_vocabtype_{{i}}"
                                name="nameEntry_component_{{j}}_type_vocabtype_{{i}}"
                                type="hidden" class="form-control" value="name_component"/>
                            <input id="nameEntry_component_{{j}}_type_minlength_{{i}}"
                                name="nameEntry_component_{{j}}_type_minlength_{{i}}"
                                type="hidden" class="form-control" value="0"/>
                            <input id="nameEntry_component_{{j}}_type_placeholder_{{i}}"
                                type="hidden" value="Part"/>
                            <p class="form-control-static name-component-type">{{ component.type.term }} :</p>
                        </div>
                        <div id="text_nameEntry_component_{{j}}_text_{{i}}" style="width: 70%; clear: none; float: left;">
                        <!--<input type="text" name="nameEntry_component_{{j}}_text_{{i}}" id="nameEntry_component_{{j}}_text_{{i}}"
                            class="form-control" style="width: 50%" onKeyUp="updateNameEntryHeading({{i}})"
                            value="{{ component.text  }}" readOnly>-->
                            <input type="hidden" name="nameEntry_component_{{j}}_text_{{i}}" id="nameEntry_component_{{j}}_text_{{i}}"
                                class="form-control" value="{{ component.text }}">
                            <input type="hidden" id="nameEntry_component_{{j}}_text_onKeyUp_{{i}}"
                                class="form-control" value="updateNameEntryHeading({{i}})">
                            <p class="form-control-static">{{ component.text }}</p>
                        </div>


                        <span class="input-group-btn">
                            <button class="btn btn-danger snac-hidden"
                                id="nameEntry_component_{{j}}_remove_{{i}}" disabled
                                onClick="setRepeatedDataDeleted('nameEntry_component_{{j}}', '{{i}}'); updateNameEntryHeading('{{i}}'); return false;">
                                <span class="glyphicon glyphicon-minus-sign"></span>
                            </button>
                        </span>
                    </div>
                </div>
            </div>
        </div>

{% endmacro %}

{% macro displayNameRule(X, inEdit, showSubElements, rule, i, j) %}
        <div class="col-xs-12" id="nameEntry_rule_{{j}}_panel_{{i}}" style="padding-top: 5px; padding-bottom: 5px;">
            <div id="nameEntry_rule_{{j}}_datapart_{{i}}">
                <input type="hidden" id="nameEntry_rule_{{j}}_id_{{i}}"
                    name="nameEntry_rule_{{j}}_id_{{i}}"
                    value="{{rule.id}}"/>
                <input type="hidden" id="nameEntry_rule_{{j}}_version_{{i}}"
                    name="nameEntry_rule_{{j}}_version_{{i}}"
                    value="{{rule.version}}"/>
                <input type="hidden" id="nameEntry_rule_{{j}}_operation_{{i}}"
                    name="nameEntry_rule_{{j}}_operation_{{i}}"
                    value="{{rule.operation}}"/>
                <input id="nameEntry_rule_{{j}}_name_{{i}}"
                    name="nameEntry_rule_{{j}}_name_{{i}}"
                    type="hidden" value="{{rule.name}}">
                <div>
                    <div class="input-group select2-bootstrap-append">
                        <div id="select_nameEntry_rule_{{j}}_type_{{i}}" style="width: 50%">
                            <input id="nameEntry_rule_{{j}}_type_id_{{i}}"
                                name="nameEntry_rule_{{j}}_type_id_{{i}}"
                                type="hidden" class="form-control"
                                value="{{ rule.type.id }}"/>
                            <input id="nameEntry_rule_{{j}}_type_term_{{i}}"
                                name="nameEntry_rule_{{j}}_type_term_{{i}}"
                                type="hidden" class="form-control"
                                value="{{ rule.type.term }}"/>
                            <input id="nameEntry_rule_{{j}}_type_vocabtype_{{i}}"
                                name="nameEntry_rule_{{j}}_type_vocabtype_{{i}}"
                                type="hidden" class="form-control" value="name_type"/>
                            <input id="nameEntry_rule_{{j}}_type_minlength_{{i}}"
                                name="nameEntry_rule_{{j}}_type_minlength_{{i}}"
                                type="hidden" class="form-control" value="0"/>
                            <input id="nameEntry_rule_{{j}}_type_placeholder_{{i}}"
                                   type="hidden" value="{{X.rulesForm.display}}"/>
                            <p class="form-control-static">{{ rule.type.term }}</p>
                        </div>
                        <div id="select_nameEntry_rule_{{j}}_rule_{{i}}" style="width:50%; clear: none; float: left;">
                            <input id="nameEntry_rule_{{j}}_rule_id_{{i}}"
                                name="nameEntry_rule_{{j}}_rule_id_{{i}}"
                                type="hidden" class="form-control"
                                value="{{ rule.rule.id }}"/>
                            <input id="nameEntry_rule_{{j}}_rule_term_{{i}}"
                                name="nameEntry_rule_{{j}}_rule_term_{{i}}"
                                type="hidden" class="form-control"
                                value="{{ rule.rule.term }}"/>
                            <input id="nameEntry_rule_{{j}}_rule_vocabtype_{{i}}"
                                name="nameEntry_rule_{{j}}_rule_vocabtype_{{i}}"
                                type="hidden" class="form-control" value="name_rule"/>
                            <input id="nameEntry_rule_{{j}}_rule_minlength_{{i}}"
                                name="nameEntry_rule_{{j}}_rule_minlength_{{i}}"
                                type="hidden" class="form-control" value="0"/>
                            <input id="nameEntry_rule_{{j}}_rule_placeholder_{{i}}"
                                   type="hidden" value="{{X.rulesSet.display}}"/>
                            <p class="form-control-static">
                            {% if rule.rule.term %}
                                {{ rule.rule.term }}
                            {% elseif rule.name %}
                                unknown ({{rule.name}})
                            {% else %}
                                unknown
                            {% endif %}
                            </p>
                        </div>

                        <span class="input-group-btn">
                            <button class="btn btn-danger snac-hidden"
                                id="nameEntry_rule_{{j}}_remove_{{i}}" disabled
                                onClick="setRepeatedDataDeleted('nameEntry_rule_{{j}}', '{{i}}'); return false;">
                                <span class="glyphicon glyphicon-minus-sign"></span>
                            </button>
                        </span>
                    </div>
                </div>
            </div>
        </div>

{% endmacro %}



{% macro displayContributor(X, inEdit, showSubElements, contributor, i, j) %}
        <div class="panel panel-body" id="nameEntry_contributor_{{j}}_panel_{{i}}">
            <input type="hidden" id="nameEntry_contributor_{{j}}_id_{{i}}"
                name="nameEntry_contributor_{{j}}_id_{{i}}"
                value="{{contributor.id}}"/>
            <input type="hidden" id="nameEntry_contributor_{{j}}_version_{{i}}"
                name="nameEntry_contributor_{{j}}_version_{{i}}"
                value="{{contributor.version}}"/>
            <input type="hidden" id="nameEntry_contributor_{{j}}_operation_{{i}}"
                name="nameEntry_contributor_{{j}}_operation_{{i}}"
                value="{{contributor.operation}}"/>
            <div class="form-group">
                <label class="control-label col-xs-4" data-content="{{X.contributorName.tooltip}}" data-toggle="popover" data-placement="top">
                    {{ X.contributorName.display }}
                </label>
                <div class="col-xs-6">
                    <input id="nameEntry_contributor_{{j}}_name_{{i}}"
                        name="nameEntry_contributor_{{j}}_name_{{i}}"
                        class="form-control" value="{{contributor.name}}"
                        readonly>
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-xs-4" data-content="{{X.contributorType.tooltip}}" data-toggle="popover" data-placement="top">
                    {{ X.contributorType.display }}
                </label>
                <div class="col-xs-6" id="select_nameEntry_contributor_{{j}}_type_{{i}}">
                    <input id="nameEntry_contributor_{{j}}_type_id_{{i}}"
                        name="nameEntry_contributor_{{j}}_type_id_{{i}}"
                        type="hidden" class="form-control"
                        value="{{ contributor.type.id }}"/>
                    <input id="nameEntry_contributor_{{j}}_type_term_{{i}}"
                        name="nameEntry_contributor_{{j}}_type_term_{{i}}"
                        type="hidden" class="form-control"
                        value="{{ contributor.type.term }}"/>
                    <input id="nameEntry_contributor_{{j}}_type_vocabtype_{{i}}"
                        name="nameEntry_contributor_{{j}}_type_vocabtype_{{i}}"
                        type="hidden" class="form-control" value="name_type"/>
                    <input id="nameEntry_contributor_{{j}}_type_minlength_{{i}}"
                        name="nameEntry_contributor_{{j}}_type_minlength_{{i}}"
                        type="hidden" class="form-control" value="0"/>
                    <p class="form-control-static">{{ contributor.type.term }}</p>
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-xs-4" data-content="{{X.contributorRules.tooltip}}" data-toggle="popover" data-placement="top">
                    {{ X.contributorRules.display }}
                </label>
                <div class="col-xs-6" id="select_nameEntry_contributor_{{j}}_rule_{{i}}">
                    <input id="nameEntry_contributor_{{j}}_rule_id_{{i}}"
                        name="nameEntry_contributor_{{j}}_rule_id_{{i}}"
                        type="hidden" class="form-control"
                        value="{{ contributor.rule.id }}"/>
                    <input id="nameEntry_contributor_{{j}}_rule_term_{{i}}"
                        name="nameEntry_contributor_{{j}}_rule_term_{{i}}"
                        type="hidden" class="form-control"
                        value="{{ contributor.rule.term }}"/>
                    <input id="nameEntry_contributor_{{j}}_rule_vocabtype_{{i}}"
                        name="nameEntry_contributor_{{j}}_rule_vocabtype_{{i}}"
                        type="hidden" class="form-control" value="name_rule"/>
                    <input id="nameEntry_contributor_{{j}}_rule_minlength_{{i}}"
                        name="nameEntry_contributor_{{j}}_rule_minlength_{{i}}"
                        type="hidden" class="form-control" value="0"/>
                    <p class="form-control-static">{{ contributor.rule.term }}</p>
                </div>
            </div>
            <div class="text-center">
                <button class="btn btn-danger snac-hidden"
                    id="nameEntry_contributor_{{j}}_remove_{{i}}"
                    onClick="return setRepeatedDataDeleted('nameEntry_contributor_{{j}}', '{{i}}');" disabled>
                    <span class="glyphicon glyphicon-minus-sign"></span> Remove
                </button>
            </div>
        </div>

{% endmacro %}

{% macro displaySameAs(X, inEdit, showSubElements, other, i) %}
    {% import 'widgets.html' as widgets %}
        <div class="panel panel-default" id="sameAs_panel_{{i}}">
            <div class="panel-body">
                <div class="col-sm-10" id="sameAs_datapart_{{i}}">
                    <input id="sameAs_id_{{i}}" name="sameAs_id_{{i}}" type="hidden" value="{{ other.id }}"/>
                    <input id="sameAs_version_{{i}}" name="sameAs_version_{{i}}" type="hidden" value="{{ other.version }}"/>
                    <input id="sameAs_operation_{{i}}" name="sameAs_operation_{{i}}" type="hidden" value="{{ other.operation }}"/>
                    <div class="form-group">
                        <label for="sameAs_text_{{ i }}" class="control-label col-xs-4" data-content="{{X.sameAsText.tooltip}}" data-toggle="popover" data-placement="top">
                           {{ X.sameAsText.display }}
                        </label>
                        <div class="col-xs-8" id="text_sameAs_text_{{i}}">
                            <input id="sameAs_text_{{i}}" name="sameAs_text_{{i}}" type="hidden" class="form-control" value="{{ other.text }}"/>
                            <p class="form-control-static">{{ other.text }}</p>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="sameAs_type_{{ i }}" class="control-label col-xs-4" data-content="{{X.sameAsRole.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.sameAsRole.display }}
                        </label>
                        <div class="col-xs-8" id="select_sameAs_type_{{i}}">
                            <input id="sameAs_type_id_{{i}}" name="sameAs_type_id_{{i}}" type="hidden" class="form-control" value="{{ other.type.id }}"/>
                            <input id="sameAs_type_term_{{i}}" name="sameAs_type_term_{{i}}" type="hidden" class="form-control" value="{{ other.type.term }}"/>
                            <input id="sameAs_type_vocabtype_{{i}}" name="sameAs_type_vocabtype_{{i}}" type="hidden" class="form-control" value="record_type"/>
                            <input id="sameAs_type_minlength_{{i}}" name="sameAs_type_minlength_{{i}}" type="hidden" class="form-control" value="0"/>
                            <p class="form-control-static">{{ other.type.term }}</p>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="sameAs_uri_{{ i }}" class="control-label col-xs-4" data-content="{{X.sameAsURI.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.sameAsURI.display }}
                        </label>
                        <div class="col-xs-8" id="text_sameAs_uri_{{i}}">
                            <input id="sameAs_uri_{{i}}" name="sameAs_uri_{{i}}" type="hidden" class="form-control" value="{{ other.uri }}"/>
                            <p class="form-control-static">{{ other.uri }}</p>
                        </div>
                    </div>
                </div>

                {{ widgets.scmModal(X, inEdit, showSubElements, "sameAs", i, other.uri, "Same-As Relation", other) }}
                {{ widgets.optionsList(X, inEdit, showSubElements, "sameAs", i) }}
            </div>
        </div>

{% endmacro %}

{% macro displayEntityID(X, inEdit, showSubElements, other, i) %}
    {% import 'widgets.html' as widgets %}
        <div class="panel panel-default" id="entityID_panel_{{i}}">
            <div class="panel-body">
                <div class="col-sm-10" id="entityID_datapart_{{i}}">
                    <input id="entityID_id_{{i}}" name="entityID_id_{{i}}" type="hidden" value="{{ other.id }}"/>
                    <input id="entityID_version_{{i}}" name="entityID_version_{{i}}" type="hidden" value="{{ other.version }}"/>
                    <input id="entityID_operation_{{i}}" name="entityID_operation_{{i}}" type="hidden" value="{{ other.operation }}"/>
                    <div class="form-group">
                        <label for="entityID_text_{{ i }}" class="control-label col-xs-4" data-content="{{X.entityIdText.tooltip}}" data-toggle="popover" data-placement="top">
                           {{ X.entityIdText.display }}
                        </label>
                        <div class="col-xs-8" id="text_entityID_text_{{i}}">
                            <input id="entityID_text_{{i}}" name="entityID_text_{{i}}" type="hidden" class="form-control" value="{{ other.text }}"/>
                            <p class="form-control-static">{{ other.text }}</p>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="entityID_type_{{ i }}" class="control-label col-xs-4" data-content="{{X.entityIdType.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.entityIdType.display }}
                        </label>
                        <div class="col-xs-8" id="select_entityID_type_{{i}}">
                            <input id="entityID_type_id_{{i}}" name="entityID_type_id_{{i}}" type="hidden" class="form-control" value="{{ other.type.id }}"/>
                            <input id="entityID_type_term_{{i}}" name="entityID_type_term_{{i}}" type="hidden" class="form-control" value="{{ other.type.term }}"/>
                            <input id="entityID_type_vocabtype_{{i}}" name="entityID_type_vocabtype_{{i}}" type="hidden" class="form-control" value="entityid_type"/>
                            <input id="entityID_type_minlength_{{i}}" name="entityID_type_minlength_{{i}}" type="hidden" class="form-control" value="0"/>
                            <p class="form-control-static">{{ other.type.term }}</p>
                        </div>
                    </div>
                </div>

                {{ widgets.scmModal(X, inEdit, showSubElements, "entityID", i, other.text, "Entity ID", other) }}
                {{ widgets.optionsList(X, inEdit, showSubElements, "entityID", i) }}
            </div>
        </div>

{% endmacro %}

{% macro displaySource(X, inEdit, showSubElements, source, i) %}
    {% import 'widgets.html' as widgets %}
        <div class="panel panel-default"  id="source_panel_{{i}}">
            <div class="panel-body">
                <div class="col-sm-10" id="source_datapart_{{i}}">
                    <input id="source_id_{{i}}" name="source_id_{{i}}" type="hidden" value="{{ source.id }}"/>
                    <input id="source_version_{{i}}" name="source_version_{{i}}" type="hidden" value="{{ source.version }}"/>
                    <input id="source_operation_{{i}}" name="source_operation_{{i}}" type="hidden" value="{{ source.operation }}"/>
                    <div class="form-group">
                        <label for="source_displayName_{{ i }}" class="control-label col-xs-4" data-content="{{X.sourceDisplayName.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.sourceDisplayName.display }}
                        </label>
                        <div class="col-xs-8" id="text_source_displayName_{{i}}">
                            <input id="source_displayName_{{i}}" name="source_displayName_{{i}}" type="hidden" class="form-control" value="{{ source.displayName }}"/>
                            <p class="form-control-static">{{ source.displayName }}</p>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="source_uri_{{ i }}" class="control-label col-xs-4" data-content="{{X.sourceURI.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.sourceURI.display }}
                        </label>
                        <div class="col-xs-8" id="text_source_uri_{{i}}">
                            <input id="source_uri_{{i}}" name="source_uri_{{i}}" type="hidden" class="form-control" value="{{ source.uri }}"/>
                            <p class="form-control-static">{{ source.uri }}</p>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="source_citation_{{ i }}" class="control-label col-xs-4" data-content="{{X.sourceCitation.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.sourceCitation.display }}
                        </label>
                        <div class="col-xs-8" id="textarea_source_citation_{{i}}">
                            <textarea id="source_citation_{{i}}" name="source_citation_{{i}}" class="form-control" style="display:none;">{{ source.citation }}</textarea>
                            <p class="form-control-static">{{ source.citation }}</p>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="source_text_{{ i }}" class="control-label col-xs-4" data-content="{{X.sourceText.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.sourceText.display }}
                        </label>
                        <div class="col-xs-8" id="textarea_source_text_{{i}}">
                            <textarea id="source_text_{{i}}" name="source_text_{{i}}" class="form-control" style="display:none;">{{ source.text }}</textarea>
                            <p class="form-control-static">{{ source.text }}</p>
                        </div>
                    </div>

                    <input type="hidden" id="source_language_id_{{i}}" name="source_language_id_{{i}}" value="{{source.language.id}}"/>
                    <input type="hidden" id="source_language_version_{{i}}" name="source_language_version_{{i}}" value="{{sources.language.version}}"/>
                    <div class="form-group">
                        <label class="control-label col-xs-4" data-content="{{X.language.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.language.display }}
                        </label>
                        <div class="col-xs-8">
                            <div class="input-group select2-bootstrap-append">
                                <div id="select_source_languagelanguage_{{i}}">
                                    <input id="source_languagelanguage_id_{{i}}" name="source_languagelanguage_id_{{i}}" type="hidden" class="form-control" value="{{ source.language.language.id }}"/>
                                    <input id="source_languagelanguage_term_{{i}}" name="source_languagelanguage_term_{{i}}" type="hidden" class="form-control" value="{{ source.language.language.term }}"/>
                                    <input id="source_languagelanguage_vocabtype_{{i}}" name="source_languagelanguage_vocabtype_{{i}}" type="hidden" class="form-control" value="language_code"/>
                                    <input id="source_languagelanguage_minlength_{{i}}" name="source_languagelanguage_minlength_{{i}}" type="hidden" class="form-control" value="0"/>
                                    <p class="form-control-static">{{ source.language.language.term }}</p>
                                </div>
                                <span class="input-group-btn">
                                    <button class="btn btn-primary snac-hidden"
                                        id="source_languagelanguage_magic_{{i}}" disabled
                                        onClick="magicDefaultFill('source_languagelanguage_id_{{i}}', 'language'); return false;"
                                        title="Apply user's default value">
                                        <i class="fa fa-magic" aria-hidden="true"></i>
                                    </button>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-xs-4" data-content="{{X.script.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.script.display }}
                        </label>
                        <div class="col-xs-8">
                            <div class="input-group select2-bootstrap-append">
                                <div id="select_source_languagescript_{{i}}">
                                    <input id="source_languagescript_id_{{i}}" name="source_languagescript_id_{{i}}" type="hidden" class="form-control" value="{{ source.language.script.id }}"/>
                                    <input id="source_languagescript_term_{{i}}" name="source_languagescript_term_{{i}}" type="hidden" class="form-control" value="{{ source.language.script.term }}"/>
                                    <input id="source_languagescript_vocabtype_{{i}}" name="source_languagescript_vocabtype_{{i}}" type="hidden" class="form-control" value="script_code"/>
                                    <input id="source_languagescript_minlength_{{i}}" name="source_languagescript_minlength_{{i}}" type="hidden" class="form-control" value="0"/>
                                    <p class="form-control-static">{{ source.language.script.term }}</p>
                                </div>
                                <span class="input-group-btn">
                                    <button class="btn btn-primary snac-hidden"
                                        id="source_languagescript_magic_{{i}}" disabled
                                        onClick="magicDefaultFill('source_languagescript_id_{{i}}', 'script'); return false;"
                                        title="Apply user's default value">
                                        <i class="fa fa-magic" aria-hidden="true"></i>
                                    </button>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="source_note_{{ i }}" class="control-label col-xs-4" data-content="{{X.descriptiveNote.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.descriptiveNote.display }}
                        </label>
                        <div class="col-xs-8" id="textarea_source_note_{{i}}">
                            <textarea id="source_note_{{i}}" name="source_note_{{i}}" class="form-control" style="display:none">{{ source.note }}</textarea>
                            <p class="form-control-static">{{ source.note }}</p>
                        </div>
                    </div>


                </div>
                {{ widgets.scmModal(X, inEdit, showSubElements, "source", i, source.uri, "Source", source) }}
                {{ widgets.optionsList(X, inEdit, showSubElements, "source", i) }}

            </div>
        </div>

{% endmacro %}

{% macro displayResource(X, inEdit, showSubElements, resource, i) %}
    <div class="panel alert-info edited-component" >
        <div class="panel-body">
            {% import "resources/_resource_form.html" as resources %}
            {{ resources.resourceForm(X, null) }}
            {{ resources.displayResourceLanguageTemplate(X) }}
        </div>
    </div>
{% endmacro %}


{% macro displayResourceRelation(X, inEdit, showSubElements, relation, i, entityType, preferredName) %}
    {% import 'widgets.html' as widgets %}
    {% import _self as components %}
        <div class="panel panel-default" id="resourceRelation_panel_{{i}}">
            <div class="panel-body">
                <div class="col-sm-10" id="resourceRelation_datapart_{{i}}">
                    <input id="resourceRelation_id_{{i}}" name="resourceRelation_id_{{i}}" type="hidden" value="{{ relation.id }}"/>
                    <input id="resourceRelation_version_{{i}}" name="resourceRelation_version_{{i}}" type="hidden" value="{{ relation.version }}"/>
                    <input id="resourceRelation_operation_{{i}}" name="resourceRelation_operation_{{i}}" type="hidden" value="{{ relation.operation }}"/>
                    <input id="resourceRelation_resourceid_{{i}}" name="resourceRelation_resourceid_{{i}}" type="hidden" class="form-control" value="{{ relation.resource.id }}"/>
                    <input id="resourceRelation_resourceversion_{{i}}" name="resourceRelation_resourceversion_{{i}}" type="hidden" class="form-control" value="{{ relation.resource.version }}"/>
                    <div class="form-group well well-sm text-center">
                        <div class="col-xs-4 text-center">
                            <p class="relation-icon">
                                {% if entityType == 'person' %}
                                <i class="fa fa-user" aria-hidden="true"></i><br/>
                                {% elseif entityType == 'corporateBody' %}
                                <i class="fa fa-building" aria-hidden="true"></i><br/>
                                {% elseif entityType == 'family' %}
                                <i class="fa fa-users" aria-hidden="true"></i><br/>
                                {% else %}
                                <i class="fa fa-question" aria-hidden="true"></i><br/>
                                {% endif %}
                            </p>
                            <p class="relation-icon-caption">
                                {{ preferredName }}
                            </p>
                        </div>
                        <div class="col-xs-4 text-center">
                            <p class="relation-icon">
                                <i class="fa fa-long-arrow-right" aria-hidden="true"></i><br/>
                            </p>
                            <p class="relation-icon-caption" id="resourceRelation_relationPictureArrow_{{i}}">
                                {{relation.role.term}}
                            </p>
                        </div>
                        <div class="col-xs-4 text-center">
                            <p class="relation-icon" id="resourceRelation_relationPictureIcon_{{i}}">
                                <i class="fa fa-file" aria-hidden="true"></i><br/>
                            </p>
                            <p class="relation-icon-caption" id="resourceRelation_relationPictureTitle_{{i}}">
                                {{relation.resource.title}}
                            </p>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-xs-4" data-content="{{X.resourceResource.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.resourceResource.display }}
                        </label>
                        <div class="col-xs-8 form-control-static">
                            <p>
                                <span style="font-weight: bold" id="resourceRelation_displayEntryText_{{i}}">{{ relation.resource.displayEntry ? relation.resource.displayEntry : '' }}</span><br>
                            </p>
                            <p>
                                {{X.resourceTitle.display}}:
                                <span id="resourceRelation_titleText_{{i}}">{{ relation.resource.title ? relation.resource.title : '' }}</span><br>
                            </p>
                            <p>
                                <span id="resourceRelation_abstractText_{{i}}">{{relation.resource.abstract}}</span>
                            </p>
                            <!-- <p>
                                <span>{# X.resourceDate.display #}</span>:
                                <span id="resourceRelation_dateText_{#i#}">{# relation.resource.date ? relation.resource.date : 'No Date' #}</span><br>
                            </p> -->
                            <p>
                                <span id="resourceRelation_documentTypeText_{{i}}">{{relation.resource.documentType.term}}</span>:
                                <span id="resourceRelation_extentText_{{i}}">{{relation.resource.extent ? relation.resource.extent : ''}}</span>
                            </p>
                            <p id="resourceRelation_LinkText_{{i}}">
                                <span id="resourceRelation_linkText_{{i}}">{{relation.resource.link}}
                                {% if relation.resource.link %}
                                    <a class="label label-info" target="_blank" href="{{relation.resource.link}}">View</a>
                                {% endif %}
                            </p>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="resourceRelation_role_{{ i }}" class="control-label col-xs-4" data-content="{{X.resourceRole.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.resourceRole.display }}
                        </label>
                        <div class="col-xs-8" id="select_resourceRelation_role_{{i}}">
                            <input id="resourceRelation_role_id_{{i}}" name="resourceRelation_role_id_{{i}}" type="hidden" class="form-control" value="{{ relation.role.id }}"/>
                            <input id="resourceRelation_role_term_{{i}}" name="resourceRelation_role_term_{{i}}" type="hidden" class="form-control" value="{{ relation.role.term }}"/>
                            <input id="resourceRelation_role_vocabtype_{{i}}" name="resourceRelation_role_vocabtype_{{i}}" type="hidden" class="form-control" value="document_role"/>
                            <input id="resourceRelation_role_minlength_{{i}}" name="resourceRelation_role_minlength_{{i}}" type="hidden" class="form-control" value="0"/>
                            <p class="form-control-static">{{ relation.role.term }}</p>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="resourceRelation_note_{{ i }}" class="control-label col-xs-4" data-content="{{X.descriptiveNote.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.descriptiveNote.display }}
                        </label>
                        <div class="col-xs-8" id="textarea_resourceRelation_note_{{i}}">
                            <textarea id="resourceRelation_note_{{i}}" name="resourceRelation_note_{{i}}" class="form-control" style="display:none;">{{ relation.note }}</textarea>
                            <p class="form-control-static">{{ relation.note }}</p>
                        </div>
                    </div>
                </div>

                {{ widgets.scmModal(X, inEdit, showSubElements, "resourceRelation", i, relation.content, "Resource Relation", relation) }}
                {{ widgets.optionsList(X, inEdit, showSubElements, "resourceRelation", i) }}
            </div>
        </div>

{% endmacro %}

{% macro displayResourceOriginationName(X, inEdit, showSubElements, originationName, i, j) %}
        <div class="col-xs-12" id="resource_originationName_{{j}}_panel_{{i}}" style="padding-top: 5px; padding-bottom: 5px;">
            <div id="resource_originationName_{{j}}_datapart_{{i}}">
                <input type="hidden" id="resource_originationName_{{j}}_id_{{i}}"
                    name="resource_originationName_{{j}}_id_{{i}}"
                    value="{{originationName.id}}"/>
                <input type="hidden" id="resource_originationName_{{j}}_version_{{i}}"
                    name="resource_originationName_{{j}}_version_{{i}}"
                    value="{{originationName.version}}"/>
                <input type="hidden" id="resource_originationName_{{j}}_operation_{{i}}"
                    name="resource_originationName_{{j}}_operation_{{i}}"
                    value="{{originationName.operation}}"/>
                <div>
                    <div class="input-group select2-bootstrap-append">
                        <div id="text_resource_originationName_{{j}}_name_{{i}}" style="width: 100%; clear: none; float: left;">
                            <input type="hidden" name="resource_originationName_{{j}}_name_{{i}}" id="resource_originationName_{{j}}_name_{{i}}"
                                class="form-control" value="{{ originationName.name  }}">
                            <p class="form-control-static">{{ originationName.name }}</p>
                        </div>
                        <span class="input-group-btn">
                            <button class="btn btn-danger snac-hidden"
                                id="resource_originationName_{{j}}_remove_{{i}}" disabled
                                onClick="setRepeatedDataDeleted('resource_originationName_{{j}}', '{{i}}'); return false;">
                                <span class="glyphicon glyphicon-minus-sign"></span>
                            </button>
                        </span>
                    </div>
                </div>
            </div>
        </div>

{% endmacro %}



{% macro displayConstellationRelation(X, inEdit, showSubElements, relation, i, entityType, preferredName, reverse, control) %}
    {% import 'widgets.html' as widgets %}
        <div class="panel panel-default" id="constellationRelation_panel_{{i}}">
            <div class="panel-body">
                {% if not showSubElements %}
                <div class="col-xs-12" id="constellationRelation_datapart_{{i}}">
                {% else %}
                <div class="col-xs-10" id="constellationRelation_datapart_{{i}}">
                {% endif %}
                    <input id="constellationRelation_id_{{i}}" name="constellationRelation_id_{{i}}" type="hidden" value="{{ relation.id }}"/>
                    <input id="constellationRelation_version_{{i}}" name="constellationRelation_version_{{i}}" type="hidden" value="{{ relation.version }}"/>
                    <input id="constellationRelation_operation_{{i}}" name="constellationRelation_operation_{{i}}" type="hidden" value="{{ relation.operation }}"/>
                    <input id="constellationRelation_content_{{i}}" name="constellationRelation_content_{{i}}" type="hidden" value="{{ relation.content }}"/>
                    <input id="constellationRelation_targetID_{{i}}" name="constellationRelation_targetID_{{i}}" type="hidden" value="{{ relation.targetConstellation }}"/>
                    <input id="constellationRelation_targetArkID_{{i}}" name="constellationRelation_targetArkID_{{i}}" type="hidden" value="{{ relation.targetArkID }}"/>
                    <input id="constellationRelation_targetEntityType_{{i}}" name="constellationRelation_targetEntityType_{{i}}" type="hidden" value="{{ relation.targetEntityType.id }}"/>
                    <div class="form-group well well-sm text-center">
                        <div class="col-xs-4 text-center">
                            {% if not reverse %}
                                <p class="relation-icon">
                                    {% if entityType == 'person' %}
                                    <i class="fa fa-user" aria-hidden="true"></i><br/>
                                    {% elseif entityType == 'corporateBody' %}
                                    <i class="fa fa-building" aria-hidden="true"></i><br/>
                                    {% elseif entityType == 'family' %}
                                    <i class="fa fa-users" aria-hidden="true"></i><br/>
                                    {% endif %}
                                </p>
                                <p class="relation-icon-caption">
                                    {{ preferredName }}
                                </p>
                            {% else %}
                                <p class="relation-icon" id="constellationRelation_relationPictureIcon_{{i}}">
                                    {% if relation.targetEntityType.term == 'person' %}
                                    <i class="fa fa-user" aria-hidden="true"></i><br/>
                                    {% elseif relation.targetEntityType.term == 'corporateBody' %}
                                    <i class="fa fa-building" aria-hidden="true"></i><br/>
                                    {% elseif relation.targetEntityType.term == 'family' %}
                                    <i class="fa fa-users" aria-hidden="true"></i><br/>
                                    {% endif %}
                                </p>
                                <p class="relation-icon-caption" id="constellationRelation_relationPictureTitle_{{i}}">
                                    {{relation.content}}
                                </p>
                            {% endif %}
                        </div>
                        <div class="col-xs-4 text-center">
                            <p class="relation-icon">
                                <i class="fa fa-long-arrow-right" aria-hidden="true"></i><br/>
                            </p>
                            <p class="relation-icon-caption" id="constellationRelation_relationPictureArrow_{{i}}">
                                {{relation.type.term}}
                            </p>

                        </div>
                        <div class="col-xs-4 text-center">
                            {% if not reverse %}
                                <p class="relation-icon" id="constellationRelation_relationPictureIcon_{{i}}">
                                    {% if relation.targetEntityType.term == 'person' %}
                                    <i class="fa fa-user" aria-hidden="true"></i><br/>
                                    {% elseif relation.targetEntityType.term == 'corporateBody' %}
                                    <i class="fa fa-building" aria-hidden="true"></i><br/>
                                    {% elseif relation.targetEntityType.term == 'family' %}
                                    <i class="fa fa-users" aria-hidden="true"></i><br/>
                                    {% endif %}
                                </p>
                                <p class="relation-icon-caption" id="constellationRelation_relationPictureTitle_{{i}}">
                                    {{relation.content}}
                                </p>
                            {% else %}
                                <p class="relation-icon">
                                    {% if entityType == 'person' %}
                                    <i class="fa fa-user" aria-hidden="true"></i><br/>
                                    {% elseif entityType == 'corporateBody' %}
                                    <i class="fa fa-building" aria-hidden="true"></i><br/>
                                    {% elseif entityType == 'family' %}
                                    <i class="fa fa-users" aria-hidden="true"></i><br/>
                                    {% endif %}
                                </p>
                                <p class="relation-icon-caption">
                                    {{ preferredName }}
                                </p>
                            {% endif %}
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-xs-4" data-content="{{X.relationTarget.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.relationTarget.display }}
                        </label>
                        <div class="col-xs-8">
                            <p class="form-control-static"><span style="font-weight: bold" id="constellationRelation_contentText_{{i}}">{{ relation.content }}</span><br>
                            <span id="constellationRelation_targetArkIDText_{{i}}">{{relation.targetArkID}}
                            {% if relation.targetConstellation %}
                                <a class="label label-info" target="_blank" href="{{control.snacURL}}/view/{{relation.targetConstellation}}">View</a>
                            {% endif %}
                            </span>
                            </p>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="constellationRelation_type_{{ i }}" class="control-label col-xs-4" data-content="{{X.relationType.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.relationType.display }}
                        </label>
                        <div class="col-xs-8" id="select_constellationRelation_type_{{i}}">
                            <input id="constellationRelation_type_id_{{i}}" name="constellationRelation_type_id_{{i}}" type="hidden" class="form-control" value="{{ relation.type.id }}"/>
                            <input id="constellationRelation_type_term_{{i}}" name="constellationRelation_type_term_{{i}}" type="hidden" class="form-control" value="{{ relation.type.term }}"/>
                            <input id="constellationRelation_type_vocabtype_{{i}}" name="constellationRelation_type_vocabtype_{{i}}" type="hidden" class="form-control" value="relation_type"/>
                            <input id="constellationRelation_type_minlength_{{i}}" name="constellationRelation_type_minlength_{{i}}" type="hidden" class="form-control" value="0"/>
                            <p class="form-control-static" id="constellationRelation_typeText_{{i}}">{{ relation.type.term }}</p>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="constellationRelation_note_{{ i }}" class="control-label col-xs-4" data-content="{{X.descriptiveNote.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.descriptiveNote.display }}
                        </label>
                        <div class="col-xs-8" id="textarea_constellationRelation_note_{{i}}">
                            <textarea id="constellationRelation_note_{{i}}" name="constellationRelation_note_{{i}}" class="form-control" style="display:none;">{{ relation.note }}</textarea>
                            <p class="form-control-static" id="constellationRelation_noteText_{{i}}">{{ relation.note }}</p>
                        </div>
                    </div>
                </div>

                {{ widgets.scmModal(X, inEdit, showSubElements, "constellationRelation", i, relation.content, "Constellation Relation", relation) }}
                {{ widgets.optionsList(X, inEdit, showSubElements, "constellationRelation", i) }}
            </div>
        </div>

{% endmacro %}

{% macro displayLanguageUsed(X, inEdit, showSubElements, language, i) %}
    {% import 'widgets.html' as widgets %}
        <div class="panel panel-default" id="language_panel_{{i}}">
            <div class="panel-body">
                <div class="col-sm-10" id="language_datapart_{{i}}">
                    <input id="language_id_{{i}}" name="language_id_{{i}}" type="hidden" value="{{ language.id }}"/>
                    <input id="language_version_{{i}}" name="language_version_{{i}}" type="hidden" value="{{ language.version }}"/>
                    <input id="language_operation_{{i}}" name="language_operation_{{i}}" type="hidden" value="{{ language.operation }}"/>
                    <div class="form-group">
                        <label class="control-label col-xs-4" data-content="{{X.languageUsed.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.languageUsed.display }}
                        </label>
                        <div class="col-xs-8">
                            <div class="input-group select2-bootstrap-append">
                                <div id="select_language_language_{{i}}">
                                    <input id="language_language_id_{{i}}" name="language_language_id_{{i}}" type="hidden" class="form-control" value="{{ language.language.id }}"/>
                                    <input id="language_language_term_{{i}}" name="language_language_term_{{i}}" type="hidden" class="form-control" value="{{ language.language.term }}"/>
                                    <input id="language_language_vocabtype_{{i}}" name="language_language_vocabtype_{{i}}" type="hidden" class="form-control" value="language_code"/>
                                    <input id="language_language_minlength_{{i}}" name="language_language_minlength_{{i}}" type="hidden" class="form-control" value="0"/>
                                    <p class="form-control-static">{{ language.language.term }}</p>
                                </div>
                                <span class="input-group-btn">
                                    <button class="btn btn-primary snac-hidden"
                                        id="language_language_magic_{{i}}" disabled
                                        onClick="magicDefaultFill('language_language_id_{{i}}', 'language'); return false;"
                                        title="Apply user's default value">
                                        <i class="fa fa-magic" aria-hidden="true"></i>
                                    </button>
                                </span>
                            </div>
                        </div>
                    </div>


                    <div class="form-group">
                        <label class="control-label col-xs-4" data-content="{{X.scriptUsed.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.scriptUsed.display }}
                        </label>
                        <div class="col-xs-8">
                            <div class="input-group select2-bootstrap-append">
                                <div id="select_language_script_{{i}}">
                                    <input id="language_script_id_{{i}}" name="language_script_id_{{i}}" type="hidden" class="form-control" value="{{ language.script.id }}"/>
                                    <input id="language_script_term_{{i}}" name="language_script_term_{{i}}" type="hidden" class="form-control" value="{{ language.script.term }}"/>
                                    <input id="language_script_vocabtype_{{i}}" name="language_script_vocabtype_{{i}}" type="hidden" class="form-control" value="script_code"/>
                                    <input id="language_script_minlength_{{i}}" name="language_script_minlength_{{i}}" type="hidden" class="form-control" value="0"/>
                                    <p class="form-control-static">{{ language.script.term }}</p>
                                </div>
                                <span class="input-group-btn">
                                    <button class="btn btn-primary snac-hidden"
                                        id="language_script_magic_{{i}}" disabled
                                        onClick="magicDefaultFill('language_script_id_{{i}}', 'script'); return false;"
                                        title="Apply user's default value">
                                        <i class="fa fa-magic" aria-hidden="true"></i>
                                    </button>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

                {{ widgets.scmModal(X, inEdit, showSubElements, "language", i, language.language.term, "Language", language) }}
                {{ widgets.optionsList(X, inEdit, showSubElements, "language", i) }}
            </div>
        </div>

{% endmacro %}

{% macro displaySubject(X, inEdit, showSubElements, subject, i) %}
    {% import 'widgets.html' as widgets %}
        <div class="panel panel-default" id="subject_panel_{{i}}">
            <div class="panel-body">
                <div class="col-sm-10" id="subject_datapart_{{i}}">
                    <input type="hidden" id="subject_id_{{i}}" name="subject_id_{{i}}" value="{{subject.id}}"/>
                    <input id="subject_version_{{i}}" name="subject_version_{{i}}" type="hidden" value="{{ subject.version }}"/>
                    <input id="subject_operation_{{i}}" name="subject_operation_{{i}}" type="hidden" value="{{ subject.operation }}"/>
                    <div class="form-group">
                        <label class="control-label col-xs-4" data-content="{{X.term.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.term.display }}
                        </label>
                        <div class="col-xs-8" id="select_subject_term_{{i}}">
                            <input type="hidden" id="subject_term_id_{{i}}" name="subject_term_id_{{i}}" value="{{subject.term.id}}"/>
                            <input type="hidden" id="subject_term_term_{{i}}" name="subject_term_term_{{i}}" value="{{subject.term.term}}"/>
                            <input type="hidden" id="subject_term_vocabtype_{{i}}" name="subject_term_vocabtype_{{i}}" value="subject"/>
                            <p class="form-control-static">{{ subject.term.term }}</p>
                        </div>
                    </div>
                    <!--
                    <div class="form-group">
                        <label class="control-label col-xs-2" data-content="{{X.uri.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.uri.display }}
                        </label>
                        <div class="col-xs-10">
                            {{ widgets.displayURI(X, inEdit, showSubElements, subject.term.uri) }}
                        </div>
                    </div>
                    -->
                </div>
                {{ widgets.scmModal(X, inEdit, showSubElements, "subject", i, subject.term.term, "Subject", subject) }}
                {{ widgets.optionsList(X, inEdit, showSubElements, "subject", i) }}
            </div>
        </div>

{% endmacro %}

{% macro displayNationality(X, inEdit, showSubElements, nationality, i) %}
    {% import 'widgets.html' as widgets %}
        <div class="panel panel-default" id="nationality_panel_{{i}}">
            <div class="panel-body">
                <div class="col-sm-10" id="nationality_datapart_{{i}}">
                    <input type="hidden" id="nationality_id_{{i}}" name="nationality_id_{{i}}" value="{{nationality.id}}"/>
                    <input id="nationality_version_{{i}}" name="nationality_version_{{i}}" type="hidden" value="{{ nationality.version }}"/>
                    <input id="nationality_operation_{{i}}" name="nationality_operation_{{i}}" type="hidden" value="{{ nationality.operation }}"/>
                    <div class="form-group">
                        <label class="control-label col-xs-4" data-content="{{ X.term.tooltip }}" data-toggle="popover" data-placement="top">
                            {{ X.term.display }}
                        </label>
                        <div class="col-xs-8" id="select_nationality_term_{{i}}">
                            <input type="hidden" id="nationality_term_id_{{i}}" name="nationality_term_id_{{i}}" value="{{nationality.term.id}}"/>
                            <input type="hidden" id="nationality_term_term_{{i}}" name="nationality_term_term_{{i}}" value="{{nationality.term.term}}"/>
                            <input type="hidden" id="nationality_term_vocabtype_{{i}}" name="nationality_term_vocabtype_{{i}}" value="nationality"/>
                            <input id="nationality_term_minlength_{{i}}" name="nationality_term_minlength_{{i}}" type="hidden" class="form-control" value="2"/>
                            <p class="form-control-static">{{ nationality.term.term }}</p>
                        </div>
                    </div>
                    <!--
                    <div class="form-group">
                        <label class="control-label col-xs-2" data-content="{{ X.uri.tooltip }}" data-toggle="popover" data-placement="top">
                            {{ X.uri.display }}
                        </label>
                        <div class="col-xs-10">
                            {{ widgets.displayURI(X, inEdit, showSubElements, nationality.term.uri) }}
                        </div>
                    </div>
                    -->
                </div>
                {{ widgets.scmModal(X, inEdit, showSubElements, "nationality", i, nationality.term.term, "Nationality", nationality) }}
                {{ widgets.optionsList(X, inEdit, showSubElements, "nationality", i) }}
            </div>
        </div>

{% endmacro %}

{% macro displayFunction(X, inEdit, showSubElements, function, i) %}
    {% import 'widgets.html' as widgets %}
        <div class="panel panel-default" id="function_panel_{{i}}">
            <div class="panel-body">
                <div class="col-sm-10" id="function_datapart_{{i}}">
                    <input type="hidden" id="function_id_{{i}}" name="function_id_{{i}}" value="{{function.id}}"/>
                    <input id="function_version_{{i}}" name="function_version_{{i}}" type="hidden" value="{{ function.version }}"/>
                    <input id="function_operation_{{i}}" name="function_operation_{{i}}" type="hidden" value="{{ function.operation }}"/>
                    <div class="form-group">
                        <label class="control-label col-xs-4" data-content="{{ X.term.tooltip }}" data-toggle="popover" data-placement="top">
                            {{ X.term.display }}
                        </label>
                        <div class="col-xs-8" id="select_function_term_{{i}}">
                            <input type="hidden" id="function_term_id_{{i}}" name="function_term_id_{{i}}" value="{{function.term.id}}"/>
                            <input type="hidden" id="function_term_term_{{i}}" name="function_term_term_{{i}}" value="{{function.term.term}}"/>
                            <input type="hidden" id="function_term_vocabtype_{{i}}" name="function_term_vocabtype_{{i}}" value="function"/>
                            <p class="form-control-static">{{ function.term.term }}</p>
                        </div>
                    </div>
                    <!--
                    <div class="form-group">
                        <label class="control-label col-xs-2" data-content="{{ X.uri.tooltip }}" data-toggle="popover" data-placement="top">
                            {{ X.uri.display }}
                        </label>
                        <div class="col-xs-10">
                            {{ widgets.displayURI(X, inEdit, showSubElements, function.term.uri) }}
                        </div>
                    </div>
                    -->
                </div>
                {{ widgets.scmModal(X, inEdit, showSubElements, "function", i, function.term.term, "Function", function) }}
                {{ widgets.optionsList(X, inEdit, showSubElements, "function", i) }}
            </div>
        </div>

{% endmacro %}

{% macro displayOccupation(X, inEdit, showSubElements, occupation, i) %}
    {% import 'widgets.html' as widgets %}
        <div class="panel panel-default" id="occupation_panel_{{i}}">
            <div class="panel-body">
                <div class="col-sm-10" id="occupation_datapart_{{i}}">
                    <input type="hidden" id="occupation_id_{{i}}" name="occupation_id_{{i}}" value="{{occupation.id}}"/>
                    <input id="occupation_version_{{i}}" name="occupation_version_{{i}}" type="hidden" value="{{ occupation.version }}"/>
                    <input id="occupation_operation_{{i}}" name="occupation_operation_{{i}}" type="hidden" value="{{ occupation.operation }}"/>
                    <div class="form-group">
                        <label class="control-label col-xs-4" data-content="{{X.term.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.term.display }}
                        </label>
                        <div class="col-xs-8" id="select_occupation_term_{{i}}">
                            <input type="hidden" id="occupation_term_id_{{i}}" name="occupation_term_id_{{i}}" value="{{occupation.term.id}}"/>
                            <input type="hidden" id="occupation_term_term_{{i}}" name="occupation_term_term_{{i}}" value="{{occupation.term.term}}"/>
                            <input type="hidden" id="occupation_term_vocabtype_{{i}}" name="occupation_term_vocabtype_{{i}}" value="occupation"/>
                            <p class="form-control-static">{{ occupation.term.term }}</p>
                        </div>
                    </div>
                    <!--
                    <div class="form-group">
                        <label class="control-label col-xs-2" data-content="{{X.uri.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.uri.display }}
                        </label>
                        <div class="col-xs-10">
                            {{ widgets.displayURI(X, inEdit, showSubElements, occupation.term.uri) }}
                        </div>
                    </div>
                    -->
                </div>
                {{ widgets.scmModal(X, inEdit, showSubElements, "occupation", i, occupation.term.term, "Occupation", occupation) }}
                {{ widgets.optionsList(X, inEdit, showSubElements, "occupation", i) }}
            </div>
        </div>

{% endmacro %}

{% macro displayLegalStatus(X, inEdit, showSubElements, legalStatus, i) %}
    {% import 'widgets.html' as widgets %}
        <div class="panel panel-default" id="legalStatus_panel_{{i}}">
            <div class="panel-body">
                <div class="col-sm-10" id="legalStatus_datapart_{{i}}">
                    <input type="hidden" id="legalStatus_id_{{i}}" name="legalStatus_id_{{i}}" value="{{legalStatus.id}}"/>
                    <input id="legalStatus_version_{{i}}" name="legalStatus_version_{{i}}" type="hidden" value="{{ legalStatus.version }}"/>
                    <input id="legalStatus_operation_{{i}}" name="legalStatus_operation_{{i}}" type="hidden" value="{{ legalStatus.operation }}"/>
                    <div class="form-group">
                        <label class="control-label col-xs-4" data-content="{{X.term.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.term.display }}
                        </label>
                        <div class="col-xs-8" id="select_legalStatus_term_{{i}}">
                            <input type="hidden" id="legalStatus_term_id_{{i}}" name="legalStatus_term_id_{{i}}" value="{{legalStatus.term.id}}"/>
                            <input type="hidden" id="legalStatus_term_term_{{i}}" name="legalStatus_term_term_{{i}}" value="{{legalStatus.term.term}}"/>
                            <input type="hidden" id="legalStatus_term_vocabtype_{{i}}" name="legalStatus_term_vocabtype_{{i}}" value="legal_status"/>
                            <p class="form-control-static">{{ legalStatus.term.term }}</p>
                        </div>
                    </div>
                    <!--
                    <div class="form-group">
                        <label class="control-label col-xs-2" data-content="{{X.uri.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.uri.display }}
                        </label>
                        <div class="col-xs-10">
                            {{ widgets.displayURI(X, inEdit, showSubElements, legalStatus.term.uri) }}
                        </div>
                    </div>
                    -->
                </div>
                {{ widgets.scmModal(X, inEdit, showSubElements, "legalStatus", i, legalStatus.term.term, "Legal Status", legalStatus) }}
                {{ widgets.optionsList(X, inEdit, showSubElements, "legalStatus", i) }}
            </div>
        </div>

{% endmacro %}

{% macro displayPlace(X, inEdit, showSubElements, place, i) %}
    {% import 'widgets.html' as widgets %}
    {% import _self as components %}
        <div class="panel panel-default" id="place_panel_{{i}}">
            <div class="panel-body">
                <div class="col-sm-10" id="place_datapart_{{i}}">
                    <input id="place_id_{{i}}" name="place_id_{{i}}" type="hidden" value="{{ place.id }}"/>
                    <input id="place_version_{{i}}" name="place_version_{{i}}" type="hidden" value="{{ place.version }}"/>
                    <input id="place_operation_{{i}}" name="place_operation_{{i}}" type="hidden" value="{{ place.operation }}"/>
                    <input id="place_original_{{i}}" name="place_original_{{i}}" type="hidden" class="form-control" value="{{ place.original }}" readonly/>
                    <input id="place_score_{{i}}" name="place_score_{{i}}" type="hidden" class="form-control" value="{{ place.score }}"/>

                    <div class="form-group">
                        <div class="col-sm-9">

                            {% if place.confirmed and place.geoplace.id %}
                                <h4 class="text-center geoterm-heading" id="place_geoterm_text_{{i}}">{{place.geoplace.name}}</h4>
                                <p class="caption text-center geoterm-caption" id="place_geoterm_caption_{{i}}">{{place.geoplace.administrationCode}}, {{place.geoplace.countryCode}}</p>
                                <input id="place_confirmed_{{i}}" name="place_confirmed_{{i}}" type="hidden" class="form-control" value="true"/>
                            {% else %}
                                {% if place.original and place.original != "" %}
                                    {% if inEdit %}
                                        <h4 class="text-center geoterm-heading" id="place_geoterm_text_{{i}}"><em>Unconfirmed</em></h4>
                                        <p class="caption text-center geoterm-caption" id="place_geoterm_caption_{{i}}">Recorded as: {{place.original}}</p>
                                    {% else %}
                                        <h4 class="text-center geoterm-heading" id="place_geoterm_text_{{i}}"><em>{{place.original}}</em></h4>
                                        <p class="caption text-center geoterm-caption" id="place_geoterm_caption_{{i}}">as recorded (not vetted)</p>
                                    {% endif %}
                                {% else %}
                                    <h4 class="text-center geoterm-heading" id="place_geoterm_text_{{i}}">--</h4>
                                    <p class="caption text-center geoterm-caption" id="place_geoterm_caption_{{i}}">GeoPlace term not specified</p>
                                {% endif %}
                                <input id="place_confirmed_{{i}}" name="place_confirmed_{{i}}" type="hidden" class="form-control" value="false"/>
                            {% endif %}
                            {% if inEdit %}
                                {% if place.geoplace.id and not place.confirmed %}
                                    <input id="place_geoplaceSuggested_id_{{i}}" name="place_geoplaceSuggested_id_{{i}}" type="hidden" class="form-control" value="{{ place.geoplace.id }}"/>
                                    <p class="caption text-center geoterm-caption" id="place_geoterm_matchconfidence_{{i}}">Possibly:
                                    {{ place.geoplace.name }}
                                    {% if place.geoplace.administrationCode or place.geoplace.countryCode %}
                                        ({{place.geoplace.administrationCode}}, {{place.geoplace.countryCode}})
                                    {% endif %}
                                    -- {{(place.score * 100)|round(1, 'floor')}}% confidence
                                    <a class="label label-info snac-hidden" onclick="chooseSuggestedGeoPlace('place_geoplace_id_{{i}}', {{i}}, '{{place.geoplace.id}}')">
                                        choose</a>
                                    </p>
                                {% endif %}
                            {% endif %}

                        </div>
                        <div class="col-sm-3">
                            <div class="list-group snac-options-list">
                            {% if place.geoplace.id and place.confirmed %}
                                <a class="list-group-item list-group-item-download" onClick="openGeoPlaceViewer('{{place.geoplace.id}}'); return false;" id="place_geoterm_maplink_{{i}}" style="cursor: pointer;"><span class="fa fa-2x fa-map-marker" aria-hidden="true"></span><br>View GeoPlace</a>
                            {% else %}
                                <a class="list-group-item list-group-item-download disabled" id="place_geoterm_maplink_{{i}}" style="cursor: pointer;"><span class="fa fa-2x fa-map-marker" aria-hidden="true"></span><br>View GeoPlace</a>
                            {% endif %}
                            </div>
                        </div>
                    </div>


                    <div class="form-group">
                        <div class="col-xs-12" id="selectGeo_place_geoplace_{{i}}">
                            <input id="place_geoplace_id_{{i}}" name="place_geoplace_id_{{i}}" type="hidden" class="form-control" value="{{ place.geoplace.id }}"/>
                            <input id="place_geoplace_term_{{i}}" name="place_geoplace_term_{{i}}" type="hidden" class="form-control" value="{{ place.geoplace.name }} ({{place.geoplace.administrationCode}}, {{place.geoplace.countryCode}})"/>
                        </div>
                    </div>



                    <div class="form-group">
                        <label class="control-label col-xs-4" data-content="{{X.placeType.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.placeType.display }}
                        </label>
                        <div class="col-xs-8" id="select_place_type_{{i}}">
                            <input id="place_type_id_{{i}}" name="place_type_id_{{i}}" type="hidden" class="form-control" value="{{ place.type.id }}"/>
                            <input id="place_type_term_{{i}}" name="place_type_term_{{i}}" type="hidden" class="form-control" value="{{ place.type.term }}"/>
                            <input id="place_type_vocabtype_{{i}}" name="place_type_vocabtype_{{i}}" type="hidden" class="form-control" value="place_type"/>
                            <input id="place_type_minlength_{{i}}" name="place_type_minlength_{{i}}" type="hidden" class="form-control" value="0"/>
                            <p class="form-control-static">{{ place.type.term }}</p>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-xs-4" data-content="{{X.placeRole.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.placeRole.display }}
                        </label>
                        <div class="col-xs-8" id="select_place_role_{{i}}">
                            <input id="place_role_id_{{i}}" name="place_role_id_{{i}}" type="hidden" class="form-control" value="{{ place.role.id }}"/>
                            <input id="place_role_term_{{i}}" name="place_role_term_{{i}}" type="hidden" class="form-control" value="{{ place.role.term }}"/>
                            <input id="place_role_vocabtype_{{i}}" name="place_role_vocabtype_{{i}}" type="hidden" class="form-control" value="place_role"/>
                            <input id="place_role_minlength_{{i}}" name="place_role_minlength_{{i}}" type="hidden" class="form-control" value="0"/>
                            <p class="form-control-static">{{ place.role.term }}</p>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-xs-4" data-content="{{X.address.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.address.display }}
                        </label>
                        <div class="col-xs-8 well well-sm" id="place_reorderable_{{i}}">
                            {% set j = 0 %}
                            {% for part in place.address %}
                                {{ components.displayAddressLine(X, inEdit, showSubElements, part, i, j) }}
                                {% set j = j + 1 %}
                            {% endfor %}

                            <span id='place_address_next_j_{{i}}' style='display:none;'>{{j}}</span>

                            <div class="form-group" id="place_address_add_div_{{i}}">
                                <div class="col-xs-12 text-center">
                                    <button class="btn btn-success snac-hidden" id="place_address_add_{{i}}"
                                        onClick="return newAddressLine({{i}});" disabled>
                                        <span class="glyphicon glyphicon-plus-sign"></span> Add Line
                                    </button>
                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="form-group">
                        <label for="place_note_{{ i }}" class="control-label col-xs-4" data-content="{{X.descriptiveNote.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.descriptiveNote.display }}
                        </label>
                        <div class="col-xs-8" id="textarea_place_note_{{i}}">
                            <textarea id="place_note_{{i}}" name="place_note_{{i}}" class="form-control" style="display:none;">{{ place.note }}</textarea>
                            <p class="form-control-static">{{ place.note }}</p>
                        </div>
                    </div>
                </div>
                {{ widgets.scmModal(X, inEdit, showSubElements, "place", i, place.original, "Place", place) }}
                {{ widgets.optionsList(X, inEdit, showSubElements, "place", i) }}

            </div>
        </div>

{% endmacro %}

{% macro displayAddressLine(X, inEdit, showSubElements, address, i, j) %}
        <div class="col-xs-12 reorderable" id="place_address_{{j}}_panel_{{i}}" style="padding-top: 5px; padding-bottom: 5px;">
            <div id="place_address_{{j}}_datapart_{{i}}">
                <input type="hidden" id="place_address_{{j}}_id_{{i}}"
                    name="place_address_{{j}}_id_{{i}}"
                    value="{{address.id}}"/>
                <input type="hidden" id="place_address_{{j}}_version_{{i}}"
                    name="place_address_{{j}}_version_{{i}}"
                    value="{{address.version}}"/>
                <input type="hidden" id="place_address_{{j}}_operation_{{i}}"
                    name="place_address_{{j}}_operation_{{i}}"
                    value="{{address.operation}}"/>
                <input type="hidden" class="order-index" id="place_address_{{j}}_order_{{i}}"
                    name="place_address_{{j}}_order_{{i}}"
                    value="{{j}}"/>
                <div>
                    <div class="input-group select2-bootstrap-append">
                        <span class="input-group-addon move-handle sizing-addon3 snac-hidden"><i class="fa fa-bars" aria-hidden="true"></i>
                        </span>
                        <div id="select_place_address_{{j}}_type_{{i}}" style="width: 50%">
                            <input id="place_address_{{j}}_type_id_{{i}}"
                                name="place_address_{{j}}_type_id_{{i}}"
                                type="hidden" class="form-control"
                                value="{{ address.type.id }}"/>
                            <input id="place_address_{{j}}_type_term_{{i}}"
                                name="place_address_{{j}}_type_term_{{i}}"
                                type="hidden" class="form-control"
                                value="{{ address.type.term }}"/>
                            <input id="place_address_{{j}}_type_vocabtype_{{i}}"
                                name="place_address_{{j}}_type_vocabtype_{{i}}"
                                type="hidden" class="form-control" value="address_part"/>
                            <input id="place_address_{{j}}_type_minlength_{{i}}"
                                name="place_address_{{j}}_type_minlength_{{i}}"
                                type="hidden" class="form-control" value="0"/>
                            <input id="place_address_{{j}}_type_placeholder_{{i}}"
                                type="hidden" value="Part"/>
                            <p class="form-control-static">{{ address.type.term }}</p>
                        </div>
                        <div id="text_place_address_{{j}}_text_{{i}}" style="width: 50%; clear: none; float: left;">
                            <input type="hidden" name="place_address_{{j}}_text_{{i}}" id="place_address_{{j}}_text_{{i}}"
                                class="form-control" value="{{ address.text  }}">
                            <p class="form-control-static">{{ address.text }}</p>
                        </div>


                        <span class="input-group-btn">
                            <button class="btn btn-danger snac-hidden"
                                id="place_address_{{j}}_remove_{{i}}" disabled
                                onClick="setRepeatedDataDeleted('place_address_{{j}}', '{{i}}'); return false;">
                                <span class="glyphicon glyphicon-minus-sign"></span>
                            </button>
                        </span>
                    </div>
                </div>
            </div>
        </div>

{% endmacro %}


{% macro displayConventionDeclaration(X, inEdit, showSubElements, conventionDeclaration, i) %}
    {% import 'widgets.html' as widgets %}
        <div class="panel panel-default" id="conventionDeclaration_panel_{{i}}">
            <div class="panel-body">
                    <div class="col-sm-10" id="conventionDeclaration_datapart_{{i}}">
                        <input type="hidden" id="conventionDeclaration_id_{{i}}" name="conventionDeclaration_id_{{i}}" value="{{conventionDeclaration.id}}"/>
                        <input id="conventionDeclaration_version_{{i}}" name="conventionDeclaration_version_{{i}}" type="hidden" value="{{ conventionDeclaration.version }}"/>
                        <input id="conventionDeclaration_operation_{{i}}" name="conventionDeclaration_operation_{{i}}" type="hidden" value="{{ conventionDeclaration.operation }}"/>
                        <div class="form-group">
                            <label for="conventionDeclaration_text_{{i}}" class="control-label col-xs-2" data-content="{{X.xml.tooltip}}" data-toggle="popover" data-placement="top">
                                {{ X.xml.display }}
                            </label>
                            <div class="col-xs-10" id="textarea_conventionDeclaration_text_{{i}}">
                                <textarea id="conventionDeclaration_text_{{i}}" name="conventionDeclaration_text_{{i}}" class="form-control"
                                    style="display: none;">{{ conventionDeclaration.text }}</textarea>
                                <p class="form-control-static">{{ conventionDeclaration.text }}</p>
                            </div>
                        </div>
                    </div>
                    {{ widgets.scmModal(X, inEdit, showSubElements, "conventionDeclaration", i, "Convention Declaration " ~ i, "Convention Declaration", conventionDeclaration) }}
                    {{ widgets.optionsList(X, inEdit, showSubElements, "conventionDeclaration", i) }}
            </div>
        </div>
{% endmacro %}

{% macro displayGeneralContext(X, inEdit, showSubElements, generalContext, i) %}
    {% import 'widgets.html' as widgets %}
        <div class="panel panel-default" id="generalContext_panel_{{i}}">
            <div class="panel-body">
                <div class="col-sm-10" id="generalContext_datapart_{{i}}">
                    <input type="hidden" id="generalContext_id_{{i}}" name="generalContext_id_{{i}}" value="{{generalContext.id}}"/>
                    <input id="generalContext_version_{{i}}" name="generalContext_version_{{i}}" type="hidden" value="{{ generalContext.version }}"/>
                    <input id="generalContext_operation_{{i}}" name="generalContext_operation_{{i}}" type="hidden" value="{{ generalContext.operation }}"/>
                    <div class="form-group">
                        <label for="generalContext_text_{{i}}" class="control-label col-xs-2" data-content="{{X.xml.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.xml.display }}
                        </label>
                        <div class="col-xs-10" id="textarea_generalContext_text_{{i}}">
                            <textarea id="generalContext_text_{{i}}" name="generalContext_text_{{i}}" class="form-control" style="display:none;">{{ generalContext.text }}</textarea>
                            <p class="form-control-static">{{ generalContext.text }}</p>
                        </div>
                    </div>
                </div>
                {{ widgets.scmModal(X, inEdit, showSubElements, "generalContext", i, "General Context " ~ i, "General Context", generalContext) }}
                {{ widgets.optionsList(X, inEdit, showSubElements, "generalContext", i) }}
            </div>
        </div>
{% endmacro %}

{% macro displayStructureOrGenealogy(X, inEdit, showSubElements, structureOrGenealogy, i) %}
    {% import 'widgets.html' as widgets %}
        <div class="panel panel-default" id="structureOrGenealogy_panel_{{i}}">
            <div class="panel-body">
                <div class="col-sm-10" id="structureOrGenealogy_datapart_{{i}}">
                    <input type="hidden" id="structureOrGenealogy_id_{{i}}" name="structureOrGenealogy_id_{{i}}" value="{{structureOrGenealogy.id}}"/>
                    <input id="structureOrGenealogy_version_{{i}}" name="structureOrGenealogy_version_{{i}}" type="hidden" value="{{ structureOrGenealogy.version }}"/>
                    <input id="structureOrGenealogy_operation_{{i}}" name="structureOrGenealogy_operation_{{i}}" type="hidden" value="{{ structureOrGenealogy.operation }}"/>
                    <div class="form-group">
                        <label for="structureOrGenealogy_text_{{i}}" class="control-label col-xs-2" data-content="{{X.xml.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.xml.display }}
                        </label>
                        <div class="col-xs-10" id="textarea_structureOrGenealogy_text_{{i}}">
                            <textarea id="structureOrGenealogy_text_{{i}}" name="structureOrGenealogy_text_{{i}}" class="form-control" style="display:none;">{{ structureOrGenealogy.text }}</textarea>
                            <p class="form-control-static">{{ structureOrGenealogy.text }}</p>
                        </div>
                    </div>
                </div>
                {{ widgets.scmModal(X, inEdit, showSubElements, "structureOrGenealogy", i, "Structure or Genealogy " ~ i, "Structure or Genealogy", structureOrGenealogy) }}
                {{ widgets.optionsList(X, inEdit, showSubElements, "structureOrGenealogy", i) }}
            </div>
        </div>
{% endmacro %}


{% macro displayBiogHist(X, inEdit, showSubElements, biogHist, i) %}
    {% import 'widgets.html' as widgets %}
    <div class="panel-body" id="biogHist_panel_{{i}}">
        <div class="col-sm-10" id="biogHist_datapart_{{i}}">
            <input type="hidden" id="biogHist_id_{{i}}" name="biogHist_id_{{i}}" value="{{biogHist.id}}"/>
            <input type="hidden" id="biogHist_version_{{i}}" name="biogHist_version_{{i}}" value="{{biogHist.version}}"/>
            {% if biogHist.id %}
                <input type="hidden" id="biogHist_operation_{{i}}" name="biogHist_operation_{{i}}" value=""/>
            {% else %}
                <input type="hidden" id="biogHist_operation_{{i}}" name="biogHist_operation_{{i}}" value="insert"/>
            {% endif %}
            <div class="bioghist-text" id="textarea_biogHist_text_{{i}}">
                <input type="hidden" id="biogHist_text_{{i}}" name="biogHist_text_{{i}}" value="{{ biogHist.text|e }}"/>
                <div class="panel panel-default panel-body form-control-static">{{ biogHist.text|raw }}</div>
            </div>


            <input type="hidden" id="biogHist_language_id_{{i}}" name="biogHist_language_id_{{i}}" value="{{biogHist.language.id}}"/>
            <input type="hidden" id="biogHist_language_version_{{i}}" name="biogHist_language_version_{{i}}" value="{{biogHist.language.version}}"/>
            <div class="form-group">
                <label class="control-label col-xs-4" data-content="{{X.language.tooltip}}" data-toggle="popover" data-placement="top">
                    {{ X.language.display }}
                </label>
                <div class="col-xs-8">
                    <div class="input-group select2-bootstrap-append">
                        <div id="select_biogHist_languagelanguage_{{i}}">
                            <input id="biogHist_languagelanguage_id_{{i}}" name="biogHist_languagelanguage_id_{{i}}" type="hidden" class="form-control" value="{{ biogHist.language.language.id }}"/>
                            <input id="biogHist_languagelanguage_term_{{i}}" name="biogHist_languagelanguage_term_{{i}}" type="hidden" class="form-control" value="{{ biogHist.language.language.term }}"/>
                            <input id="biogHist_languagelanguage_vocabtype_{{i}}" name="biogHist_languagelanguage_vocabtype_{{i}}" type="hidden" class="form-control" value="language_code"/>
                            <input id="biogHist_languagelanguage_minlength_{{i}}" name="biogHist_languagelanguage_minlength_{{i}}" type="hidden" class="form-control" value="0"/>
                            <p class="form-control-static">{{ biogHist.language.language.term }}</p>
                        </div>
                        <span class="input-group-btn">
                            <button class="btn btn-primary snac-hidden"
                                id="biogHist_languagelanguage_magic_{{i}}" disabled
                                onClick="magicDefaultFill('biogHist_languagelanguage_id_{{i}}', 'language'); return false;"
                                title="Apply user's default value">
                                <i class="fa fa-magic" aria-hidden="true"></i>
                            </button>
                        </span>
                    </div>
                </div>
            </div>


            <div class="form-group">
                <label class="control-label col-xs-4" data-content="{{X.script.tooltip}}" data-toggle="popover" data-placement="top">
                    {{ X.script.display }}
                </label>
                <div class="col-xs-8">
                    <div class="input-group select2-bootstrap-append">
                        <div id="select_biogHist_languagescript_{{i}}">
                            <input id="biogHist_languagescript_id_{{i}}" name="biogHist_languagescript_id_{{i}}" type="hidden" class="form-control" value="{{ biogHist.language.script.id }}"/>
                            <input id="biogHist_languagescript_term_{{i}}" name="biogHist_languagescript_term_{{i}}" type="hidden" class="form-control" value="{{ biogHist.language.script.term }}"/>
                            <input id="biogHist_languagescript_vocabtype_{{i}}" name="biogHist_languagescript_vocabtype_{{i}}" type="hidden" class="form-control" value="script_code"/>
                            <input id="biogHist_languagescript_minlength_{{i}}" name="biogHist_languagescript_minlength_{{i}}" type="hidden" class="form-control" value="0"/>
                            <p class="form-control-static">{{ biogHist.language.script.term }}</p>
                        </div>
                        <span class="input-group-btn">
                            <button class="btn btn-primary snac-hidden"
                                id="biogHist_languagescript_magic_{{i}}" disabled
                                onClick="magicDefaultFill('biogHist_languagescript_id_{{i}}', 'script'); return false;"
                                title="Apply user's default value">
                                <i class="fa fa-magic" aria-hidden="true"></i>
                            </button>
                        </span>
                    </div>
                </div>
            </div>
        </div>

        {{ widgets.scmModal(X, inEdit, showSubElements, "biogHist", i, "BiogHist", "BiogHist", biogHist) }}
        {{ widgets.optionsList(X, inEdit, showSubElements, "biogHist", i) }}
    </div>
{% endmacro %}

{% macro displayMandate(X, inEdit, showSubElements, mandate, i) %}
    {% import 'widgets.html' as widgets %}
        <div class="panel panel-default" id="mandate_panel_{{i}}">
            <div class="panel-body">
                    <div class="col-sm-10" id="mandate_datapart_{{i}}">
                        <input type="hidden" id="mandate_id_{{i}}" name="mandate_id_{{i}}" value="{{mandate.id}}"/>
                        <input id="mandate_version_{{i}}" name="mandate_version_{{i}}" type="hidden" value="{{ mandate.version }}"/>
                        <input id="mandate_operation_{{i}}" name="mandate_operation_{{i}}" type="hidden" value="{{ mandate.operation }}"/>
                        <div class="form-group">
                            <label for="mandate_text_{{i}}" class="control-label col-xs-2" data-content="{{X.xml.tooltip}}" data-toggle="popover" data-placement="top">
                                {{ X.xml.display }}
                            </label>
                            <div class="col-xs-10" id="textarea_mandate_text_{{i}}">
                                <textarea id="mandate_text_{{i}}" name="mandate_text_{{i}}" class="form-control" style="display:none;">{{ mandate.text }}</textarea>
                                <p class="form-control-static">{{ mandate.text }}</p>
                            </div>
                        </div>
                    </div>
                    {{ widgets.scmModal(X, inEdit, showSubElements, "mandate", i, "Mandate " ~ i, "Mandate", mandate) }}
                    {{ widgets.optionsList(X, inEdit, showSubElements, "mandate", i) }}
            </div>
        </div>
{% endmacro %}

{% macro displayExist(X, inEdit, showSubElements, exist, i) %}
    {% import 'widgets.html' as widgets %}
    {% import 'date_entry.html' as dates %}


    {% if exist.isRange %}
        {{ dates.dateRangeEntry(X, inEdit, showSubElements, 'Exist Dates', 'exist', exist, i) }}
    {% else %}
        {{ dates.dateEntry(X, inEdit, showSubElements, 'Exist Dates', 'exist', exist, i) }}
    {% endif %}

{% endmacro %}

{% macro displaySCM(X, inEdit, showSubElements, short, i, j, scm) %}
    {% import 'widgets.html' as widgets %}
       <div class="panel panel-default" id="scm_{{short}}_panel_{{j}}_{{i}}">
            <div class="panel-body">
                <div class="{{ showSubElements and inEdit ? 'col-xs-10' : 'col-xs-12' }}" id="scm_{{short}}_datapart_{{j}}_{{i}}">
                    <input id="scm_{{short}}_id_{{j}}_{{i}}" name="scm_{{short}}_id_{{j}}_{{i}}" type="hidden" value="{{ scm.id }}"/>
                    <input id="scm_{{short}}_version_{{j}}_{{i}}" name="scm_{{short}}_version_{{j}}_{{i}}" type="hidden" value="{{ scm.version }}"/>
                    <input id="scm_{{short}}_operation_{{j}}_{{i}}" name="scm_{{short}}_operation_{{j}}_{{i}}" type="hidden" value="{{ scm.operation }}"/>
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            Source Citation
                        </div>
                        <div class="panel-body {{not scm.citation.text ? 'hidden'}}">
                            <p id="scm_{{short}}_source_text_{{j}}_{{i}}" class="{{not scm.citation.text ? 'hidden'}}" style="">{{scm.citation.text|e|raw|nl2br}}</p>
                        </div>
                        <div class="panel-footer">
                            <p id="scm_{{short}}_source_citation_{{j}}_{{i}}" class="scm-source-panel {{ not scm.citation.citation ? 'hidden'}}">{{scm.citation.citation|raw}}</p>
                            <p id="scm_{{short}}_source_uri_{{j}}_{{i}}" class="">
                                {% if scm.citation.uri %}
                                <a href="{{scm.citation.uri}}" target="_blank">{{scm.citation.uri}}</a>
                                {% endif %}
                            </p>
                        </div>
                    </div>
                    {% if inEdit %}
                    <div class="form-group">
                        <label class="control-label col-xs-4" data-content="{{X.scmCitation.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.scmCitation.display }}
                            </label>
                        <div class="col-xs-8" id="select_scm_{{short}}_citation_{{j}}_{{i}}">
                            <input id="scm_{{short}}_citation_id_{{j}}_{{i}}" name="scm_{{short}}_citation_id_{{j}}_{{i}}" type="hidden" class="form-control" value="{{ scm.citation.id }}"/>
                            <input id="scm_{{short}}_citation_term_{{j}}_{{i}}" name="scm_{{short}}_citation_term_{{j}}_{{i}}" type="hidden" class="form-control" value="{{scm.citation.displayName}}"/>
                            <input id="scm_{{short}}_citation_vocabtype_{{j}}_{{i}}" name="scm_{{short}}_citation_vocabtype_{{j}}_{{i}}" type="hidden" class="form-control" value="ic_sources"/>
                            <input id="scm_{{short}}_citation_minlength_{{j}}_{{i}}" name="scm_{{short}}_citation_minlength_{{j}}_{{i}}" type="hidden" class="form-control" value="0"/>
                            <p class="form-control-static">{{scm.citation.displayName}}</p>
                        </div>
                    </div>
                    {% endif %}


                    <div class="form-group">
                        <label for="scm_{{short}}_subCitation_{{j}}_{{i}}" class="control-label col-xs-4" data-content="{{X.scmSubCitation.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.scmSubCitation.display }}
                        </label>
                        <div class="col-xs-8" id="text_scm_{{short}}_subCitation_{{j}}_{{i}}">
                            <input id="scm_{{short}}_subCitation_{{j}}_{{i}}" name="scm_{{short}}_subCitation_{{j}}_{{i}}" type="hidden" class="form-control" value="{{ scm.subCitation }}"/>
                            <p class="form-control-static">{{ scm.subCitation }}</p>
                        </div>
                    </div>
                    <div class="form-group" style="display: none;">
                        <label for="scm_{{short}}_sourceData_{{j}}_{{i}}" class="control-label col-xs-4" data-content="{{X.scmSourceData.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.scmSourceData.display }}
                        </label>
                        <div class="col-xs-8" id="textarea_scm_{{short}}_sourceData_{{j}}_{{i}}">
                            <textarea id="scm_{{short}}_sourceData_{{j}}_{{i}}" name="scm_{{short}}_sourceData_{{j}}_{{i}}" class="form-control" style="display:none;">{{ scm.sourceData }}</textarea>
                            <p class="form-control-static">{{ scm.sourceData | replace({" ": "&nbsp;"}) | raw | nl2br }}</p>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="scm_{{short}}_note_{{j}}_{{i}}" class="control-label col-xs-4" data-content="{{X.scmNote.tooltip}}" data-toggle="popover" data-placement="top">
                            {{ X.scmNote.display }}
                        </label>
                        <div class="col-xs-8" id="textarea_scm_{{short}}_note_{{j}}_{{i}}">
                            <textarea id="scm_{{short}}_note_{{j}}_{{i}}" name="scm_{{short}}_note_{{j}}_{{i}}" class="form-control" style="display:none;">{{ scm.note }}</textarea>
                            <p class="form-control-static">{{ scm.note }}</p>
                        </div>
                    </div>


                </div>
                {{ widgets.scmOptionsList(X, inEdit, showSubElements, short, i, j) }}

            </div>
        </div>

{% endmacro %}
