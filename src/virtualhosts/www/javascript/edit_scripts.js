(function(e, a) { for(var i in a) e[i] = a[i]; }(window, /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 3);
/******/ })
/************************************************************************/
/******/ ({

/***/ 3:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"somethingHasBeenEdited\", function() { return somethingHasBeenEdited; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"setEditedFlag\", function() { return setEditedFlag; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"undoSet\", function() { return undoSet; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"defaults\", function() { return defaults; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"displayErrorMessage\", function() { return displayErrorMessage; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"addDateEntry\", function() { return addDateEntry; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"addDateRangeEntry\", function() { return addDateRangeEntry; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"addSCMEntry\", function() { return addSCMEntry; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"makeEditable\", function() { return makeEditable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"makeUneditable\", function() { return makeUneditable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"makeSCMUneditable\", function() { return makeSCMUneditable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"setRepeatedDataDeleted\", function() { return setRepeatedDataDeleted; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"newAddressLine\", function() { return newAddressLine; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"newNameEntryComponent\", function() { return newNameEntryComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"updateNameEntryHeading\", function() { return updateNameEntryHeading; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"newNameEntryRule\", function() { return newNameEntryRule; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"updateDate\", function() { return updateDate; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"chooseSuggestedGeoPlace\", function() { return chooseSuggestedGeoPlace; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"magicDefaultFill\", function() { return magicDefaultFill; });\n/**\n * Edit Scripts\n *\n * Scripts used in the edit page\n *\n * @author Robbie Hott\n * @license https://opensource.org/licenses/BSD-3-Clause BSD 3-Clause\n * @copyright 2015 the Rector and Visitors of the University of Virginia, and\n *            the Regents of the University of California\n */\n\nvar biogHistEditor = null;\n\n// Has anything been edited on this page?\nvar somethingHasBeenEdited = false;\n\nfunction setEditedFlag(val) {\n    if (val == true) {\n        $(\"#save_and_continue\").addClass(\"save-active\");\n    } else {\n        $(\"#save_and_continue\").removeClass(\"save-active\");\n    }\n    somethingHasBeenEdited = val;\n}\n\n// Global Undo Set\nvar undoSet = new Array();\n\nvar defaults = {\n    language: {\n        id: 130,\n        term: \"eng\"\n    },\n    script: {\n        id: 586,\n        term: \"Latn\"\n    }\n};\n\n/**\n * Display Error message\n *\n * Displays the error message box to the user with the given error message\n *\n * @param string|object err The error message (string) or error object containing a message and type string\n */\nfunction displayErrorMessage(err, data) {\n    var errorMsg = \"\";\n    if (typeof err === 'undefined') errorMsg = \"an unknown problem occurred\";else if (typeof err == \"string\") errorMsg = err;else if (err.message) errorMsg = err.message;else if (err.type) errorMsg = err.type;else errorMsg = \"an unknown problem occurred\";\n\n    $('#error-message').html(\"<h4>Oops</h4><p>\" + errorMsg + \"</p>\" + \"<p class=\\\"text-right\\\">\" + \"<button type=\\\"button\\\" class=\\\"btn btn-warning\\\" aria-label=\\\"Close\\\" onClick=\\\"$('#error-message').slideUp()\\\">\" + \"Stay Here\" + \"</button> \" + \"<a href=\\\"\" + snacUrl + \"/dashboard\\\" type=\\\"button\\\" class=\\\"btn btn-danger\\\">\" + \"Go to Dashboard\" + \"</a>\" + \"</p>\");\n    setTimeout(function () {\n        $('#error-message').slideDown();\n    }, 500);\n\n    // For reference, put the server response in the console\n    console.log(data);\n}\n\n/**\n * Add sub-Date GUI object\n *\n * Adds a Date GUI object to the Date modal for the given \"short\" type of data indexed by i\n *\n * @param string short The short name of the data object, such as \"nameEntry\" or \"occupation\"\n * @param string|int i The index of the object to add a date object to.\n * @returns boolean false to keep the browser from redrawing the page\n */\nfunction addDateEntry(short, i) {\n    //next_date_{{short}}_{{i}}_j\n    var j = parseInt($('#next_date_' + short + '_' + i + '_j').text());\n    var id = j + \"_\" + i;\n    setEditedFlag(true);\n    //somethingHasBeenEdited = true;\n    var text = $('#sub_date_template').clone();\n    var html = text.html().replace(/ZZ/g, i).replace(/XX/g, j).replace(/SHORT/g, short);\n    $('#add_date_' + short + '_' + i + '_div').after(html);\n    $('#next_date_' + short + '_' + i + '_j').text(j + 1);\n    turnOnButtons(short + \"_date\" + j, i);\n    turnOnTooltips(short + \"_date_\" + j, i);\n    makeEditable(short + \"_date_\" + j, i);\n    return false;\n}\n\n/**\n * Add sub-Date GUI object\n *\n * Adds a Date GUI object to the Date modal for the given \"short\" type of data indexed by i\n *\n * @param string short The short name of the data object, such as \"nameEntry\" or \"occupation\"\n * @param string|int i The index of the object to add a date object to.\n * @returns boolean false to keep the browser from redrawing the page\n */\nfunction addDateRangeEntry(short, i) {\n    //next_date_{{short}}_{{i}}_j\n    var j = parseInt($('#next_date_' + short + '_' + i + '_j').text());\n    var id = j + \"_\" + i;\n    setEditedFlag(true);\n    //somethingHasBeenEdited = true;\n    var text = $('#sub_dateRange_template').clone();\n    var html = text.html().replace(/ZZ/g, i).replace(/XX/g, j).replace(/SHORT/g, short);\n    $('#add_date_' + short + '_' + i + '_div').after(html);\n    $('#next_date_' + short + '_' + i + '_j').text(j + 1);\n    turnOnButtons(short + \"_date\" + j, i);\n    turnOnTooltips(short + \"_date_\" + j, i);\n    makeEditable(short + \"_date_\" + j, i);\n    return false;\n}\n\n/**\n * Add SCM GUI object\n *\n * Adds a GUI SCM object to the SCM modal for the given \"short\" type of data indexed by i\n *\n * @param string short The short name of the data object, such as \"nameEntry\" or \"occupation\"\n * @param string|int i The index of the object to add an SCM object to.\n * @returns boolean false to keep the browser from redrawing the page\n */\nfunction addSCMEntry(short, i) {\n    //next_scm_{{short}}_{{i}}_j\n    var j = parseInt($('#next_scm_' + short + '_' + i + '_j').text());\n    var id = j + \"_\" + i;\n    setEditedFlag(true);\n    //somethingHasBeenEdited = true;\n    var text = $('#scm_template').clone();\n    var html = text.html().replace(/ZZ/g, i).replace(/YY/g, j).replace(/SHORT/g, short);\n    $('#add_scm_' + short + '_' + i + '_div').after(html);\n    $('#next_scm_' + short + '_' + i + '_j').text(j + 1);\n    turnOnSCMButtons(short, i, j);\n    turnOnTooltips(\"scm_\" + short, id);\n    makeSCMEditable(short, i, j);\n    return false;\n}\n\n/**\n * Undo Edit\n *\n * Returns the html for the (short, i) panel back to its original state, i.e. removes\n * the edit.  Before doing this, to clean up the page, it first makes the edited version\n * uneditable.\n *\n * @param string short The short name of the data object, such as \"nameEntry\" or \"occupation\"\n * @param string|int i The index within the edit page of the object.\n */\nfunction undoEdit(short, i) {\n    makeUneditable(short, i);\n\n    // restore the old content\n    $(\"#\" + short + \"_datapart_\" + i).replaceWith(undoSet[short + \"-\" + i]);\n    turnOnTooltips(short, i);\n    $(\"#\" + short + \"_datapart_\" + i + \" input[type='checkbox']\").each(function () {\n        var obj = $(this);\n        obj.bootstrapToggle();\n    });\n}\n\n/**\n * Undo SCM Edit\n *\n * Takes an SCM GUI object (j) for a data object (short, i) and returns it back to its\n * original state (removing the edit).  Before doing this, to clean up the page and JS, it first\n * makes the edited version uneditable, then replaces the HTML.\n *\n * @param string short The short name of the data object, such as \"nameEntry\" or \"occupation\"\n * @param string|int i The index within the edit page of the object.\n * @param string|int j The index within the data object SCM list on the edit page of the SCM object.\n */\nfunction undoSCMEdit(short, i, j) {\n    var id = j + \"_\" + i;\n    makeSCMUneditable(short, i, j);\n\n    // restore the old content\n    $(\"#scm_\" + short + \"_datapart_\" + id).replaceWith(undoSet[\"scm_\" + short + \"-\" + id]);\n    turnOnTooltips(\"scm_\" + short, id);\n}\n\n/**\n * Change vocabulary input divs to selects\n *\n * Changes all div's with id \"select_\" for a given data object (shortName, idStr) from a list of\n * inputs defining the parameters to a select (view mode) to a select box (edit mode).  It then\n * calls the select2 function to replace the select with an AJAX-compatible select.\n *\n * This function handles VOCABULARY select boxes ONLY.\n *\n * Note: idStr must not have the \"_\" pre-appended\n *\n * @param string shortName The short name of the data object, such as \"nameEntry\" or \"occupation\"\n * @param string|int idStr The index within the edit page of the object.\n */\nfunction textToSelect(shortName, idStr) {\n    $(\"#\" + shortName + \"_datapart_\" + idStr + \" div[id^='select_\" + shortName + \"']\").each(function () {\n        var cont = $(this);\n        if (cont.attr('id').endsWith(\"_\" + idStr) && !cont.attr('id').endsWith(\"ZZ\")) {\n            // remove the short name and \"select_\" from the string we're parsing\n            var divStr = cont.attr('id').replace(\"select_\", \"\").replace(shortName + \"_\", \"\");\n            // remove the idstr to receive the name of this element\n            var regex = new RegExp(\"\\_\" + idStr + \"$\", \"g\");\n            var name = divStr.replace(regex, \"\");\n            var id = $(\"#\" + shortName + \"_\" + name + \"_id_\" + idStr).val();\n            var term = $(\"#\" + shortName + \"_\" + name + \"_term_\" + idStr).val();\n            var vocabtype = $(\"#\" + shortName + \"_\" + name + \"_vocabtype_\" + idStr).val();\n            var minlength = $(\"#\" + shortName + \"_\" + name + \"_minlength_\" + idStr).val();\n            var placeholder = \"Select\";\n            if ($(\"#\" + shortName + \"_\" + name + \"_placeholder_\" + idStr).exists()) {\n                placeholder = $(\"#\" + shortName + \"_\" + name + \"_placeholder_\" + idStr).val();\n            }\n            var options = \"\";\n            if ($(\"#\" + shortName + \"_\" + name + \"_defaultOptions_\" + idStr).exists()) {\n                options = $(\"#\" + shortName + \"_\" + name + \"_defaultOptions_\" + idStr).val();\n            }\n\n            cont.html(\"<select id='\" + shortName + \"_\" + name + \"_id_\" + idStr + \"' name='\" + shortName + \"_\" + name + \"_id_\" + idStr + \"' class='form-control' data-placeholder='\" + placeholder + \"'>\" + \"<option></option>\" + \"<option value=\\\"\" + id + \"\\\" selected>\" + term + \"</option>\" + options + \"</select>\" + \"<input type=\\\"hidden\\\" id=\\\"\" + shortName + \"_\" + name + \"_vocabtype_\" + idStr + \"\\\" \" + \"name=\\\"\" + shortName + \"_\" + name + \"_vocabtype_\" + idStr + \"\\\" value=\\\"\" + vocabtype + \"\\\"/>\" + \"<input type=\\\"hidden\\\" id=\\\"\" + shortName + \"_\" + name + \"_minlength_\" + idStr + \"\\\" \" + \"name=\\\"\" + shortName + \"_\" + name + \"_minlength_\" + idStr + \"\\\" value=\\\"\" + minlength + \"\\\"/>\");\n\n            if (name == \"citation\") scm_source_select_replace($(\"#\" + shortName + \"_\" + name + \"_id_\" + idStr), \"_\" + idStr);else vocab_select_replace($(\"#\" + shortName + \"_\" + name + \"_id_\" + idStr), \"_\" + idStr, vocabtype, minlength);\n        }\n    });\n}\n\nfunction textToCheckbox(shortName, idStr) {\n    $(\"#\" + shortName + \"_datapart_\" + idStr + \" div[id^='checkbox_\" + shortName + \"']\").each(function () {\n        var cont = $(this);\n        if (cont.attr('id').endsWith(\"_\" + idStr) && !cont.attr('id').endsWith(\"ZZ\")) {\n            // remove the short name and \"select_\" from the string we're parsing\n            var divStr = cont.attr('id').replace(/^checkbox_/, \"\").replace(shortName + \"_\", \"\");\n            // remove the idstr to receive the name of this element\n            var regex = new RegExp(\"\\_\" + idStr + \"$\", \"g\");\n            var name = divStr.replace(regex, \"\");\n            var value = $(\"#\" + shortName + \"_\" + name + \"_\" + idStr).val();\n            var placeholderOn = \"\";\n            if ($(\"#\" + shortName + \"_\" + name + \"_placeholderOn_\" + idStr).exists()) {\n                placeholderOn = $(\"#\" + shortName + \"_\" + name + \"_placeholderOn_\" + idStr).val();\n            }\n            var placeholderOff = \"\";\n            if ($(\"#\" + shortName + \"_\" + name + \"_placeholderOff_\" + idStr).exists()) {\n                placeholderOff = $(\"#\" + shortName + \"_\" + name + \"_placeholderOff_\" + idStr).val();\n            }\n\n            var html = \"<input id='\" + shortName + \"_\" + name + \"_\" + idStr + \"' name='\" + shortName + \"_\" + name + \"_\" + idStr + \"' class='form-control' type='checkbox' value=\\\"checked\\\"\" + \"data-on=\\\"\" + placeholderOn + \"\\\" data-off=\\\"\" + placeholderOff + \"\\\"\";\n            if (value == 'checked') html += \" checked\";\n            html += \"/>\";\n            if (placeholderOn != \"\") {\n                html += \"<input type=\\\"hidden\\\" id=\\\"\" + shortName + \"_\" + name + \"_placeholderOn_\" + idStr + \"\\\" \" + \"value=\\\"\" + placeholderOn + \"\\\"/>\";\n            }\n            if (placeholderOff != \"\") {\n                html += \"<input type=\\\"hidden\\\" id=\\\"\" + shortName + \"_\" + name + \"_placeholderOff_\" + idStr + \"\\\" \" + \"value=\\\"\" + placeholderOff + \"\\\"/>\";\n            }\n\n            cont.html(html);\n            $(\"#\" + shortName + \"_\" + name + \"_\" + idStr).bootstrapToggle();\n        }\n    });\n}\n\nfunction checkboxToText(shortName, idStr) {\n    $(\"#\" + shortName + \"_datapart_\" + idStr + \" div[id^='checkbox_\" + shortName + \"']\").each(function () {\n        var cont = $(this);\n        if (cont.attr('id').endsWith(\"_\" + idStr) && !cont.attr('id').endsWith(\"ZZ\")) {\n            // remove the short name and \"select_\" from the string we're parsing\n            var divStr = cont.attr('id').replace(/^checkbox_/, \"\").replace(shortName + \"_\", \"\");\n            // remove the idstr to receive the name of this element\n            var regex = new RegExp(\"\\_\" + idStr + \"$\", \"g\");\n            var name = divStr.replace(regex, \"\");\n            var value = $(\"#\" + shortName + \"_\" + name + \"_\" + idStr).val();\n            var checked = $(\"#\" + shortName + \"_\" + name + \"_\" + idStr).prop('checked');\n            var placeholderOn = \"\";\n            if ($(\"#\" + shortName + \"_\" + name + \"_placeholderOn_\" + idStr).exists()) {\n                placeholderOn = $(\"#\" + shortName + \"_\" + name + \"_placeholderOn_\" + idStr).val();\n            }\n            var placeholderOff = \"\";\n            if ($(\"#\" + shortName + \"_\" + name + \"_placeholderOff_\" + idStr).exists()) {\n                placeholderOff = $(\"#\" + shortName + \"_\" + name + \"_placeholderOff_\" + idStr).val();\n            }\n\n            var html = \"<input id='\" + shortName + \"_\" + name + \"_\" + idStr + \"' name='\" + shortName + \"_\" + name + \"_\" + idStr + \"' type='hidden' value=\\\"\";\n            if (checked) html += \"checked\";\n            html += \"\\\"/>\";\n\n            html += \"<p class='form-control-static'>\";\n            if (checked) {\n                if (placeholderOn != \"\") html += placeholderOn;else html += value;\n            } else {\n                if (placeholderOff != \"\") html += placeholderOff;\n            }\n            html += \"</p>\";\n            if (placeholderOn != \"\") {\n                html += \"<input type=\\\"hidden\\\" id=\\\"\" + shortName + \"_\" + name + \"_placeholderOn_\" + idStr + \"\\\" \" + \"value=\\\"\" + placeholderOn + \"\\\"/>\";\n            }\n            if (placeholderOff != \"\") {\n                html += \"<input type=\\\"hidden\\\" id=\\\"\" + shortName + \"_\" + name + \"_placeholderOff_\" + idStr + \"\\\" \" + \"value=\\\"\" + placeholderOff + \"\\\"/>\";\n            }\n\n            $(\"#\" + shortName + \"_\" + name + \"_\" + idStr).bootstrapToggle(\"destroy\");\n            cont.html(html);\n        }\n    });\n}\n\nfunction textToInput(shortName, idStr) {\n    $(\"#\" + shortName + \"_datapart_\" + idStr + \" div[id^='text_\" + shortName + \"']\").each(function () {\n        var cont = $(this);\n        if (cont.attr('id').endsWith(\"_\" + idStr) && !cont.attr('id').endsWith(\"ZZ\")) {\n            // remove the short name and \"select_\" from the string we're parsing\n            var divStr = cont.attr('id').replace(/^text_/, \"\").replace(shortName + \"_\", \"\");\n            // remove the idstr to receive the name of this element\n            var regex = new RegExp(\"\\_\" + idStr + \"$\", \"g\");\n            var name = divStr.replace(regex, \"\");\n            var value = $(\"#\" + shortName + \"_\" + name + \"_\" + idStr).val();\n            var size = 0;\n            var sizeStr = \"\";\n            if ($(\"#\" + shortName + \"_\" + name + \"_size_\" + idStr).exists()) {\n                size = parseInt($(\"#\" + shortName + \"_\" + name + \"_size_\" + idStr).val());\n                sizeStr = \" size='\" + size + \"' \";\n            }\n            var placeholder = \"\";\n            if ($(\"#\" + shortName + \"_\" + name + \"_placeholder_\" + idStr).exists()) {\n                placeholder = $(\"#\" + shortName + \"_\" + name + \"_placeholder_\" + idStr).val();\n            }\n\n            var onKeyUp = \"\";\n            if ($(\"#\" + shortName + \"_\" + name + \"_onKeyUp_\" + idStr).exists()) {\n                onKeyUp = $(\"#\" + shortName + \"_\" + name + \"_onKeyUp_\" + idStr).val();\n            }\n            var onKeyUpStr = \"\";\n            if (onKeyUp != \"\") {\n                onKeyUpStr = \" onKeyUp='\" + onKeyUp + \"' \";\n            }\n\n            var html = \"<input id='\" + shortName + \"_\" + name + \"_\" + idStr + \"' name='\" + shortName + \"_\" + name + \"_\" + idStr + \"' class='form-control' type='text' value=\\\"\" + value + \"\\\"\" + sizeStr + onKeyUpStr + \"placeholder=\\\"\" + placeholder + \"\\\"/>\";\n            if (size != 0) {\n                html += \"<input type=\\\"hidden\\\" id=\\\"\" + shortName + \"_\" + name + \"_size_\" + idStr + \"\\\" \" + \"value=\\\"\" + size + \"\\\"/>\";\n            }\n            if (placeholder != \"\") {\n                html += \"<input type=\\\"hidden\\\" id=\\\"\" + shortName + \"_\" + name + \"_placeholder_\" + idStr + \"\\\" \" + \"value=\\\"\" + placeholder + \"\\\"/>\";\n            }\n            if (onKeyUp != \"\") {\n                html += \"<input type=\\\"hidden\\\" id=\\\"\" + shortName + \"_\" + name + \"_onKeyUp_\" + idStr + \"\\\" \" + \"value=\\\"\" + onKeyUp + \"\\\"/>\";\n            }\n\n            cont.html(html);\n        }\n    });\n}\n\nfunction inputToText(shortName, idStr) {\n    $(\"#\" + shortName + \"_datapart_\" + idStr + \" div[id^='text_\" + shortName + \"']\").each(function () {\n        var cont = $(this);\n        if (cont.attr('id').endsWith(\"_\" + idStr) && !cont.attr('id').endsWith(\"ZZ\")) {\n            // remove the short name and \"select_\" from the string we're parsing\n            var divStr = cont.attr('id').replace(/^text_/, \"\").replace(shortName + \"_\", \"\");\n            // remove the idstr to receive the name of this element\n            var regex = new RegExp(\"\\_\" + idStr + \"$\", \"g\");\n            var name = divStr.replace(regex, \"\");\n            var value = $(\"#\" + shortName + \"_\" + name + \"_\" + idStr).val();\n            var size = 0;\n            if ($(\"#\" + shortName + \"_\" + name + \"_size_\" + idStr).exists()) {\n                size = parseInt($(\"#\" + shortName + \"_\" + name + \"_size_\" + idStr).val());\n            }\n            var placeholder = \"\";\n            if ($(\"#\" + shortName + \"_\" + name + \"_placeholder_\" + idStr).exists()) {\n                placeholder = $(\"#\" + shortName + \"_\" + name + \"_placeholder_\" + idStr).val();\n            }\n            var onKeyUp = \"\";\n            if ($(\"#\" + shortName + \"_\" + name + \"_onKeyUp_\" + idStr).exists()) {\n                onKeyUp = $(\"#\" + shortName + \"_\" + name + \"_onKeyUp_\" + idStr).val();\n            }\n\n            var html = \"<input id='\" + shortName + \"_\" + name + \"_\" + idStr + \"' name='\" + shortName + \"_\" + name + \"_\" + idStr + \"' type='hidden' value=\\\"\" + value + \"\\\"/>\";\n            html += \"<p class='form-control-static'>\" + value + \"</p>\";\n            if (size != 0) {\n                html += \"<input type=\\\"hidden\\\" id=\\\"\" + shortName + \"_\" + name + \"_size_\" + idStr + \"\\\" \" + \"value=\\\"\" + size + \"\\\"/>\";\n            }\n            if (placeholder != \"\") {\n                html += \"<input type=\\\"hidden\\\" id=\\\"\" + shortName + \"_\" + name + \"_placeholder_\" + idStr + \"\\\" \" + \"value=\\\"\" + placeholder + \"\\\"/>\";\n            }\n            if (onKeyUp != \"\") {\n                html += \"<input type=\\\"hidden\\\" id=\\\"\" + shortName + \"_\" + name + \"_onKeyUp_\" + idStr + \"\\\" \" + \"value=\\\"\" + onKeyUp + \"\\\"/>\";\n            }\n\n            cont.html(html);\n        }\n    });\n}\n\nfunction textToTextArea(shortName, idStr) {\n    $(\"#\" + shortName + \"_datapart_\" + idStr + \" div[id^='textarea_\" + shortName + \"']\").each(function () {\n        var cont = $(this);\n        if (cont.attr('id').endsWith(\"_\" + idStr) && !cont.attr('id').endsWith(\"ZZ\")) {\n            // remove the short name and \"select_\" from the string we're parsing\n            var divStr = cont.attr('id').replace(/^textarea_/, \"\").replace(shortName + \"_\", \"\");\n            // remove the idstr to receive the name of this element\n            var regex = new RegExp(\"\\_\" + idStr + \"$\", \"g\");\n            var name = divStr.replace(regex, \"\");\n            var value = $(\"#\" + shortName + \"_\" + name + \"_\" + idStr).val();\n\n            var html = \"<textarea id='\" + shortName + \"_\" + name + \"_\" + idStr + \"' name='\" + shortName + \"_\" + name + \"_\" + idStr + \"' class='form-control' style='width: 100%;'>\" + value + \"</textarea>\";\n\n            cont.html(html);\n        }\n    });\n}\n\nfunction textAreaToText(shortName, idStr) {\n    $(\"#\" + shortName + \"_datapart_\" + idStr + \" div[id^='textarea_\" + shortName + \"']\").each(function () {\n        var cont = $(this);\n        if (cont.attr('id').endsWith(\"_\" + idStr) && !cont.attr('id').endsWith(\"ZZ\")) {\n            // remove the short name and \"select_\" from the string we're parsing\n            var divStr = cont.attr('id').replace(/^textarea_/, \"\").replace(shortName + \"_\", \"\");\n            // remove the idstr to receive the name of this element\n            var regex = new RegExp(\"\\_\" + idStr + \"$\", \"g\");\n            var name = divStr.replace(regex, \"\");\n            var value = $(\"#\" + shortName + \"_\" + name + \"_\" + idStr).val();\n\n            //var html = \"<input type='hidden' id='\"+shortName+\"_\"+name+\"_\"+idStr+\"' name='\"+shortName+\"_\"+name+\"_\"+\n            //        idStr+\"' value=\\\"\"+ value +\"\\\"/>\";\n            var html = \"<textarea style='display:none;' id='\" + shortName + \"_\" + name + \"_\" + idStr + \"' name='\" + shortName + \"_\" + name + \"_\" + idStr + \"'>\" + value + \"</textarea>\";\n            html += \"<div class='form-control-static'>\" + value + \"</div>\";\n\n            cont.html(html);\n        }\n    });\n}\n\n/**\n * Change vocabulary selects to divs of inputs\n *\n * Changes all div's with id \"select_\" for a given data object (shortName, idStr) from a select\n * box (edit mode) to a list of inputs defining the parameters to a select (view mode).\n *\n * This function handles VOCABULARY select boxes ONLY.\n *\n * Note: idStr must not have the \"_\" pre-appended\n *\n * @param string shortName The short name of the data object, such as \"nameEntry\" or \"occupation\"\n * @param string|int idStr The index within the edit page of the object.\n */\nfunction selectToText(shortName, idStr) {\n    $(\"div[id^='select_\" + shortName + \"']\").each(function () {\n        var cont = $(this);\n        if (cont.attr('id').endsWith(\"_\" + idStr) && !cont.attr('id').endsWith(\"ZZ\")) {\n            // remove the short name and \"select_\" from the string we're parsing\n            var divStr = cont.attr('id').replace(\"select_\", \"\").replace(shortName + \"_\", \"\");\n            // remove the idstr to receive the name of this element\n            var regex = new RegExp(\"\\_\" + idStr + \"$\", \"g\");\n            var name = divStr.replace(regex, \"\");\n            var id = $(\"#\" + shortName + \"_\" + name + \"_id_\" + idStr).val();\n            var term = $(\"#\" + shortName + \"_\" + name + \"_id_\" + idStr + \" option:selected\").text();\n            var vocabtype = $(\"#\" + shortName + \"_\" + name + \"_vocabtype_\" + idStr).val();\n            var minlength = $(\"#\" + shortName + \"_\" + name + \"_minlength_\" + idStr).val();\n\n            var additionalStyle = \"\";\n            var postText = \"\";\n            if (vocabtype == \"name_component\") {\n                additionalStyle = \"name-component-type\";\n                postText = \" :\";\n            }\n\n            cont.html(\"<input type=\\\"hidden\\\" id=\\\"\" + shortName + \"_\" + name + \"_id_\" + idStr + \"\\\" \" + \"name=\\\"\" + shortName + \"_\" + name + \"_id_\" + idStr + \"\\\" value=\\\"\" + id + \"\\\"/>\" + \"<input type=\\\"hidden\\\" id=\\\"\" + shortName + \"_\" + name + \"_term_\" + idStr + \"\\\" \" + \"name=\\\"\" + shortName + \"_\" + name + \"_term_\" + idStr + \"\\\" value=\\\"\" + term + \"\\\"/>\" + \"<input type=\\\"hidden\\\" id=\\\"\" + shortName + \"_\" + name + \"_vocabtype_\" + idStr + \"\\\" \" + \"name=\\\"\" + shortName + \"_\" + name + \"_vocabtype_\" + idStr + \"\\\" value=\\\"\" + vocabtype + \"\\\"/>\" + \"<input type=\\\"hidden\\\" id=\\\"\" + shortName + \"_\" + name + \"_minlength_\" + idStr + \"\\\" \" + \"name=\\\"\" + shortName + \"_\" + name + \"_minlength_\" + idStr + \"\\\" value=\\\"\" + minlength + \"\\\"/>\" + \"<p class=\\\"form-control-static \" + additionalStyle + \"\\\">\" + term + postText + \"</p>\");\n        }\n    });\n}\n\nvar geoPlaceLoadResults = null;\n\nfunction textToGeoPlaceSelect(shortName, idStr) {\n    $(\"#\" + shortName + \"_datapart_\" + idStr + \" div[id^='selectGeo_\" + shortName + \"']\").each(function () {\n        var cont = $(this);\n        if (cont.attr('id').endsWith(\"_\" + idStr) && !cont.attr('id').endsWith(\"ZZ\")) {\n            // remove the short name and \"select_\" from the string we're parsing\n            var divStr = cont.attr('id').replace(\"selectGeo_\", \"\").replace(shortName + \"_\", \"\");\n            // remove the idstr to receive the name of this element\n            var regex = new RegExp(\"\\_\" + idStr + \"$\", \"g\");\n            var name = divStr.replace(regex, \"\");\n            var id = $(\"#\" + shortName + \"_\" + name + \"_id_\" + idStr).val();\n            var term = $(\"#\" + shortName + \"_\" + name + \"_term_\" + idStr).val();\n            var placeholder = \"Select Geo Place Term\";\n\n            var confirmed = $(\"#\" + shortName + \"_confirmed_\" + idStr).val() == \"true\" ? true : false;\n            var firstOptionSelect = \"\";\n            var secondOptionSelect = \" selected\";\n            if (!confirmed) {\n                firstOptionSelect = \" selected\";\n                secondOptionSelect = \"\";\n            }\n\n            cont.html(\"<select id='\" + shortName + \"_\" + name + \"_id_\" + idStr + \"' name='\" + shortName + \"_\" + name + \"_id_\" + idStr + \"' class='form-control' data-placeholder='\" + placeholder + \"'>\" + \"<option\" + firstOptionSelect + \"></option>\" + \"<option value=\\\"\" + id + \"\\\"\" + secondOptionSelect + \">\" + term + \"</option>\" + \"</select>\");\n\n            geovocab_select_replace($(\"#\" + shortName + \"_\" + name + \"_id_\" + idStr), \"_\" + idStr);\n        }\n    });\n}\n\nfunction geoPlaceSelectToText(shortName, idStr) {\n    $(\"div[id^='selectGeo_\" + shortName + \"']\").each(function () {\n        var cont = $(this);\n        if (cont.attr('id').endsWith(\"_\" + idStr) && !cont.attr('id').endsWith(\"ZZ\")) {\n            // remove the short name and \"select_\" from the string we're parsing\n            var divStr = cont.attr('id').replace(\"selectGeo_\", \"\").replace(shortName + \"_\", \"\");\n            // remove the idstr to receive the name of this element\n            var regex = new RegExp(\"\\_\" + idStr + \"$\", \"g\");\n            var name = divStr.replace(regex, \"\");\n            var id = $(\"#\" + shortName + \"_\" + name + \"_id_\" + idStr).val();\n            var term = $(\"#\" + shortName + \"_\" + name + \"_id_\" + idStr + \" option:selected\").text();\n\n            cont.html(\"<input type=\\\"hidden\\\" id=\\\"\" + shortName + \"_\" + name + \"_id_\" + idStr + \"\\\" \" + \"name=\\\"\" + shortName + \"_\" + name + \"_id_\" + idStr + \"\\\" value=\\\"\" + id + \"\\\"/>\" + \"<input type=\\\"hidden\\\" id=\\\"\" + shortName + \"_\" + name + \"_term_\" + idStr + \"\\\" \" + \"name=\\\"\" + shortName + \"_\" + name + \"_term_\" + idStr + \"\\\" value=\\\"\" + term + \"\\\"/>\");\n        }\n    });\n}\n\n/**\n * Make a data object editable\n *\n * Make the GUI pane for a given constellation object (short, i) editable.  Sets up the edit and delete\n * buttons for first-order data objects.\n *\n * @param string shortName The short name of the data object, such as \"nameEntry\" or \"occupation\"\n * @param string|int i     The index within the edit page of the object.\n * @return boolean         False to play nice with the browser\n */\nfunction makeEditable(short, i) {\n    // No editing if it's already in edit mode\n    if ($(\"#\" + short + \"_operation_\" + i).val() == \"update\") return false;\n    // If it's deleted, then you better undelete it first\n    if ($(\"#\" + short + \"_operation_\" + i).val() == \"delete\") setDeleted(short, i);\n\n    $(\"#\" + short + \"_editbutton_\" + i).removeClass(\"list-group-item-info\").addClass(\"list-group-item-warning\");\n    $(\"#\" + short + \"_editbutton_\" + i).html(\"<span class=\\\"fa fa-2x fa-undo\\\"></span><br>Undo\");\n    $(\"#\" + short + \"_editbutton_\" + i).off('click').on(\"click\", function () {\n        undoEdit(short, i);\n    });\n    $(\"#\" + short + \"_deletebutton_\" + i).removeClass(\"list-group-item-danger\").addClass(\"disabled\");\n    $(\"#\" + short + \"_deletebutton_\" + i).off('click').on(\"click\", function () {\n        return false;\n    });\n\n    $(\"#\" + short + \"_panel_\" + i).removeClass(\"panel-default\").addClass(\"alert-info\").addClass(\"edited-component\");\n\n    return subMakeEditable(short, i);\n}\n\n/**\n * Make a data object editable\n *\n * Make the GUI pane for a given constellation object (short, i) editable.  Handles removing the read-only\n * statuses and changing divs into selects.\n *\n * @param string shortName The short name of the data object, such as \"nameEntry\" or \"occupation\"\n * @param string|int i     The index within the edit page of the object.\n * @return boolean         False to play nice with the browser\n */\nfunction subMakeEditable(short, i) {\n    // No editing if it's already in edit mode\n    if ($(\"#\" + short + \"_operation_\" + i).val() == \"update\") return false;\n\n    // Add to the undo set\n    undoSet[short + \"-\" + i] = $(\"#\" + short + \"_datapart_\" + i).clone();\n\n    textToInput(short, i);\n    textToTextArea(short, i);\n    textToCheckbox(short, i);\n\n    var idstr = \"_\" + i;\n\n    // Enable buttons\n    $(\"#\" + short + \"_datapart_\" + i + \" button[id^='\" + short + \"_']\").each(function () {\n        var obj = $(this);\n        if (obj.attr('id').endsWith(idstr) && !obj.attr('id').endsWith(\"ZZ\")) {\n            obj.removeAttr(\"disabled\").removeClass(\"snac-hidden\");\n        }\n    });\n    // Enable buttons\n    $(\"#\" + short + \"_datapart_\" + i + \" a.label\").each(function () {\n        $(this).removeClass(\"snac-hidden\");\n    });\n\n    // Enable checkboxes\n    $(\"#\" + short + \"_datapart_\" + i + \" input[type='checkbox']\").each(function () {\n        var obj = $(this);\n        if (obj.attr('id').endsWith(idstr) && !obj.attr('id').endsWith(\"ZZ\")) {\n            obj.bootstrapToggle('enable');\n        }\n    });\n\n    // Turn on CodeMirror Editors\n    $(\"#\" + short + \"_datapart_\" + i + \" textarea[id^='\" + short + \"_']\").each(function () {\n        var obj = $(this);\n        if (obj.attr('id').endsWith(idstr) && !obj.attr('id').endsWith(\"ZZ\")) {\n            // remove the short name from the string we're parsing\n            var idStr = obj.attr('id').replace(short, \"\");\n            if (idStr.indexOf('_text_') != -1 || idStr.indexOf('_source_') != -1) {\n                obj.get(0).CodeMirror = CodeMirror.fromTextArea(obj.get(0), {\n                    lineNumbers: true,\n                    lineWrapping: true,\n                    viewportMargin: Infinity,\n                    mode: { name: \"xml\" }\n                });\n            }\n        }\n    });\n    var sawSelect = false;\n    $(\"#\" + short + \"_datapart_\" + i + \" select[id^='\" + short + \"_']\").each(function () {\n        var obj = $(this);\n        if (obj.attr('id').endsWith(idstr) && !obj.attr('id').endsWith(\"ZZ\")) {\n            sawSelect = true;\n        }\n    });\n\n    if (!sawSelect) {\n        textToSelect(short, i);\n        textToGeoPlaceSelect(short, i);\n        textToDate(short, i);\n    }\n\n    // Make things re-orderable if something exists\n    // $( \"#nameEntry_component_ui_0\" ).sortable({  // id of the container containing sortable things\n    //      items       : '.name_component'         // class of the things that are sortable.  They MUST have ids\n    // });\n    $(\"#\" + short + \"_datapart_\" + i + \" span.move-handle\").each(function () {\n        $(this).removeClass(\"snac-hidden\");\n    });\n    $(\"#\" + short + \"_reorderable_\" + i).sortable({\n        items: '.reorderable',\n        opacity: 0.5,\n        update: function (event, ui) {\n            var neworder = $(\"#\" + short + \"_reorderable_\" + i).sortable(\"toArray\");\n            console.log(neworder);\n            neworder.forEach(function (orderedID, index) {\n                $(\"#\" + orderedID + \" input.order-index\").val(index);\n            });\n            if (short == \"nameEntry\") updateNameEntryHeading(i);\n        }\n    });\n\n    // Make the relation pictures update appropriately\n    if (short == 'constellationRelation') {\n        // make the role dropdown affect the picture\n        $('#' + short + '_type_id_' + i).change(function () {\n            updatePictureArrow(short, i, $('#' + short + '_type_id_' + i + ' option:selected').text());\n        });\n    }\n    if (short == 'resourceRelation') {\n        // make the role dropdown affect the picture\n        $('#' + short + '_role_id_' + i).change(function () {\n            updatePictureArrow(short, i, $('#' + short + '_role_id_' + i + ' option:selected').text());\n        });\n    }\n    // Places should update the place heading\n    if (short == 'place') {\n        // If there is a value pre-set, then automatically confirm and update\n        if ($('#' + short + '_geoplace_id_' + i).val() != null && $('#' + short + '_geoplace_id_' + i).val() != \"\") {\n            updatePlaceHeading(short, i, $('#' + short + '_geoplace_id_' + i).val());\n        }\n        // make the role dropdown affect the picture\n        $('#' + short + '_geoplace_id_' + i).change(function () {\n            updatePlaceHeading(short, i, $('#' + short + '_geoplace_id_' + i).val());\n        });\n    }\n\n    // add parser btn if nameEntry is a computed name, entity is person, and if no btn or extra name components already exist\n    if (short === 'nameEntry' && $(\"#entityType\").val() === \"700\" && $(\"#nameEntry_component_0_panel_\" + i).find('select:first').text() === \"Name\" && !$(\"#nameEntry_panel_\" + i).find('.name-parser').length && $(\"#nameEntry_component_1_panel_\" + i).length === 0) {\n        $('#nameEntry_component_add_' + i).after('<button class=\"btn btn-primary name-parser\" id=\"nameEntry_parse_' + i + '\" style=\"margin-left:5px;\"> <i class=\"fa fa-magic\" aria-hidden=\"true\"></i> Parse </button>');\n    }\n\n    // Set this data's operation value appropriately\n    if ($(\"#\" + short + \"_id_\" + i).val() != \"\") $(\"#\" + short + \"_operation_\" + i).val(\"update\");else $(\"#\" + short + \"_operation_\" + i).val(\"insert\");\n\n    // Asked to edit something, so make it globally known\n    setEditedFlag(true);\n    //somethingHasBeenEdited = true;\n\n    return false;\n}\n\n/**\n * Make a data object uneditable\n *\n * Make each object in the GUI page for the given piece uneditable by turning them back to text.  Also\n * takes the color away from the pane and removes the operation flag.\n *\n * @param string shortName The short name of the data object, such as \"nameEntry\" or \"occupation\"\n * @param string|int i     The index within the edit page of the object.\n * @return boolean         False to play nice with the browser\n */\nfunction subMakeUneditable(shortName, i) {\n\n    // Make inputs read-only\n    var idstr = \"_\" + i;\n\n    // Turn off the reordering js\n    $(\"#\" + shortName + \"_datapart_\" + i + \" span.move-handle\").each(function () {\n        $(this).addClass(\"snac-hidden\");\n    });\n    if ($(\"#\" + shortName + \"_reorderable_\" + i).hasClass(\"ui-sortable\")) $(\"#\" + shortName + \"_reorderable_\" + i).sortable(\"destroy\");\n\n    // Remove CodeMirror editors\n    $(\"#\" + shortName + \"_datapart_\" + i + \" textarea[id^='\" + shortName + \"_']\").each(function () {\n        var obj = $(this);\n        if (obj.attr('id').endsWith(idstr) && !obj.attr('id').endsWith(\"ZZ\") && (obj.attr('id').indexOf('_text_') != -1 || obj.attr('id').indexOf('_source_') != -1)) {\n\n            if (obj.get(0).CodeMirror) {\n                obj.get(0).CodeMirror.toTextArea();\n            }\n            //(document.getElementById(obj.attr('id'))).CodeMirror.toTextArea();\n            //obj.get(0).CodeMirror.toTextArea();\n        }\n    });\n    // Disable buttons\n    $(\"#\" + shortName + \"_datapart_\" + i + \" button[id^='\" + shortName + \"_']\").each(function () {\n        var obj = $(this);\n        if (obj.attr('id').endsWith(idstr) && !obj.attr('id').endsWith(\"ZZ\")) {\n            obj.attr(\"disabled\", \"true\").addClass(\"snac-hidden\");\n        }\n    });\n\n    // Disable buttons\n    $(\"#\" + shortName + \"_datapart_\" + i + \" a.label\").each(function () {\n        $(this).addClass(\"snac-hidden\");\n    });\n\n    // Disable checkboxes\n    $(\"#\" + shortName + \"_datapart_\" + i + \" input[type='checkbox']\").each(function () {\n        var obj = $(this);\n        if (obj.attr('id').endsWith(idstr) && !obj.attr('id').endsWith(\"ZZ\")) {\n            obj.bootstrapToggle(\"disable\");\n        }\n    });\n\n    inputToText(shortName, i);\n    textAreaToText(shortName, i);\n    checkboxToText(shortName, i);\n    // Check for a select box\n    var sawSelect = false;\n    $(\"#\" + shortName + \"_datapart_\" + i + \" select[id^='\" + shortName + \"_']\").each(function () {\n        var obj = $(this);\n        if (obj.attr('id').endsWith(idstr) && !obj.attr('id').endsWith(\"ZZ\")) {\n            sawSelect = true;\n        }\n    });\n    // If a select box was seen, undo it\n    if (sawSelect) {\n        selectToText(shortName, i);\n        geoPlaceSelectToText(shortName, i);\n        dateToText(shortName, i);\n    }\n\n    // Clear the operation flags\n    //$(\"#\" + shortName + \"_operation_\" + i).val(\"\");\n    $(\"#\" + shortName + \"_datapart_\" + i + \" input[id^='\" + shortName + \"_']\").each(function () {\n        var obj = $(this);\n        if (obj.attr('id').endsWith(\"_operation\" + idstr) && !obj.attr('id').endsWith(\"ZZ\")) {\n            obj.val(\"\");\n        }\n    });\n\n    $(\"#\" + shortName + \"_panel_\" + i).addClass(\"panel-default\").removeClass(\"alert-info\").removeClass(\"edited-component\");\n}\n\n/**\n * Make a data object uneditable\n *\n * Make the GUI pane for a given constellation object (short, i) un-editable.  Sets up the edit and delete\n * buttons for first-order data objects, and calls the function to turn the elements back to text.\n *\n * @param string shortName The short name of the data object, such as \"nameEntry\" or \"occupation\"\n * @param string|int i     The index within the edit page of the object.\n * @return boolean         False to play nice with the browser\n */\nfunction makeUneditable(shortName, i) {\n    // Make inputs read-only\n    var idstr = \"_\" + i;\n\n    subMakeUneditable(shortName, i);\n\n    // restore the edit button\n    $(\"#\" + shortName + \"_editbutton_\" + i).addClass(\"list-group-item-info\").removeClass(\"list-group-item-warning\");\n    $(\"#\" + shortName + \"_editbutton_\" + i).html(\"<span class=\\\"fa fa-2x fa-pencil-square-o\\\"></span><br>Edit\");\n    $(\"#\" + shortName + \"_editbutton_\" + i).off('click').on(\"click\", function () {\n        makeEditable(shortName, i);\n    });\n\n    // restore the delete button\n    $(\"#\" + shortName + \"_deletebutton_\" + i).addClass(\"list-group-item-danger\").removeClass(\"disabled\");\n    $(\"#\" + shortName + \"_deletebutton_\" + i).off('click').on(\"click\", function () {\n        setDeleted(shortName, i);\n    });\n\n    return false;\n}\n\n/**\n * Make an SCM data object editable\n *\n * Make the GUI pane for an SCM (j) of a given constellation object (short, i) editable.  Sets up the edit and delete\n * buttons for first-order data objects.\n *\n * @param string shortName  The short name of the data object, such as \"nameEntry\" or \"occupation\"\n * @param string|int i      The index within the edit page of the object.\n * @param string|int j      The index within the data object SCM list on the edit page of the SCM object.\n * @return boolean          False to play nice with the browser\n */\nfunction makeSCMEditable(shortName, i, j) {\n    var id = j + \"_\" + i;\n    var scmShortName = \"scm_\" + shortName;\n\n    // No editing if it's already in edit mode\n    if ($(\"#\" + scmShortName + \"_operation_\" + id).val() == \"update\") return false;\n    // If it's deleted, then you better undelete it first\n    if ($(\"#\" + scmShortName + \"_operation_\" + id).val() == \"delete\") setSCMDeleted(shortName, i, j);\n\n    $(\"#\" + scmShortName + \"_editbutton_\" + id).removeClass(\"list-group-item-info\").addClass(\"list-group-item-warning\");\n    $(\"#\" + scmShortName + \"_editbutton_\" + id).html(\"<span class=\\\"fa fa-undo\\\"></span>\");\n    $(\"#\" + scmShortName + \"_editbutton_\" + id).off('click').on(\"click\", function () {\n        undoSCMEdit(shortName, i, j);\n    });\n    $(\"#\" + scmShortName + \"_deletebutton_\" + id).removeClass(\"list-group-item-danger\").addClass(\"disabled\");\n    $(\"#\" + scmShortName + \"_deletebutton_\" + id).off('click').on(\"click\", function () {\n        return false;\n    });\n\n    $(\"#\" + scmShortName + \"_panel_\" + id).removeClass(\"panel-default\").addClass(\"alert-info\").addClass(\"edited-component\");\n\n    return subMakeEditable(scmShortName, id);\n}\n\n/**\n * Make an SCM data object un-editable\n *\n * Make the GUI pane for an SCM object (j) for a given constellation object (short, i) un-editable.  Sets up the edit and delete\n * buttons for SCM data objects.\n *\n * @param string shortName The short name of the data object, such as \"nameEntry\" or \"occupation\"\n * @param string|int i     The index within the edit page of the object.\n * @param string|int j      The index within the data object SCM list on the edit page of the SCM object.\n * @return boolean         False to play nice with the browser\n */\nfunction makeSCMUneditable(shortName, i, j) {\n\n    // Make inputs read-only\n    var idstr = j + \"_\" + i;\n\n    subMakeUneditable('scm_' + shortName, idstr);\n\n    // restore the edit button\n    $(\"#scm_\" + shortName + \"_editbutton_\" + idstr).addClass(\"list-group-item-info\").removeClass(\"list-group-item-warning\");\n    $(\"#scm_\" + shortName + \"_editbutton_\" + idstr).html(\"<span class=\\\"fa fa-pencil-square-o\\\"></span>\");\n    $(\"#scm_\" + shortName + \"_editbutton_\" + idstr).off('click').on(\"click\", function () {\n        makeSCMEditable(shortName, i, j);\n    });\n\n    // restore the delete button\n    $(\"#scm_\" + shortName + \"_deletebutton_\" + idstr).addClass(\"list-group-item-danger\").removeClass(\"disabled\");\n    $(\"#scm_\" + shortName + \"_deletebutton_\" + idstr).off('click').on(\"click\", function () {\n        setSCMDeleted(shortName, i, j);\n    });\n\n    return false;\n}\n\n/**\n * Set a Contributor Object as deleted\n *\n * Sets the contributor object (shortName, i) as deleted or undeleted and makes the appropriate changes.\n *\n * @param string shortName The short name of the contributor object.\n * @param string|int i     The index within the edit page of the object.\n */\nfunction setRepeatedDataDeleted(shortName, i) {\n    if ($(\"#\" + shortName + \"_operation_\" + i).val() != \"delete\") {\n        $(\"#\" + shortName + \"_remove_\" + i).removeClass(\"btn-danger\").addClass(\"btn-warning\");\n        $(\"#\" + shortName + \"_remove_\" + i).html(\"<i class=\\\"fa fa-undo\\\" aria-hidden=\\\"true\\\"></i>\");\n    } else {\n        $(\"#\" + shortName + \"_remove_\" + i).removeClass(\"btn-warning\").addClass(\"btn-danger\");\n        $(\"#\" + shortName + \"_remove_\" + i).html(\"<span class=\\\"glyphicon glyphicon-minus-sign\\\"></span>\");\n    }\n\n    return subSetDeleted(shortName, i);\n}\n\n/**\n * Set a first-order data object as deleted\n *\n * Sets a first-order data object (short, i) as deleted or undeleted and makes the appropriate changes throughout the page.\n *\n * @param string shortName The short name of the data object, such as \"nameEntry\" or \"occupation\"\n * @param string|int i     The index within the edit page of the object.\n */\nfunction setDeleted(short, i) {\n    if ($(\"#\" + short + \"_operation_\" + i).val() != \"delete\") {\n        // set deleted\n        $(\"#\" + short + \"_deletebutton_\" + i).removeClass(\"list-group-item-danger\").addClass(\"list-group-item-warning\");\n        $(\"#\" + short + \"_deletebutton_\" + i).html(\"<span class=\\\"fa fa-2x fa-undo\\\"></span><br>Undo\");\n\n        // disable edit button\n        $(\"#\" + short + \"_editbutton_\" + i).removeClass(\"list-group-item-info\").addClass(\"disabled\");\n        $(\"#\" + short + \"_editbutton_\" + i).off('click').on(\"click\", function () {\n            return false;\n        });\n\n        // disable the Date button\n        $(\"#\" + short + \"_datebutton_\" + i).removeClass(\"list-group-item-success\").addClass(\"disabled\").prop('disabled', true);\n\n        // disable the SCM button\n        $(\"#\" + short + \"_scmbutton_\" + i).removeClass(\"list-group-item-success\").addClass(\"disabled\").prop('disabled', true);\n    } else {\n        // set undelete\n        $(\"#\" + short + \"_deletebutton_\" + i).removeClass(\"list-group-item-warning\").addClass(\"list-group-item-danger\");\n        $(\"#\" + short + \"_deletebutton_\" + i).html(\"<span class=\\\"fa fa-2x fa-trash-o\\\"></span><br>Trash\");\n\n        // restore edit button\n        $(\"#\" + short + \"_editbutton_\" + i).addClass(\"list-group-item-info\").removeClass(\"disabled\");\n        $(\"#\" + short + \"_editbutton_\" + i).off('click').on(\"click\", function () {\n            makeEditable(short, i);\n        });\n\n        // restore the Date button\n        $(\"#\" + short + \"_datebutton_\" + i).addClass(\"list-group-item-success\").removeClass(\"disabled\").prop('disabled', false);\n\n        // restore the SCM button\n        $(\"#\" + short + \"_scmbutton_\" + i).addClass(\"list-group-item-success\").removeClass(\"disabled\").prop('disabled', false);\n    }\n\n    return subSetDeleted(short, i);\n}\n\n/**\n * Make the delete/undelete happen\n *\n * Actually performs the changes to the object, affecting the operation and panel color.\n *\n * @param string shortName The short name of the data object, such as \"nameEntry\" or \"occupation\"\n * @param string|int i     The index within the edit page of the object.\n * @return boolean         False to play nice with the browser\n */\nfunction subSetDeleted(short, i) {\n    if ($(\"#\" + short + \"_operation_\" + i).val() != \"delete\") {\n        // set deleted\n        $(\"#\" + short + \"_panel_\" + i).removeClass(\"panel-default\").addClass(\"alert-danger\").addClass(\"deleted-component\");\n\n        $(\"#\" + short + \"_operation_\" + i).val(\"delete\");\n    } else {\n        // set undelete\n        $(\"#\" + short + \"_panel_\" + i).removeClass(\"alert-danger\").addClass(\"panel-default\").removeClass(\"deleted-component\");\n\n        // If this thing was deleted but is supposed to be an update, then return it back to update status\n        var sawSelect = false;\n        $(\"select[id^='\" + short + \"_']\").each(function () {\n            var obj = $(this);\n            if (obj.attr('id').endsWith(\"_\" + i) && !obj.attr('id').endsWith(\"ZZ\")) {\n                sawSelect = true;\n            }\n        });\n        if (sawSelect) {\n            if ($(\"#\" + short + \"_id_\" + i).val() != \"\") $(\"#\" + short + \"_operation_\" + i).val(\"update\");else $(\"#\" + short + \"_operation_\" + i).val(\"insert\");\n        } else {\n            $(\"#\" + short + \"_operation_\" + i).val(\"\");\n        }\n    }\n\n    // Asked to delete something, so make it globally known\n    setEditedFlag(true);\n    //somethingHasBeenEdited = true;\n\n    return false;\n}\n\n/**\n * Set an SCM data object as deleted\n *\n * Sets an SCM object (j) for a constellation object (short, i) as deleted or undeleted and makes the appropriate changes throughout the page.\n *\n * @param string shortName The short name of the data object, such as \"nameEntry\" or \"occupation\"\n * @param string|int i     The index within the edit page of the object.\n * @param string|int j      The index within the data object SCM list on the edit page of the SCM object.\n */\nfunction setSCMDeleted(short, i, j) {\n    var id = j + '_' + i;\n    if ($(\"#scm_\" + short + \"_operation_\" + id).val() != \"delete\") {\n        // set deleted\n        $(\"#scm_\" + short + \"_deletebutton_\" + id).removeClass(\"list-group-item-danger\").addClass(\"list-group-item-warning\");\n        $(\"#scm_\" + short + \"_deletebutton_\" + id).html(\"<span class=\\\"fa fa-undo\\\"></span>\");\n\n        // disable edit button\n        $(\"#scm_\" + short + \"_editbutton_\" + id).removeClass(\"list-group-item-info\").addClass(\"disabled\");\n        $(\"#scm_\" + short + \"_editbutton_\" + id).off('click').on(\"click\", function () {\n            return false;\n        });\n    } else {\n        // set undelete\n        $(\"#scm_\" + short + \"_deletebutton_\" + id).removeClass(\"list-group-item-warning\").addClass(\"list-group-item-danger\");\n        $(\"#scm_\" + short + \"_deletebutton_\" + id).html(\"<span class=\\\"fa fa-trash-o\\\"></span>\");\n\n        // restore edit button\n        $(\"#scm_\" + short + \"_editbutton_\" + id).addClass(\"list-group-item-info\").removeClass(\"disabled\");\n        $(\"#scm_\" + short + \"_editbutton_\" + id).off('click').on(\"click\", function () {\n            makeSCMEditable(short, i, j);\n        });\n    }\n\n    return subSetDeleted(\"scm_\" + short, id);\n}\n\n/**\n * Turn on the Edit/Delete buttons for an object\n *\n * @param string shortName The short name of the data object, such as \"nameEntry\" or \"occupation\"\n * @param string|int i     The index within the edit page of the object.\n */\nfunction turnOnButtons(shortName, i) {\n\n    // Turn on the edit button\n    $(\"#\" + shortName + \"_editbutton_\" + i).on(\"click\", function () {\n        makeEditable(shortName, i);\n    });\n\n    // Turn on the delete buttons\n    $(\"#\" + shortName + \"_deletebutton_\" + i).on(\"click\", function () {\n        setDeleted(shortName, i);\n    });\n}\n\nfunction turnOnTooltips(shortName, i) {\n    // Load tooltips\n    $(function () {\n        $('#' + shortName + '_panel_' + i + ' [data-toggle=\"tooltip\"]').tooltip();\n    });\n\n    // Load popovers\n    $(function () {\n        $('#' + shortName + '_panel_' + i + ' [data-toggle=\"popover\"]').popover({\n            trigger: 'hover',\n            container: 'body'\n        });\n    });\n}\n\n/**\n * Turn on the Edit/Delete buttons for an SCM object\n *\n * @param string shortName The short name of the data object, such as \"nameEntry\" or \"occupation\"\n * @param string|int i     The index within the edit page of the object.\n * @param string|int j      The index within the data object SCM list on the edit page of the SCM object.\n */\nfunction turnOnSCMButtons(shortName, i, j) {\n\n    // Turn on the edit button\n    $(\"#scm_\" + shortName + \"_editbutton_\" + j + \"_\" + i).on(\"click\", function () {\n        makeSCMEditable(shortName, i, j);\n    });\n\n    // Turn on the delete buttons\n    $(\"#scm_\" + shortName + \"_deletebutton_\" + j + \"_\" + i).on(\"click\", function () {\n        setSCMDeleted(shortName, i, j);\n    });\n}\n\n/**\n * Create a new Address Line object on page\n *\n * Puts a new Place Address Line object DIV on the page and attaches it correctly to the DOM and javascript.\n *\n * @param  int     i    The index on the page of the place to add this component to\n * @return boolean      false to play nice with the browser.\n */\nfunction newAddressLine(i) {\n    var nextid = 1;\n    if ($('#place_address_next_j_' + i).exists()) {\n        nextid = parseInt($('#place_address_next_j_' + i).text());\n    }\n    console.log(\"Creating new address line for place \" + i + \" with id: \" + nextid);\n    setEditedFlag(true);\n    //somethingHasBeenEdited = true;\n    var text = $('#addressline_template').clone();\n    var html = text.html().replace(/ZZ/g, i).replace(/YY/g, nextid);\n    $('#place_address_add_div_' + i).before(html);\n\n    $('#place_address_' + nextid + '_operation_' + 1).val(\"insert\");\n    subMakeEditable(\"place_address_\" + nextid, i);\n\n    vocab_select_replace($(\"#place_address_\" + nextid + \"_type_id_\" + i), \"_\" + i, 'address_part', 0);\n\n    // Put the updated version number back in the DOM\n    $('#place_address_next_j_' + i).text(++nextid);\n\n    return false;\n}\n\n/**\n * Create a new Resource Relation Origination Name object on page\n *\n * Puts a new Resource Relation Origination Name object DIV on the page and attaches it correctly to the DOM and javascript.\n *\n * @param  int     i    The index on the page of the Resource Relation to add this Origination Name to\n * @return boolean      false to play nice with the browser.\n */\nfunction newOriginationName(i) {\n    var nextid = 1;\n    if ($('#resource_originationName_next_j_' + i).exists()) {\n        nextid = parseInt($('#resource_originationName_next_j_' + i).text());\n    }\n    console.log(\"Creating new origination name for resource \" + i + \" with id: \" + nextid);\n    setEditedFlag(true);\n    //somethingHasBeenEdited = true;\n    var text = $('#originationName_template').clone();\n    var html = text.html().replace(/ZZ/g, i).replace(/YY/g, nextid);\n    $('#resource_originationName_add_div_' + i).before(html);\n\n    $('#resource_originationName_' + nextid + '_operation_' + 1).val(\"insert\");\n    subMakeEditable(\"resource_originationName_\" + nextid, i);\n\n    // Put the updated version number back in the DOM\n    $('#resource_originationName_next_j_' + i).text(++nextid);\n\n    return false;\n}\n\n/**\n * Create a new Name Entry Component object on page\n *\n * Puts a new Name Entry component object DIV on the page and attaches it correctly to the DOM and javascript.\n *\n * @param  int     i    The index on the page of the nameEntry to add this component to\n * @return boolean      false to play nice with the browser.\n */\nfunction newNameEntryComponent(i) {\n    removeParserButton(i);\n    var nextid = 1;\n    if ($('#nameEntry_component_next_j_' + i).exists()) {\n        nextid = parseInt($('#nameEntry_component_next_j_' + i).text());\n    }\n    console.log(\"Creating new name entry component for nameEntry \" + i + \" with id: \" + nextid);\n\n    // add parser btn if entity is person, and if no btn or other name components already exist\n    if ($(\"#entityType\").val() === \"700\" && nextid == 0 && !$(\"#nameEntry_panel_\" + i).find('.name-parser').length && $(\"#nameEntry_component_1_panel_\" + i).length === 0) {\n        $('#nameEntry_component_add_' + i).after('<button class=\"btn btn-primary name-parser\" id=\"nameEntry_parse_' + i + '\" style=\"margin-left:5px;\"> <i class=\"fa fa-magic\" aria-hidden=\"true\"></i> Parse </button>');\n    }\n\n    setEditedFlag(true);\n    //somethingHasBeenEdited = true;\n\n    var text = $('#component_template').clone();\n    var html = text.html().replace(/ZZ/g, i).replace(/YY/g, nextid);\n    $('#nameEntry_component_add_div_' + i).before(html);\n\n    $('#nameEntry_component_' + nextid + '_operation_' + 1).val(\"insert\");\n    subMakeEditable(\"nameEntry_component_\" + nextid, i);\n\n    vocab_select_replace($(\"#nameEntry_component_\" + nextid + \"_type_id_\" + i), \"_\" + i, 'name_component', 0);\n\n    // Put the updated version number back in the DOM\n    $('#nameEntry_component_next_j_' + i).text(++nextid);\n\n    return false;\n}\n\nfunction updateNameEntryHeading(i) {\n    var text = \"\";\n    var components = [];\n\n    $(\"#nameEntry_panel_\" + i + \" div[id^='nameEntry_component_']\").each(function () {\n        var obj = $(this);\n        if (!obj.hasClass(\"deleted-component\") && obj.attr('id').endsWith(\"_panel_\" + i) && !obj.attr('id').endsWith(\"ZZ\")) {\n            var j = obj.attr('id').replace(\"nameEntry_component_\", \"\").replace(\"_panel_\" + i, \"\");\n            var type = $(\"#nameEntry_component_\" + j + \"_type_id_\" + i + \" option:selected\").text();\n            var partText = $(\"#nameEntry_component_\" + j + \"_text_\" + i).val();\n\n            components.push([type, partText]);\n        }\n    });\n\n    var entityType = $(\"#entityType option:selected\").text();\n    text = combineNameHeading(components, entityType);\n\n    $(\"#nameEntry_heading_\" + i).text(text.trim());\n    $(\"#nameEntry_original_\" + i).val(text.trim());\n}\n\n/**\n * Create a new Name Entry Rules object on page\n *\n * Puts a new Name Entry rule object DIV on the page and attaches it correctly to the DOM and javascript.\n *\n * @param  int     i    The index on the page of the nameEntry to add this rule to\n * @return boolean      false to play nice with the browser.\n */\nfunction newNameEntryRule(i) {\n    var nextid = 1;\n    if ($('#nameEntry_rule_next_j_' + i).exists()) {\n        nextid = parseInt($('#nameEntry_rule_next_j_' + i).text());\n    }\n    console.log(\"Creating new name entry rule for nameEntry \" + i + \" with id: \" + nextid);\n    setEditedFlag(true);\n    //somethingHasBeenEdited = true;\n    var text = $('#rule_template').clone();\n    var html = text.html().replace(/ZZ/g, i).replace(/YY/g, nextid);\n    $('#nameEntry_rule_add_div_' + i).before(html);\n\n    $('#nameEntry_rule_' + nextid + '_operation_' + 1).val(\"insert\");\n    turnOnTooltips(\"nameEntry_rule_\" + nextid, i);\n    subMakeEditable(\"nameEntry_rule_\" + nextid, i);\n\n    // Put the updated version number back in the DOM\n    $('#nameEntry_rule_next_j_' + i).text(++nextid);\n\n    return false;\n}\n\n/**\n * Parse a date string into parts\n */\nfunction parseDate(dateString) {\n    var pieces = dateString.split(\"-\");\n    if (pieces.length == 3) return {\n        year: parseInt(pieces[0]),\n        month: parseInt(pieces[1]),\n        day: parseInt(pieces[2])\n    };else if (pieces.length == 2) return {\n        year: parseInt(pieces[0]),\n        month: parseInt(pieces[1]),\n        day: ''\n    };else if (pieces.length == 1 && pieces[0] != '') return {\n        year: parseInt(pieces[0]),\n        month: '',\n        day: ''\n    };else return {\n        year: '', month: '', day: ''\n    };\n}\n\n/**\n * Change date input divs to select and boxes\n *\n * Changes all div's with id \"date_\" for a given data object (shortName, idStr) from a list of\n * inputs defining the parameters (view mode) to a inputs and a select (edit mode).  It then\n * calls the select2 function to replace the select with one matching the rest of the page.\n *\n * Note: idStr must not have the \"_\" pre-appended\n *\n * @param string shortName The short name of the data object, such as \"nameEntry\" or \"occupation\"\n * @param string|int idStr The index within the edit page of the object.\n */\nfunction textToDate(shortName, idStr) {\n    $(\"div[id^='date_\" + shortName + \"']\").each(function () {\n        var cont = $(this);\n        if (cont.attr('id').endsWith(\"_\" + idStr) && !cont.attr('id').endsWith(\"ZZ\")) {\n            // remove the short name and \"select_\" from the string we're parsing\n            var divStr = cont.attr('id').replace(\"date_\", \"\").replace(shortName + \"_\", \"\");\n            // remove the idstr to receive the name of this element\n            var regex = new RegExp(\"\\_\" + idStr + \"$\", \"g\");\n            var name = divStr.replace(regex, \"\");\n            var dateStr = $(\"#\" + shortName + \"_\" + name + \"_\" + idStr).val();\n\n            var dateParts = parseDate(dateStr);\n\n            var html = \"<input type='text' size='4' style='width:20%;display:inline;' placeholder='YYYY' id='\" + shortName + \"_\" + name + \"_year_\" + idStr + \"' class='form-control' value='\" + dateParts.year + \"'>\";\n            html += \"<span class='form-control-static'> - </span>\";\n            html += \"<select id='\" + shortName + \"_\" + name + \"_month_\" + idStr + \"' class='form-control' data-placeholder='Month' style='width: 57%; margin-bottom: 5px; display: inline-block;'>\" + \"<option></option>\";\n            var months = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n\n            months.forEach(function (value, key) {\n                var mInt = key + 1;\n\n                if (mInt == dateParts.month) html += \"<option value=\\\"\" + mInt + \"\\\" selected>\" + value + \"</option>\";else html += \"<option value=\\\"\" + mInt + \"\\\">\" + value + \"</option>\";\n            });\n            html += \"<select> \";\n            html += \"<span class='form-control-static'> - </span>\";\n            html += \"<input type='text' style='width:14%;display:inline;' size='2' placeholder='DD' id='\" + shortName + \"_\" + name + \"_day_\" + idStr + \"' class='form-control' value='\" + dateParts.day + \"'> \";\n            html += \"<input type='hidden' id='\" + shortName + \"_\" + name + \"_\" + idStr + \"' name='\" + shortName + \"_\" + name + \"_\" + idStr + \"' value='\" + dateStr + \"'>\";\n            cont.html(html);\n\n            $(\"#\" + shortName + \"_\" + name + \"_month_\" + idStr).select2({\n                width: '57%',\n                allowClear: true,\n                theme: 'bootstrap',\n                placeholder: 'Month'\n            });\n        }\n    });\n}\n\n/**\n * Pad an integer\n *\n * This is a helper function to pad an integer with 0s for display.  This is useful to pad\n * a month or day with a leading 0.\n *\n * @param int|string num The number to pad\n * @param int size The total width of the desired output\n * @return string A string containing a size-wide integer representation, 0-padded\n */\nfunction pad(num, size) {\n    var s = num + \"\";\n    while (s.length < size) s = \"0\" + s;\n    return s;\n}\n\n/**\n * Updates the standard date input field\n *\n * If the date for the data object (shortName, idStr) has been turned into a 3-field edit\n * area, then this function will update the hidden standard date (YYYY-MM-DD) field with the\n * newest values from the human-enterable field.\n *\n * Note: idStr must not have the \"_\" pre-appended\n *\n * @param string shortName The short name of the data object, such as \"nameEntry\" or \"occupation\"\n * @param string|int idStr The index within the edit page of the object.\n */\nfunction updateDate(shortName, idStr) {\n    $(\"div[id^='date_\" + shortName + \"']\").each(function () {\n        var cont = $(this);\n        if (cont.attr('id').endsWith(\"_\" + idStr) && !cont.attr('id').endsWith(\"ZZ\")) {\n            // remove the short name and \"select_\" from the string we're parsing\n            var divStr = cont.attr('id').replace(\"date_\", \"\").replace(shortName + \"_\", \"\");\n            // remove the idstr to receive the name of this element\n            var regex = new RegExp(\"\\_\" + idStr + \"$\", \"g\");\n            var name = divStr.replace(regex, \"\");\n\n            if ($(\"#\" + shortName + \"_\" + name + \"_year_\" + idStr).exists()) {\n                var year = $(\"#\" + shortName + \"_\" + name + \"_year_\" + idStr).val();\n                var day = $(\"#\" + shortName + \"_\" + name + \"_day_\" + idStr).val();\n                var month = $(\"#\" + shortName + \"_\" + name + \"_month_\" + idStr + \" option:selected\").val();\n\n                var dateStr = \"\";\n                if (year != \"\") {\n                    dateStr += pad(year, 4);\n                    if (month != \"\") {\n                        dateStr += \"-\" + pad(month, 2);\n                        if (day != \"\") {\n                            dateStr += \"-\" + pad(day, 2);\n                        }\n                    }\n                }\n\n                $(\"#\" + shortName + \"_\" + name + \"_\" + idStr).val(dateStr);\n            }\n        }\n    });\n}\n\n/**\n * Return editable date area back to text\n *\n * If the date for the data object (shortName, idStr) has been turned into a 3-field edit\n * area, then this function will return the editable area back to the view mode text, replacing\n * the edit boxes with a paragraph containing the computed standard date string (YYYY-MM-DD).\n *\n * Note: idStr must not have the \"_\" pre-appended\n *\n * @param string shortName The short name of the data object, such as \"nameEntry\" or \"occupation\"\n * @param string|int idStr The index within the edit page of the object.\n */\nfunction dateToText(shortName, idStr) {\n    $(\"div[id^='date_\" + shortName + \"']\").each(function () {\n        var cont = $(this);\n        if (cont.attr('id').endsWith(\"_\" + idStr) && !cont.attr('id').endsWith(\"ZZ\")) {\n            // remove the short name and \"select_\" from the string we're parsing\n            var divStr = cont.attr('id').replace(\"date_\", \"\").replace(shortName + \"_\", \"\");\n            // remove the idstr to receive the name of this element\n            var regex = new RegExp(\"\\_\" + idStr + \"$\", \"g\");\n            var name = divStr.replace(regex, \"\");\n\n            updateDate(shortName, idStr);\n\n            var dateStr = $(\"#\" + shortName + \"_\" + name + \"_\" + idStr).val();\n\n            var html = \"<p class='form-control-static'>\" + dateStr + \"</p>\";\n            html += \"<input type='hidden' id='\" + shortName + \"_\" + name + \"_\" + idStr + \"' name='\" + shortName + \"_\" + name + \"_\" + idStr + \"' value='\" + dateStr + \"'>\";\n            cont.html(html);\n        }\n    });\n}\n\n// TODO: If we want to show a DIV of edited and deleted components, we should use the following two functions\n// to get copies of the edited/deleted components from the page.  We can then insert those copies onto a modal\n// dialog box with a \"Save\" or \"Continue\" button at the top and bottom.\n//\n// All the pieces shown in the dialog should be disabled.  One way to do this would be using the following\n// method to place a semi-transparent div on top of the editable pieces, making them appear to be grayed out\n// and with the not permitted cursor.\n//\n// .append('<div style=\"position:absolute; top:0; left:0; width:100%; height:100%; background:#f3f3f3; z-index:500; cursor:not-allowed;opacity:0.4;filter: alpha(opacity = 50)\"></div>');\n//\n// Note: this modal should NOT be inside the constellation form so that we don't submit the values twice.\n\n/**\n * Get all the edited components\n */\nfunction getEdited() {\n    var html = \"\";\n\n    $(\"#constellation_form div.edited-component\").each(function () {\n        var cont = $(this);\n        console.log(cont.attr('id'));\n        var pieces = cont.attr('id').split(\"_panel_\");\n        if (pieces.length == 2) {\n            html += \"<div class='panel panel-body edited-component'>\" + $(\"#\" + pieces[0] + \"_datapart_\" + pieces[1]).html() + \"</div>\";\n        }\n    });\n\n    return html;\n}\n\n/**\n * Get all the deleted components\n */\nfunction getDeleted() {\n    var html = \"\";\n\n    $(\"#constellation_form div.deleted-component\").each(function () {\n        var cont = $(this);\n        console.log(cont.attr('id'));\n        var pieces = cont.attr('id').split(\"_panel_\");\n        if (pieces.length == 2) {\n            html += \"<div class='panel panel-body deleted-component'>\" + $(\"#\" + pieces[0] + \"_datapart_\" + pieces[1]).html() + \"</div>\";\n        }\n    });\n\n    return html;\n}\n\nfunction turnOnEditDeleteButtons(part = '') {\n    var divID = '';\n    if (part != '') divID = \"#\" + part + \" \";\n    // Turn on the edit buttons\n    $(divID + \"a[id*='editbutton']\").each(function () {\n        var obj = $(this);\n        var pieces = obj.attr('id').split(\"_\");\n\n        if (pieces.length == 3) {\n            var short = pieces[0];\n            var i = pieces[2];\n            obj.on(\"click\", function () {\n                makeEditable(short, i);\n            });\n        } else if (pieces.length == 5 && pieces[0] == \"scm\") {\n            var short = pieces[1];\n            var i = pieces[4];\n            var j = pieces[3];\n            obj.on(\"click\", function () {\n                makeSCMEditable(short, i, j);\n            });\n        } else if (pieces.length == 5) {\n            var short = pieces[0] + \"_\" + pieces[1] + \"_\" + pieces[2];\n            var i = pieces[4];\n            obj.on(\"click\", function () {\n                makeEditable(short, i);\n            });\n        }\n    });\n\n    // Turn on the delete buttons\n    $(divID + \"a[id*='deletebutton']\").each(function () {\n        var obj = $(this);\n        var pieces = obj.attr('id').split(\"_\");\n\n        if (pieces.length == 3) {\n            var short = pieces[0];\n            var i = pieces[2];\n            obj.on(\"click\", function () {\n                setDeleted(short, i);\n            });\n        } else if (pieces.length == 5 && pieces[0] == \"scm\") {\n            var short = pieces[1];\n            var i = pieces[4];\n            var j = pieces[3];\n            obj.on(\"click\", function () {\n                setSCMDeleted(short, i, j);\n            });\n        } else if (pieces.length == 5) {\n            var short = pieces[0] + \"_\" + pieces[1] + \"_\" + pieces[2];\n            var i = pieces[4];\n            obj.on(\"click\", function () {\n                setDeleted(short, i);\n            });\n        }\n    });\n}\n\nfunction turnOnTooltipsForTab(part = '') {\n    var divID = '';\n    if (part != '') divID = \"#\" + part + \" \";\n    // Load tooltips\n    $(function () {\n        $(divID + '[data-toggle=\"tooltip\"]').tooltip();\n    });\n\n    // Load popovers\n    $(function () {\n        $(divID + '[data-toggle=\"popover\"]').popover({\n            trigger: 'hover',\n            container: 'body'\n        });\n    });\n}\n\nfunction updatePictureArrow(shortName, i, newValue) {\n    $('#' + shortName + '_relationPictureArrow_' + i).text(newValue);\n}\n\nfunction updatePictureTitle(shortName, i, newValue) {\n    $('#' + shortName + '_relationPictureTitle_' + i).text(newValue);\n}\n\nfunction updatePictureIcon(shortName, i, entityType) {\n    var html = \"\";\n    if (entityType == 'person') html = '<i class=\"fa fa-user\" aria-hidden=\"true\"></i><br/>';else if (entityType == 'corporateBody') html = '<i class=\"fa fa-building\" aria-hidden=\"true\"></i><br/>';else if (entityType == 'family') html = '<i class=\"fa fa-users\" aria-hidden=\"true\"></i><br/>';\n    $('#' + shortName + '_relationPictureIcon_' + i).html(html);\n}\n\nvar geoPlaceLoadResults = null;\n\nfunction loadGeoPlaceResultCache() {\n    $(\"input[id^='place_geoplace_id_']\").each(function () {\n        var obj = $(this);\n        // Query for term by ajax\n        if (obj.val() != null && obj.val() != \"\") {\n            $.get(snacUrl + \"/vocabulary/read?type=geoPlace&id=\" + obj.val(), null, function (data) {\n                // Check the return value from the ajax. If success, then go to dashboard\n                if (data.term) {\n                    if (!geoPlaceLoadResults) geoPlaceLoadResults = new Array();\n                    geoPlaceLoadResults.push(data.term);\n                }\n            });\n        }\n    });\n}\n\nfunction chooseSuggestedGeoPlace(selectID, idStr, value) {\n    // idStr == id number on the page\n    var obj = $(\"#\" + selectID);\n    obj.select2('destroy');\n    obj.val(value);\n    geovocab_select_replace(obj, \"_\" + idStr);\n    updatePlaceHeading(\"place\", idStr, value);\n}\n\nfunction updatePlaceHeading(shortName, i, newValue) {\n    var place = null;\n    if (!geoPlaceSearchResults && !geoPlaceLoadResults) {\n        $('#' + shortName + '_confirmed_' + i).val(\"false\");\n        $('#' + shortName + '_geoterm_text_' + i).html(\"<em>Unconfirmed</em>\");\n        $('#' + shortName + \"_geoterm_maplink_\" + i).addClass(\"disabled\");\n        $('#' + shortName + \"_geoterm_maplink_\" + i).prop('onclick', null).off(\"click\");\n        if ($('#' + shortName + '_original_' + i).val() != \"\") $('#' + shortName + '_geoterm_caption_' + i).text(\"Recorded as: \" + $('#' + shortName + '_original_' + i).val());else $('#' + shortName + '_geoterm_caption_' + i).text();\n        return;\n    }\n\n    if (geoPlaceSearchResults) {\n        geoPlaceSearchResults.forEach(function (result) {\n            if (result.id == newValue) place = result;\n        });\n    }\n\n    if (!place && geoPlaceLoadResults) {\n        geoPlaceLoadResults.forEach(function (result) {\n            if (result.id == newValue) place = result;\n        });\n    }\n\n    if (!place) {\n        $('#' + shortName + '_confirmed_' + i).val(\"false\");\n        $('#' + shortName + \"_geoterm_maplink_\" + i).addClass(\"disabled\");\n        $('#' + shortName + \"_geoterm_maplink_\" + i).off(\"click\");\n        if ($('#' + shortName + '_original_' + i).val() != \"\") {\n            $('#' + shortName + '_geoterm_text_' + i).html(\"<em>Unconfirmed</em>\");\n            $('#' + shortName + '_geoterm_caption_' + i).text(\"Recorded as: \" + $('#' + shortName + '_original_' + i).val());\n        } else {\n            $('#' + shortName + '_geoterm_text_' + i).text(\"--\");\n            $('#' + shortName + '_geoterm_caption_' + i).text(\"GeoPlace term not specified\");\n        }\n        return;\n    }\n    $('#' + shortName + '_confirmed_' + i).val(\"true\");\n    $('#' + shortName + '_geoterm_text_' + i).text(place.name);\n    $('#' + shortName + '_geoterm_caption_' + i).text(place.administrationCode + \", \" + place.countryCode);\n    if (place.latitude && place.longitude) {\n        $('#' + shortName + \"_geoterm_maplink_\" + i).prop('onclick', null).off(\"click\");\n        $('#' + shortName + \"_geoterm_maplink_\" + i).on(\"click\", function () {\n            openGeoPlaceViewer(place.id);return false;\n        });\n        $('#' + shortName + \"_geoterm_maplink_\" + i).removeClass(\"disabled\");\n    } else {\n        $('#' + shortName + \"_geoterm_maplink_\" + i).addClass(\"disabled\");\n        $('#' + shortName + \"_geoterm_maplink_\" + i).prop('onclick', null).off(\"click\");\n    }\n}\n\nfunction magicDefaultFill(selectID, vocabType) {\n    if (typeof defaults[vocabType] !== undefined) {\n\n        var data = {\n            id: defaults[vocabType].id,\n            text: defaults[vocabType].term\n        };\n\n        // If the selected item exists, then select it. Else, add a new option\n        // and select it.\n        if ($('#' + selectID).find(\"option[value='\" + data.id + \"']\").length) {\n            $('#' + selectID).val(data.id).trigger('change');\n        } else {\n            var newOption = new Option(data.text, data.id, false, true);\n            $('#' + selectID).append(newOption).trigger('change');\n        }\n    }\n}\n\nfunction capitalize(word) {\n    return word[0].toUpperCase() + word.slice(1);\n}\n\nfunction parseName(e) {\n    $('#name-parser-options').text('');\n    var $nameComponents = $(e.target).closest('.name-components');\n\n    var $partType = $nameComponents.find(\"select:last\");\n    var $textbox = $nameComponents.find('input[type=\"text\"]:last');\n\n    var name = $textbox.val();\n\n    var entityType = $('#entityType').text().trim();\n    $('#name-parser-type').text(capitalize(entityType));\n    $('#name-parser-original').text(name);\n\n    var parser = new NameParser();\n    var guesses = parser.guessPerson(name);\n\n    var parsedOption = '';\n\n    var counter = 0;\n    guesses.forEach(function (guess) {\n        // attach name data object to radio\n        for (var key in guess) {\n            if (guess[key] && guess[key].length != 0) {\n                parsedOption += \"<li><span style='font-weight: bold;'>\" + key + \"</span>: \" + guess[key] + \"</li>\";\n            }\n        }\n\n        $('#name-parser-options').append(\"<div class='radio'>\" + \"<label class='radio form-inline' for='name-parser-option-\" + counter + \"'>\" + \"<input type='radio' name='parsed-names' id='name-parser-option-\" + counter + \"'>\" + \"<ul class='list-unstyled'>\" + parsedOption + \"</ul></label> </div>\");\n\n        $('#name-parser-options').find(\"input[type='radio']:last\").data(\"parsed-name\", guess);\n\n        parsedOption = '';\n        counter++;\n    });\n\n    $('#name-parser-options').find(\"input[type='radio']:first\").prop('checked', true);\n\n    $('#parser-accept-btn').unbind('click');\n    $('#parser-accept-btn').on('click', function () {\n        var selectedName = $('#name-parser input[type=\"radio\"]:checked').data('parsed-name');\n        $.get(snacUrl + \"/vocabulary/?type=name_component&entity_type=700\").done(function (data) {\n            acceptParsedName(selectedName, $nameComponents, name, data.results);\n        });\n    });\n}\n\nfunction acceptParsedName(selectedName, $nameComponents, name, nameComponentIDs) {\n    var i = $nameComponents.attr('id').split('_')[2];\n    var $nameComponent = $nameComponents.find('.reorderable'); ///\n    $nameComponent.replaceWith('<div style=\"margin-left:10%; font-size: 14x; font-style:italic; color: #777777;\"> Name: ' + name + '</div>');\n\n    var nameComponentMap = {};\n\n    for (var k = 0; k < nameComponentIDs.length; k++) {\n        nameComponentMap[nameComponentIDs[k].text] = nameComponentIDs[k].id;\n    }\n    // var nameComponentMap = {\n    //     'Surname': 400223,\n    //     'Forename': 400224,\n    //     'NameAddition': 400236,\n    //     'Date': 400237,\n    //     'NameExpansion': 400226,\n    //     'Numeration': 400225\n    // };\n\n    for (var key in selectedName) {\n        if (key == 'NameAdditions') {\n            key = 'NameAddition';\n            for (var j = 0; j < selectedName['NameAdditions'].length; j++) {\n                newNameEntryComponent(i);\n                var option = new Option(key, nameComponentMap[key], false, true);\n                $partType = $nameComponents.find(\"select:last\");\n                $partType.append(option).trigger('change');\n                $textbox = $nameComponents.find(\"input[type='text']:last\");\n                $textbox.val(selectedName[\"NameAdditions\"][j]);\n\n                $partType.append(option).trigger('change');\n            }\n        } else if (selectedName[key] && nameComponentMap[key]) {\n            newNameEntryComponent(i);\n            var option = new Option(key, nameComponentMap[key], false, true);\n            $partType = $nameComponents.find(\"select:last\");\n            $partType.append(option).trigger('change');\n            $textbox = $nameComponents.find(\"input[type='text']:last\");\n            $textbox.val(selectedName[key]);\n\n            $partType.append(option).trigger('change');\n        }\n    }\n\n    $(\"#nameEntry_datapart_\" + i).find(\".name-parser\").remove();\n    updateNameEntryHeading(i);\n}\n\nfunction removeParserButton(i) {\n    $('#nameEntry_datapart_' + i).find('.name-parser').remove();\n}\n\n/**\n * Things to do when the page finishes loading\n */\n$(document).ready(function () {\n    // Load the place cache, if needed\n    loadGeoPlaceResultCache();\n\n    // listen for name-parsing\n    $('#nameEntries').on('click', '.name-parser', function (event) {\n        event.preventDefault();\n        parseName(event);\n        $(\"#name-parser\").modal('toggle');\n    });\n\n    $('#name-parser').on('shown.bs.modal', function () {\n        $('#parser-accept-btn').focus();\n    });\n\n    // If the constellation is in \"insert\" mode, then we should automatically set \"somethingHasBeenEdited\"\n    // to be true...\n    if ($('#operation').val() == 'insert') setEditedFlag(true);\n    //somethingHasBeenEdited = true;\n\n    turnOnEditDeleteButtons();\n\n    // Attach functions to the entityType select\n    if ($('#entityType').exists()) {\n        $('#entityType').change(function () {\n            setEditedFlag(true);\n            //somethingHasBeenEdited = true;\n            // If there is an ID, then we need to set this to update\n            // Else, the main-level operation should be and remain insert\n            if ($('#constellationid').val() != null && $('#constellationid').val() != \"\") {\n                $('#operation').val(\"update\");\n            }\n        });\n    }\n\n    // Name Entry doesn't get any AJAX, since it is pre-loaded\n    var nameEntryid = 1;\n    if ($('#next_nameEntry_i').exists()) {\n        nameEntryid = parseInt($('#next_nameEntry_i').text());\n    }\n    console.log(\"Next NameEntry ID: \" + nameEntryid);\n    if ($('#btn_add_nameEntry').exists()) {\n        $('#btn_add_nameEntry').click(function () {\n            setEditedFlag(true);\n            //somethingHasBeenEdited = true;\n            var text = $('#nameEntry_template').clone();\n            var html = text.html().replace(/ZZ/g, nameEntryid);\n            $('#add_nameEntry_div').after(html);\n            turnOnButtons(\"nameEntry\", nameEntryid);\n            turnOnTooltips(\"nameEntry\", nameEntryid);\n            makeEditable(\"nameEntry\", nameEntryid);\n            nameEntryid = nameEntryid + 1;\n            return false;\n        });\n    }\n\n    // Attach functions to each of the \"+ Add New _______\" buttons\n\n    // Code to handle adding new genders to the page\n    var genderid = 1;\n    var genderOpen = false;\n    if ($('#genderstab').exists()) {\n        $('#genderstab').click(function () {\n            // Don't open a second time\n            if (genderOpen) return;\n\n            $.get(snacUrl + \"/edit_part/\" + $('#constellationid').val() + \"/\" + $('#version').val() + \"?part=genders\", null, function (data) {\n                genderOpen = true;\n                $('#genders').html(data);\n\n                turnOnEditDeleteButtons(\"genders\");\n\n                if ($('#next_gender_i').exists()) {\n                    genderid = parseInt($('#next_gender_i').text());\n                }\n                console.log(\"Next Gender ID: \" + genderid);\n                if ($('#btn_add_gender').exists()) {\n                    $('#btn_add_gender').click(function () {\n                        setEditedFlag(true);\n                        //somethingHasBeenEdited = true;\n                        var text = $('#gender_template').clone();\n                        var html = text.html().replace(/ZZ/g, genderid);\n                        $('#add_gender_div').after(html);\n                        turnOnButtons(\"gender\", genderid);\n                        turnOnTooltips(\"gender\", genderid);\n                        makeEditable(\"gender\", genderid);\n                        genderid = genderid + 1;\n                        return false;\n                    });\n                }\n\n                turnOnTooltipsForTab(\"genders\");\n            });\n        });\n    }\n\n    // Code to handle adding new genders to the page\n    var existid = 1;\n    var existOpen = false;\n    if ($('#existstab').exists()) {\n        $('#existstab').click(function () {\n            // Don't open a second time\n            if (existOpen) return;\n\n            $.get(snacUrl + \"/edit_part/\" + $('#constellationid').val() + \"/\" + $('#version').val() + \"?part=dates\", null, function (data) {\n                existOpen = true;\n                $('#dates').html(data);\n\n                turnOnEditDeleteButtons(\"dates\");\n\n                if ($('#next_exist_i').exists()) {\n                    existid = parseInt($('#next_exist_i').text());\n                }\n                console.log(\"Next Exist Date ID: \" + existid);\n                if ($('#btn_add_exist_date').exists()) {\n                    $('#btn_add_exist_date').click(function () {\n                        setEditedFlag(true);\n                        //somethingHasBeenEdited = true;\n                        var text = $('#exist_date_template').clone();\n                        var html = text.html().replace(/ZZ/g, existid);\n                        $('#add_exist_div').after(html);\n                        turnOnButtons(\"exist\", existid);\n                        turnOnTooltips(\"exist\", existid);\n                        makeEditable(\"exist\", existid);\n                        existid = existid + 1;\n                        return false;\n                    });\n                }\n                if ($('#btn_add_exist_dateRange').exists()) {\n                    $('#btn_add_exist_dateRange').click(function () {\n                        setEditedFlag(true);\n                        //somethingHasBeenEdited = true;\n                        var text = $('#exist_dateRange_template').clone();\n                        var html = text.html().replace(/ZZ/g, existid);\n                        $('#add_exist_div').after(html);\n                        turnOnButtons(\"exist\", existid);\n                        turnOnTooltips(\"exist\", existid);\n                        makeEditable(\"exist\", existid);\n                        existid = existid + 1;\n                        return false;\n                    });\n                }\n\n                turnOnTooltipsForTab(\"dates\");\n            });\n        });\n    }\n\n    var sameAsid = 1;\n    var sameAsOpen = false;\n    if ($('#sameAstab').exists()) {\n        $('#sameAstab').click(function () {\n            // Don't open a second time\n            if (sameAsOpen) return;\n            //set sameAs vocab type id\n            $.get(snacUrl + \"/vocabulary?type=record_type&q=SameAs\", null, function (data) {\n                sameAsTermId = data.results[0].id;\n                $(\"#sameAs_type_id_ZZ\").val(sameAsTermId);\n            });\n\n            $.get(snacUrl + \"/edit_part/\" + $('#constellationid').val() + \"/\" + $('#version').val() + \"?part=sameAs\", null, function (data) {\n                sameAsOpen = true;\n                $('#sameAs').html(data);\n\n                turnOnEditDeleteButtons(\"sameAs\");\n\n                if ($('#next_sameAs_i').exists()) {\n                    sameAsid = parseInt($('#next_sameAs_i').text());\n                }\n                console.log(\"Next sameAs ID: \" + sameAsid);\n                if ($('#btn_add_sameAs').exists()) {\n                    $('#btn_add_sameAs').click(function () {\n                        setEditedFlag(true);\n                        //somethingHasBeenEdited = true;\n                        var text = $('#sameAs_template').clone();\n                        var html = text.html().replace(/ZZ/g, sameAsid);\n                        $('#add_sameAs_div').after(html);\n                        turnOnButtons(\"sameAs\", sameAsid);\n                        turnOnTooltips(\"sameAs\", sameAsid);\n                        makeEditable(\"sameAs\", sameAsid);\n                        sameAsid = sameAsid + 1;\n                        return false;\n                    });\n                }\n\n                turnOnTooltipsForTab(\"sameAs\");\n            });\n        });\n    }\n\n    var entityIDid = 1;\n    var entityIDOpen = false;\n    if ($('#entityIDtab').exists()) {\n        $('#entityIDtab').click(function () {\n            // Don't open a second time\n            if (entityIDOpen) return;\n\n            $.get(snacUrl + \"/edit_part/\" + $('#constellationid').val() + \"/\" + $('#version').val() + \"?part=entityID\", null, function (data) {\n                entityIDOpen = true;\n                $('#entityID').html(data);\n\n                turnOnEditDeleteButtons(\"entityID\");\n\n                if ($('#next_entityID_i').exists()) {\n                    entityIDid = parseInt($('#next_entityID_i').text());\n                }\n                console.log(\"Next entityID ID: \" + entityIDid);\n                if ($('#btn_add_entityID').exists()) {\n                    $('#btn_add_entityID').click(function () {\n                        setEditedFlag(true);\n                        //somethingHasBeenEdited = true;\n                        var text = $('#entityID_template').clone();\n                        var html = text.html().replace(/ZZ/g, entityIDid);\n                        $('#add_entityID_div').after(html);\n                        turnOnButtons(\"entityID\", entityIDid);\n                        turnOnTooltips(\"entityID\", entityIDid);\n                        makeEditable(\"entityID\", entityIDid);\n                        entityIDid = entityIDid + 1;\n                        return false;\n                    });\n                }\n\n                turnOnTooltipsForTab(\"entityID\");\n            });\n        });\n    }\n\n    var sourceid = 1;\n    var sourceOpen = false;\n    if ($('#sourcestab').exists()) {\n        $('#sourcestab').click(function () {\n            // Don't open a second time\n            if (sourceOpen) return;\n\n            $.get(snacUrl + \"/edit_part/\" + $('#constellationid').val() + \"/\" + $('#version').val() + \"?part=sources\", null, function (data) {\n                sourceOpen = true;\n                $('#sources').html(data);\n\n                turnOnEditDeleteButtons(\"sources\");\n\n                if ($('#next_source_i').exists()) {\n                    sourceid = parseInt($('#next_source_i').text());\n                }\n                console.log(\"Next source ID: \" + sourceid);\n                if ($('#btn_add_source').exists()) {\n                    $('#btn_add_source').click(function () {\n                        setEditedFlag(true);\n                        //somethingHasBeenEdited = true;\n                        var text = $('#source_template').clone();\n                        var html = text.html().replace(/ZZ/g, sourceid);\n                        $('#add_source_div').after(html);\n                        turnOnButtons(\"source\", sourceid);\n                        turnOnTooltips(\"source\", sourceid);\n                        makeEditable(\"source\", sourceid);\n                        sourceid = sourceid + 1;\n                        return false;\n                    });\n                }\n\n                turnOnTooltipsForTab(\"sources\");\n            });\n        });\n    }\n\n    var resourceRelationid = 1;\n    var resourceRelationOpen = false;\n    if ($('#resourceRelationstab').exists()) {\n        $('#resourceRelationstab').click(function () {\n            // Don't open a second time\n            if (resourceRelationOpen) return;\n\n            $.get(snacUrl + \"/edit_part/\" + $('#constellationid').val() + \"/\" + $('#version').val() + \"?part=resourceRelations\", null, function (data) {\n                resourceRelationOpen = true;\n                $('#resourceRelations').html(data);\n\n                turnOnEditDeleteButtons(\"resourceRelations\");\n\n                if ($('#next_resourceRelation_i').exists()) {\n                    resourceRelationid = parseInt($('#next_resourceRelation_i').text());\n                }\n                console.log(\"Next resourceRelation ID: \" + resourceRelationid);\n                if ($('#btn_create_resourceRelation').exists()) {\n                    $('#btn_create_resourceRelation').click(function () {\n                        var rid = $('input[name=resourceChoice]:checked', '#resource_search_form').val();\n                        if (rid != null && resourceResults != null && rid != 'new') {\n                            setEditedFlag(true);\n                            //somethingHasBeenEdited = true;\n                            var text = $('#resourceRelation_template').clone();\n                            var html = text.html().replace(/ZZ/g, resourceRelationid);\n                            $('#add_resourceRelation_div').after(html);\n\n                            if (typeof resourceResults[rid].id !== 'undefined') $('#resourceRelation_resourceid_' + resourceRelationid).val(resourceResults[rid].id);\n                            if (typeof resourceResults[rid].version !== 'undefined') $('#resourceRelation_resourceversion_' + resourceRelationid).val(resourceResults[rid].version);\n\n                            if (typeof resourceResults[rid].link !== 'undefined') $('#resourceRelation_linkText_' + resourceRelationid).html(\"<a target='_blank' href='\" + resourceResults[rid].link + \"'>\" + resourceResults[rid].link + \"</a>\" + \" <a class='label label-info' target='_blank' href='\" + resourceResults[rid].link + \"'>View</a>\");\n                            if (typeof resourceResults[rid].displayEntry !== 'undefined') $('#resourceRelation_displayEntryText_' + resourceRelationid).text(resourceResults[rid].displayEntry);\n                            if (typeof resourceResults[rid].title !== 'undefined') {\n                                $('#resourceRelation_titleText_' + resourceRelationid).text(resourceResults[rid].title);\n                                updatePictureTitle('resourceRelation', resourceRelationid, resourceResults[rid].title);\n                            }\n                            if (typeof resourceResults[rid].abstract !== 'undefined') $('#resourceRelation_abstractText_' + resourceRelationid).text(resourceResults[rid].abstract);\n                            if (typeof resourceResults[rid].extent !== 'undefined') $('#resourceRelation_extentText_' + resourceRelationid).text(resourceResults[rid].extent);\n                            // if (typeof resourceResults[rid].date !== 'undefined')\n                            //     $('#resourceRelation_dateText_'+resourceRelationid).text(resourceResults[rid].date);\n                            if (typeof resourceResults[rid].documentType !== 'undefined' && typeof resourceResults[rid].documentType.term !== 'undefined') $('#resourceRelation_documentTypeText_' + resourceRelationid).text(resourceResults[rid].documentType.term);\n\n                            $('#resourceRelation_linkText_' + resourceRelationid).after(\"<a class='control-label-subtext' target='_blank' href='\" + snacUrl + \"/vocab_administrator/resources/\" + resourceResults[rid].id + \"'>View in SNAC</a>\");\n                            turnOnButtons(\"resourceRelation\", resourceRelationid);\n                            turnOnTooltips(\"resourceRelation\", resourceRelationid);\n                            makeEditable(\"resourceRelation\", resourceRelationid);\n                            resourceRelationid = resourceRelationid + 1;\n                            $(\"#resource-results-box\").html(\"\");\n                            return true;\n                        }\n                        return false;\n                    });\n                }\n\n                if ($('#btn_open_create_resource').exists()) {\n                    $('#btn_open_create_resource').click(function () {\n                        // Close this modal and open the new modal\n                        $(\"#resourceSearchPane\").modal(\"hide\");\n\n                        // Set a 500ms timeout to give the hidden search pane time to fully close\n                        setTimeout(function () {\n                            $(\"#resourceCreatePane\").modal(\"show\");\n                        }, 500);\n\n                        // Grab the empty template and replace\n                        var text = $('#resource_template').clone();\n                        var html = text.html().replace(/ZZ/g, 0);\n                        $('#resource-create-box').html(html);\n                        var $resourceForm = $(\"#resource_create_form\");\n                        // Copy the search contents to title or href\n                        if ($(\"#resource-searchbox\").val().indexOf(\"http\") == -1) $resourceForm.find(\"#resource-title\").val($(\"#resource-searchbox\").val());else $resourceForm.find(\"#resource-url\").val($(\"#resource-searchbox\").val());\n\n                        $resourceForm.find('[data-toggle=\"popover\"]').popover({\n                            trigger: 'hover',\n                            container: 'body'\n                        });\n                        loadVocabSelectOptions($resourceForm.find(\"#resource-type-select\"), \"document_type\", \"Resource Type\");\n                        vocab_select_replace($resourceForm.find(\"#resource-repo\"), \"\", \"holding\", 3);\n                        $resourceForm.find(\"#new-resource-language-btn\").on(\"click\", newResourceLanguage);\n                        $resourceForm.find(\"#magic-resource-language-btn\").on(\"click\", magicNewResourceLanguage);\n\n                        $('#search-results-box').on(\"click\", \"a.list-group-item\", selectHoldingRepository);\n                        var timeoutID = null;\n                        $resourceForm.find('#searchbox').keyup(function () {\n                            clearTimeout(timeoutID);\n                            timeoutID = setTimeout(function () {\n                                setSearchPosition(0);searchAndUpdate();\n                            }, 500);\n                        });\n\n                        // Remove the search results from the other modal\n                        $(\"#resource-results-box\").html(\"\");\n                        return false;\n                    });\n                }\n\n                if ($('#btn_create_resource').exists()) {\n                    $('#resource_create_form').on(\"submit\", function () {\n                        // Remove leading and trailing whitespace\n                        if ($(\"#resource_create_form #resource-url\").val() == \"\") {\n                            if (!confirm('Are you sure you want to save without an HREF?')) {\n                                return;\n                            }\n                        }\n                        $(\"#resource_create_form input, textarea\").each(function () {\n                            $(this).val($.trim($(this).val()));\n                        });\n                        setDeletedResourceLanguageOperations($(\"#resource_create_form\"));\n\n                        $.post(snacUrl + \"/save_resource\", $(\"#resource_create_form\").serialize(), function (data) {\n                            if (typeof data.result !== 'undefined' && data.result !== 'false') {\n                                setEditedFlag(true);\n                                //somethingHasBeenEdited = true;\n                                var text = $('#resourceRelation_template').clone();\n                                var html = text.html().replace(/ZZ/g, resourceRelationid); // clones DOM, replaces zz with next ids\n                                $('#add_resourceRelation_div').after(html);\n\n                                if (typeof data.resource.id !== 'undefined') $('#resourceRelation_resourceid_' + resourceRelationid).val(data.resource.id);\n                                if (typeof data.resource.version !== 'undefined') $('#resourceRelation_resourceversion_' + resourceRelationid).val(data.resource.version);\n\n                                if (typeof data.resource.link !== 'undefined') $('#resourceRelation_linkText_' + resourceRelationid).html(\"<a target='_blank' href='\" + data.resource.link + \"'>\" + data.resource.link + \"</a>\" + \" <a class='label label-info' target='_blank' href='\" + data.resource.link + \"'>View</a>\");\n                                if (typeof data.resource.displayEntry !== 'undefined') $('#resourceRelation_displayEntryText_' + resourceRelationid).text(data.resource.displayEntry);\n                                if (typeof data.resource.title !== 'undefined') {\n                                    $('#resourceRelation_titleText_' + resourceRelationid).text(data.resource.title);\n                                    updatePictureTitle('resourceRelation', resourceRelationid, data.resource.title);\n                                }\n                                if (typeof data.resource.abstract !== 'undefined') $('#resourceRelation_abstractText_' + resourceRelationid).text(data.resource.abstract);\n                                if (typeof data.resource.extent !== 'undefined') $('#resourceRelation_extentText_' + resourceRelationid).text(data.resource.extent);\n                                if (typeof data.resource.documentType !== 'undefined' && typeof data.resource.documentType.term !== 'undefined') $('#resourceRelation_documentTypeText_' + resourceRelationid).text(data.resource.documentType.term);\n\n                                $('#resourceRelation_linkText_' + resourceRelationid).after(\"<a class='control-label-subtext' target='_blank' href='\" + snacUrl + \"/vocab_administrator/resources/\" + data.resource.id + \"'>View in SNAC</a>\");\n                                turnOnButtons(\"resourceRelation\", resourceRelationid);\n                                turnOnTooltips(\"resourceRelation\", resourceRelationid);\n                                makeEditable(\"resourceRelation\", resourceRelationid);\n                                resourceRelationid = resourceRelationid + 1;\n                                $(\"#resourceCreatePane\").modal(\"hide\");\n                                $('#resource-create-box').html(\"\");\n                                return true;\n                            } else {\n                                console.log(data);\n                                return false;\n                            }\n                        });\n                        return false;\n                    });\n                }\n\n                turnOnTooltipsForTab(\"resourceRelations\");\n            });\n        });\n    }\n\n    var constellationRelationid = 1;\n    var constellationRelationOpen = false;\n    if ($('#constellationRelationstab').exists()) {\n        $('#constellationRelationstab').click(function () {\n            // Don't open a second time\n            if (constellationRelationOpen) return;\n\n            $.get(snacUrl + \"/edit_part/\" + $('#constellationid').val() + \"/\" + $('#version').val() + \"?part=constellationRelations\", null, function (data) {\n                constellationRelationOpen = true;\n                $('#constellationRelations').html(data);\n\n                turnOnEditDeleteButtons(\"constellationRelations\");\n\n                if ($('#next_constellationRelation_i').exists()) {\n                    constellationRelationid = parseInt($('#next_constellationRelation_i').text());\n                }\n                console.log(\"Next constellationRelation ID: \" + constellationRelationid);\n                if ($('#btn_create_constellationRelation').exists()) {\n                    $('#btn_create_constellationRelation').click(function () {\n                        var cid = $('input[name=relationChoice]:checked', '#relation_search_form').val();\n                        if (cid != null) {\n                            setEditedFlag(true);\n                            //somethingHasBeenEdited = true;\n                            var text = $('#constellationRelation_template').clone();\n                            var html = text.html().replace(/ZZ/g, constellationRelationid);\n                            $('#add_constellationRelation_div').after(html);\n                            $('#constellationRelation_targetID_' + constellationRelationid).val(cid);\n                            $('#constellationRelation_content_' + constellationRelationid).val($('#relationChoice_nameEntry_' + cid).val());\n                            $('#constellationRelation_targetArkID_' + constellationRelationid).val($('#relationChoice_arkID_' + cid).val());\n                            $('#constellationRelation_targetEntityType_' + constellationRelationid).val($('#relationChoice_entityType_' + cid).val());\n\n                            updatePictureIcon('constellationRelation', constellationRelationid, $('#relationChoice_entityTypeText_' + cid).val());\n                            updatePictureTitle('constellationRelation', constellationRelationid, $('#relationChoice_nameEntry_' + cid).val());\n\n                            $('#constellationRelation_contentText_' + constellationRelationid).text($('#relationChoice_nameEntry_' + cid).val());\n                            $('#constellationRelation_targetArkIDText_' + constellationRelationid).text($('#relationChoice_arkID_' + cid).val());\n\n                            turnOnButtons(\"constellationRelation\", constellationRelationid);\n                            turnOnTooltips(\"constellationRelation\", constellationRelationid);\n                            makeEditable(\"constellationRelation\", constellationRelationid);\n\n                            constellationRelationid = constellationRelationid + 1;\n\n                            return true;\n                        }\n\n                        return false;\n                    });\n                }\n\n                turnOnTooltipsForTab(\"constellationRelations\");\n            });\n        });\n    }\n\n    var languageid = 1;\n    var languageOpen = false;\n    if ($('#languagesUsedtab').exists()) {\n        $('#languagesUsedtab').click(function () {\n            // Don't open a second time\n            if (languageOpen) return;\n\n            $.get(snacUrl + \"/edit_part/\" + $('#constellationid').val() + \"/\" + $('#version').val() + \"?part=languagesUsed\", null, function (data) {\n                languageOpen = true;\n                $('#languagesUsed').html(data);\n\n                turnOnEditDeleteButtons(\"languagesUsed\");\n\n                if ($('#next_language_i').exists()) {\n                    languageid = parseInt($('#next_language_i').text());\n                }\n                console.log(\"Next language ID: \" + languageid);\n                if ($('#btn_add_language').exists()) {\n                    $('#btn_add_language').click(function () {\n                        setEditedFlag(true);\n                        //somethingHasBeenEdited = true;\n                        var text = $('#language_template').clone();\n                        var html = text.html().replace(/ZZ/g, languageid);\n                        $('#add_language_div').after(html);\n                        turnOnButtons(\"language\", languageid);\n                        turnOnTooltips(\"language\", languageid);\n                        makeEditable(\"language\", languageid);\n                        languageid = languageid + 1;\n                        return false;\n                    });\n                }\n\n                turnOnTooltipsForTab(\"languagesUsed\");\n            });\n        });\n    }\n\n    var subjectid = 1;\n    var subjectOpen = false;\n    if ($('#subjectstab').exists()) {\n        $('#subjectstab').click(function () {\n            // Don't open a second time\n            if (subjectOpen) return;\n\n            $.get(snacUrl + \"/edit_part/\" + $('#constellationid').val() + \"/\" + $('#version').val() + \"?part=subjects\", null, function (data) {\n                subjectOpen = true;\n                $('#subjects').html(data);\n\n                turnOnEditDeleteButtons(\"subjects\");\n\n                if ($('#next_subject_i').exists()) {\n                    subjectid = parseInt($('#next_subject_i').text());\n                }\n                console.log(\"Next subject ID: \" + subjectid);\n                if ($('#btn_add_subject').exists()) {\n                    $('#btn_add_subject').click(function () {\n                        setEditedFlag(true);\n                        //somethingHasBeenEdited = true;\n                        var text = $('#subject_template').clone();\n                        var html = text.html().replace(/ZZ/g, subjectid);\n                        $('#add_subject_div').after(html);\n                        turnOnButtons(\"subject\", subjectid);\n                        turnOnTooltips(\"subject\", subjectid);\n                        makeEditable(\"subject\", subjectid);\n                        subjectid = subjectid + 1;\n                        return false;\n                    });\n                }\n\n                turnOnTooltipsForTab(\"subjects\");\n            });\n        });\n    }\n\n    var nationalityid = 1;\n    var nationalityOpen = false;\n    if ($('#nationalitiestab').exists()) {\n        $('#nationalitiestab').click(function () {\n            // Don't open a second time\n            if (nationalityOpen) return;\n\n            $.get(snacUrl + \"/edit_part/\" + $('#constellationid').val() + \"/\" + $('#version').val() + \"?part=nationalities\", null, function (data) {\n                nationalityOpen = true;\n                $('#nationalities').html(data);\n\n                turnOnEditDeleteButtons(\"nationalities\");\n\n                if ($('#next_nationality_i').exists()) {\n                    nationalityid = parseInt($('#next_nationality_i').text());\n                }\n                console.log(\"Next nationality ID: \" + nationalityid);\n                if ($('#btn_add_nationality').exists()) {\n                    $('#btn_add_nationality').click(function () {\n                        setEditedFlag(true);\n                        //somethingHasBeenEdited = true;\n                        var text = $('#nationality_template').clone();\n                        var html = text.html().replace(/ZZ/g, nationalityid);\n                        $('#add_nationality_div').after(html);\n                        turnOnButtons(\"nationality\", nationalityid);\n                        turnOnTooltips(\"nationality\", nationalityid);\n                        makeEditable(\"nationality\", nationalityid);\n                        nationalityid = nationalityid + 1;\n                        return false;\n                    });\n                }\n\n                turnOnTooltipsForTab(\"nationalities\");\n            });\n        });\n    }\n\n    var functionid = 1;\n    var functionOpen = false;\n    if ($('#functionstab').exists()) {\n        $('#functionstab').click(function () {\n            // Don't open a second time\n            if (functionOpen) return;\n\n            $.get(snacUrl + \"/edit_part/\" + $('#constellationid').val() + \"/\" + $('#version').val() + \"?part=functions\", null, function (data) {\n                functionOpen = true;\n                $('#functions').html(data);\n\n                turnOnEditDeleteButtons(\"functions\");\n\n                if ($('#next_function_i').exists()) {\n                    functionid = parseInt($('#next_function_i').text());\n                }\n                console.log(\"Next function ID: \" + functionid);\n                if ($('#btn_add_function').exists()) {\n                    $('#btn_add_function').click(function () {\n                        setEditedFlag(true);\n                        //somethingHasBeenEdited = true;\n                        var text = $('#function_template').clone();\n                        var html = text.html().replace(/ZZ/g, functionid);\n                        $('#add_function_div').after(html);\n                        turnOnButtons(\"function\", functionid);\n                        turnOnTooltips(\"function\", functionid);\n                        makeEditable(\"function\", functionid);\n                        functionid = functionid + 1;\n                        return false;\n                    });\n                }\n\n                turnOnTooltipsForTab(\"functions\");\n            });\n        });\n    }\n\n    var occupationid = 1;\n    var occupationOpen = false;\n    if ($('#occupationstab').exists()) {\n        $('#occupationstab').click(function () {\n            // Don't open a second time\n            if (occupationOpen) return;\n\n            $.get(snacUrl + \"/edit_part/\" + $('#constellationid').val() + \"/\" + $('#version').val() + \"?part=occupations\", null, function (data) {\n                occupationOpen = true;\n                $('#occupations').html(data);\n\n                turnOnEditDeleteButtons(\"occupations\");\n\n                if ($('#next_occupation_i').exists()) {\n                    occupationid = parseInt($('#next_occupation_i').text());\n                }\n                console.log(\"Next occupation ID: \" + occupationid);\n                if ($('#btn_add_occupation').exists()) {\n                    $('#btn_add_occupation').click(function () {\n                        setEditedFlag(true);\n                        //somethingHasBeenEdited = true;\n                        var text = $('#occupation_template').clone();\n                        var html = text.html().replace(/ZZ/g, occupationid);\n                        $('#add_occupation_div').after(html);\n                        turnOnButtons(\"occupation\", occupationid);\n                        turnOnTooltips(\"occupation\", occupationid);\n                        makeEditable(\"occupation\", occupationid);\n                        occupationid = occupationid + 1;\n                        return false;\n                    });\n                }\n\n                turnOnTooltipsForTab(\"occupations\");\n            });\n        });\n    }\n\n    var legalStatusid = 1;\n    var legalStatusOpen = false;\n    if ($('#legalStatusestab').exists()) {\n        $('#legalStatusestab').click(function () {\n            // Don't open a second time\n            if (legalStatusOpen) return;\n\n            $.get(snacUrl + \"/edit_part/\" + $('#constellationid').val() + \"/\" + $('#version').val() + \"?part=legalStatuses\", null, function (data) {\n                legalStatusOpen = true;\n                $('#legalStatuses').html(data);\n\n                turnOnEditDeleteButtons(\"legalStatuses\");\n\n                if ($('#next_legalStatus_i').exists()) {\n                    legalStatusid = parseInt($('#next_legalStatus_i').text());\n                }\n                console.log(\"Next legalStatus ID: \" + legalStatusid);\n                if ($('#btn_add_legalStatus').exists()) {\n                    $('#btn_add_legalStatus').click(function () {\n                        setEditedFlag(true);\n                        //somethingHasBeenEdited = true;\n                        var text = $('#legalStatus_template').clone();\n                        var html = text.html().replace(/ZZ/g, legalStatusid);\n                        $('#add_legalStatus_div').after(html);\n                        turnOnButtons(\"legalStatus\", legalStatusid);\n                        turnOnTooltips(\"legalStatus\", legalStatusid);\n                        makeEditable(\"legalStatus\", legalStatusid);\n                        legalStatusid = legalStatusid + 1;\n                        return false;\n                    });\n                }\n\n                turnOnTooltipsForTab(\"legalStatuses\");\n            });\n        });\n    }\n\n    var placeid = 1;\n    var placeOpen = false;\n    if ($('#placestab').exists()) {\n        $('#placestab').click(function () {\n            // Don't open a second time\n            if (placeOpen) return;\n\n            $.get(snacUrl + \"/edit_part/\" + $('#constellationid').val() + \"/\" + $('#version').val() + \"?part=places\", null, function (data) {\n                placeOpen = true;\n                $('#places').html(data);\n\n                // Load the place cache, if needed\n                loadGeoPlaceResultCache();\n\n                turnOnEditDeleteButtons(\"places\");\n\n                if ($('#next_place_i').exists()) {\n                    placeid = parseInt($('#next_place_i').text());\n                }\n                console.log(\"Next place ID: \" + placeid);\n                if ($('#btn_add_place').exists()) {\n                    $('#btn_add_place').click(function () {\n                        setEditedFlag(true);\n                        //somethingHasBeenEdited = true;\n                        var text = $('#place_template').clone();\n                        var html = text.html().replace(/ZZ/g, placeid);\n                        $('#add_place_div').after(html);\n                        turnOnButtons(\"place\", placeid);\n                        turnOnTooltips(\"place\", placeid);\n                        makeEditable(\"place\", placeid);\n                        placeid = placeid + 1;\n                        return false;\n                    });\n                }\n\n                turnOnTooltipsForTab(\"places\");\n            });\n        });\n    }\n\n    var conventionDeclarationid = 1;\n    var conventionDeclarationOpen = false;\n    if ($('#conventionDeclarationstab').exists()) {\n        $('#conventionDeclarationstab').click(function () {\n            // Don't open a second time\n            if (conventionDeclarationOpen) return;\n\n            $.get(snacUrl + \"/edit_part/\" + $('#constellationid').val() + \"/\" + $('#version').val() + \"?part=conventionDeclarations\", null, function (data) {\n                conventionDeclarationOpen = true;\n                $('#conventionDeclarations').html(data);\n\n                turnOnEditDeleteButtons(\"conventionDeclarations\");\n\n                if ($('#next_conventionDeclaration_i').exists()) {\n                    conventionDeclarationid = parseInt($('#next_conventionDeclaration_i').text());\n                }\n                console.log(\"Next conventionDeclaration ID: \" + conventionDeclarationid);\n                if ($('#btn_add_conventionDeclaration').exists()) {\n                    $('#btn_add_conventionDeclaration').click(function () {\n                        setEditedFlag(true);\n                        //somethingHasBeenEdited = true;\n                        var text = $('#conventionDeclaration_template').clone();\n                        var html = text.html().replace(/ZZ/g, conventionDeclarationid);\n                        $('#add_conventionDeclaration_div').after(html);\n                        turnOnButtons(\"conventionDeclaration\", conventionDeclarationid);\n                        turnOnTooltips(\"conventionDeclaration\", conventionDeclarationid);\n                        makeEditable(\"conventionDeclaration\", conventionDeclarationid);\n                        conventionDeclarationid = conventionDeclarationid + 1;\n                        return false;\n                    });\n                }\n\n                turnOnTooltipsForTab(\"conventionDeclarations\");\n            });\n        });\n    }\n\n    var generalContextid = 1;\n    var generalContextOpen = false;\n    if ($('#generalContextstab').exists()) {\n        $('#generalContextstab').click(function () {\n            // Don't open a second time\n            if (generalContextOpen) return;\n\n            $.get(snacUrl + \"/edit_part/\" + $('#constellationid').val() + \"/\" + $('#version').val() + \"?part=generalContexts\", null, function (data) {\n                generalContextOpen = true;\n                $('#generalContexts').html(data);\n\n                turnOnEditDeleteButtons(\"generalContexts\");\n\n                if ($('#next_generalContext_i').exists()) {\n                    generalContextid = parseInt($('#next_generalContext_i').text());\n                }\n                console.log(\"Next generalContext ID: \" + generalContextid);\n                if ($('#btn_add_generalContext').exists()) {\n                    $('#btn_add_generalContext').click(function () {\n                        setEditedFlag(true);\n                        //somethingHasBeenEdited = true;\n                        var text = $('#generalContext_template').clone();\n                        var html = text.html().replace(/ZZ/g, generalContextid);\n                        $('#add_generalContext_div').after(html);\n                        turnOnButtons(\"generalContext\", generalContextid);\n                        turnOnTooltips(\"generalContext\", generalContextid);\n                        makeEditable(\"generalContext\", generalContextid);\n                        generalContextid = generalContextid + 1;\n                        return false;\n                    });\n                }\n\n                turnOnTooltipsForTab(\"generalContexts\");\n            });\n        });\n    }\n\n    var structureOrGenealogyid = 1;\n    var structureOrGenealogyOpen = false;\n    if ($('#structureOrGenealogiestab').exists()) {\n        $('#structureOrGenealogiestab').click(function () {\n            // Don't open a second time\n            if (structureOrGenealogyOpen) return;\n\n            $.get(snacUrl + \"/edit_part/\" + $('#constellationid').val() + \"/\" + $('#version').val() + \"?part=structureOrGenealogies\", null, function (data) {\n                structureOrGenealogyOpen = true;\n                $('#structureOrGenealogies').html(data);\n\n                turnOnEditDeleteButtons(\"structureOrGenealogies\");\n\n                if ($('#next_structureOrGenealogy_i').exists()) {\n                    structureOrGenealogyid = parseInt($('#next_structureOrGenealogy_i').text());\n                }\n                console.log(\"Next structureOrGenealogy ID: \" + structureOrGenealogyid);\n                if ($('#btn_add_structureOrGenealogy').exists()) {\n                    $('#btn_add_structureOrGenealogy').click(function () {\n                        setEditedFlag(true);\n                        //somethingHasBeenEdited = true;\n                        var text = $('#structureOrGenealogy_template').clone();\n                        var html = text.html().replace(/ZZ/g, structureOrGenealogyid);\n                        $('#add_structureOrGenealogy_div').after(html);\n                        turnOnButtons(\"structureOrGenealogy\", structureOrGenealogyid);\n                        turnOnTooltips(\"structureOrGenealogy\", structureOrGenealogyid);\n                        makeEditable(\"structureOrGenealogy\", structureOrGenealogyid);\n                        structureOrGenealogyid = structureOrGenealogyid + 1;\n                        return false;\n                    });\n                }\n\n                turnOnTooltipsForTab(\"structureOrGenealogies\");\n            });\n        });\n    }\n\n    var mandateid = 1;\n    var mandateOpen = false;\n    if ($('#mandatestab').exists()) {\n        $('#mandatestab').click(function () {\n            // Don't open a second time\n            if (mandateOpen) return;\n\n            $.get(snacUrl + \"/edit_part/\" + $('#constellationid').val() + \"/\" + $('#version').val() + \"?part=mandates\", null, function (data) {\n                mandateOpen = true;\n                $('#mandates').html(data);\n\n                turnOnEditDeleteButtons(\"mandates\");\n\n                if ($('#next_mandate_i').exists()) {\n                    mandateid = parseInt($('#next_mandate_i').text());\n                }\n                console.log(\"Next mandate ID: \" + mandateid);\n                if ($('#btn_add_mandate').exists()) {\n                    $('#btn_add_mandate').click(function () {\n                        setEditedFlag(true);\n                        //somethingHasBeenEdited = true;\n                        var text = $('#mandate_template').clone();\n                        var html = text.html().replace(/ZZ/g, mandateid);\n                        $('#add_mandate_div').after(html);\n                        turnOnButtons(\"mandate\", mandateid);\n                        turnOnTooltips(\"mandate\", mandateid);\n                        makeEditable(\"mandate\", mandateid);\n                        mandateid = mandateid + 1;\n                        return false;\n                    });\n                }\n\n                turnOnTooltipsForTab(\"mandates\");\n            });\n        });\n    }\n\n    var biogHistid = 1;\n    var biogHistOpen = false;\n    if ($('#biogHiststab').exists()) {\n        $('#biogHiststab').click(function () {\n            // Don't open a second time\n            if (biogHistOpen) return;\n\n            $.get(snacUrl + \"/edit_part/\" + $('#constellationid').val() + \"/\" + $('#version').val() + \"?part=biogHists\", null, function (data) {\n                biogHistOpen = true;\n                $('#biogHists').html(data);\n\n                turnOnEditDeleteButtons(\"biogHists\");\n\n                if ($('#next_biogHist_i').exists()) {\n                    biogHistid = parseInt($('#next_biogHist_i').text());\n                }\n                console.log(\"Next biogHist ID: \" + biogHistid);\n                if ($('#btn_add_biogHist').exists()) {\n                    $('#btn_add_biogHist').click(function () {\n                        setEditedFlag(true);\n                        //somethingHasBeenEdited = true;\n                        var text = $('#biogHist_template').clone();\n                        var html = text.html().replace(/ZZ/g, biogHistid);\n                        $('#add_biogHist_div').after(html);\n                        turnOnButtons(\"biogHist\", biogHistid);\n                        turnOnTooltips(\"biogHist\", biogHistid);\n                        makeEditable(\"biogHist\", biogHistid);\n                        biogHistid = biogHistid + 1;\n                        return false;\n                    });\n                }\n\n                turnOnTooltipsForTab(\"biogHists\");\n            });\n        });\n    }\n\n    turnOnTooltipsForTab();\n\n    $(\"#info-dropdown\").click(function (e) {\n        $(this).parent().toggleClass(\"open\");\n        e.stopPropagation();\n    });\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9zcmMvdmlydHVhbGhvc3RzL3d3dy9qYXZhc2NyaXB0L3NyYy9lZGl0X3NjcmlwdHMuanM/N2I1OCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEVkaXQgU2NyaXB0c1xuICpcbiAqIFNjcmlwdHMgdXNlZCBpbiB0aGUgZWRpdCBwYWdlXG4gKlxuICogQGF1dGhvciBSb2JiaWUgSG90dFxuICogQGxpY2Vuc2UgaHR0cHM6Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9CU0QtMy1DbGF1c2UgQlNEIDMtQ2xhdXNlXG4gKiBAY29weXJpZ2h0IDIwMTUgdGhlIFJlY3RvciBhbmQgVmlzaXRvcnMgb2YgdGhlIFVuaXZlcnNpdHkgb2YgVmlyZ2luaWEsIGFuZFxuICogICAgICAgICAgICB0aGUgUmVnZW50cyBvZiB0aGUgVW5pdmVyc2l0eSBvZiBDYWxpZm9ybmlhXG4gKi9cblxudmFyIGJpb2dIaXN0RWRpdG9yID0gbnVsbDtcblxuLy8gSGFzIGFueXRoaW5nIGJlZW4gZWRpdGVkIG9uIHRoaXMgcGFnZT9cbmV4cG9ydCB2YXIgc29tZXRoaW5nSGFzQmVlbkVkaXRlZCA9IGZhbHNlO1xuXG5leHBvcnQgZnVuY3Rpb24gc2V0RWRpdGVkRmxhZyh2YWwpIHtcbiAgICBpZiAodmFsID09IHRydWUpIHtcbiAgICAgICAkKFwiI3NhdmVfYW5kX2NvbnRpbnVlXCIpLmFkZENsYXNzKFwic2F2ZS1hY3RpdmVcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgICAkKFwiI3NhdmVfYW5kX2NvbnRpbnVlXCIpLnJlbW92ZUNsYXNzKFwic2F2ZS1hY3RpdmVcIik7XG4gICAgfVxuICAgIHNvbWV0aGluZ0hhc0JlZW5FZGl0ZWQgPSB2YWw7XG59XG5cblxuLy8gR2xvYmFsIFVuZG8gU2V0XG5leHBvcnQgdmFyIHVuZG9TZXQgPSBuZXcgQXJyYXkoKTtcblxuZXhwb3J0IHZhciBkZWZhdWx0cyA9IHtcbiAgICBsYW5ndWFnZToge1xuICAgICAgICBpZDogMTMwLFxuICAgICAgICB0ZXJtOiBcImVuZ1wiXG4gICAgfSxcbiAgICBzY3JpcHQ6IHtcbiAgICAgICAgaWQ6IDU4NixcbiAgICAgICAgdGVybTogXCJMYXRuXCJcbiAgICB9XG59O1xuXG5cblxuLyoqXG4gKiBEaXNwbGF5IEVycm9yIG1lc3NhZ2VcbiAqXG4gKiBEaXNwbGF5cyB0aGUgZXJyb3IgbWVzc2FnZSBib3ggdG8gdGhlIHVzZXIgd2l0aCB0aGUgZ2l2ZW4gZXJyb3IgbWVzc2FnZVxuICpcbiAqIEBwYXJhbSBzdHJpbmd8b2JqZWN0IGVyciBUaGUgZXJyb3IgbWVzc2FnZSAoc3RyaW5nKSBvciBlcnJvciBvYmplY3QgY29udGFpbmluZyBhIG1lc3NhZ2UgYW5kIHR5cGUgc3RyaW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkaXNwbGF5RXJyb3JNZXNzYWdlKGVyciwgZGF0YSkge1xuICAgIHZhciBlcnJvck1zZyA9IFwiXCI7XG4gICAgaWYgKHR5cGVvZiBlcnIgPT09ICd1bmRlZmluZWQnKVxuICAgICAgICBlcnJvck1zZyA9IFwiYW4gdW5rbm93biBwcm9ibGVtIG9jY3VycmVkXCI7XG4gICAgZWxzZSBpZiAoKHR5cGVvZiBlcnIpID09IFwic3RyaW5nXCIpXG4gICAgICAgIGVycm9yTXNnID0gZXJyO1xuICAgIGVsc2UgaWYgKGVyci5tZXNzYWdlKVxuICAgICAgICBlcnJvck1zZyA9IGVyci5tZXNzYWdlO1xuICAgIGVsc2UgaWYgKGVyci50eXBlKVxuICAgICAgICBlcnJvck1zZyA9IGVyci50eXBlO1xuICAgIGVsc2VcbiAgICAgICAgZXJyb3JNc2cgPSBcImFuIHVua25vd24gcHJvYmxlbSBvY2N1cnJlZFwiO1xuXG4gICAgJCgnI2Vycm9yLW1lc3NhZ2UnKS5odG1sKFwiPGg0Pk9vcHM8L2g0PjxwPlwiK2Vycm9yTXNnK1wiPC9wPlwiXG4gICAgICAgICAgICArXCI8cCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+XCJcbiAgICAgICAgICAgICtcIjxidXR0b24gdHlwZT1cXFwiYnV0dG9uXFxcIiBjbGFzcz1cXFwiYnRuIGJ0bi13YXJuaW5nXFxcIiBhcmlhLWxhYmVsPVxcXCJDbG9zZVxcXCIgb25DbGljaz1cXFwiJCgnI2Vycm9yLW1lc3NhZ2UnKS5zbGlkZVVwKClcXFwiPlwiK1xuICAgICAgICAgICAgXCJTdGF5IEhlcmVcIlxuICAgICAgICAgICAgK1wiPC9idXR0b24+IFwiXG4gICAgICAgICAgICArXCI8YSBocmVmPVxcXCJcIitzbmFjVXJsK1wiL2Rhc2hib2FyZFxcXCIgdHlwZT1cXFwiYnV0dG9uXFxcIiBjbGFzcz1cXFwiYnRuIGJ0bi1kYW5nZXJcXFwiPlwiK1xuICAgICAgICAgICAgXCJHbyB0byBEYXNoYm9hcmRcIlxuICAgICAgICAgICAgK1wiPC9hPlwiXG4gICAgICAgICAgICArXCI8L3A+XCIpO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgJCgnI2Vycm9yLW1lc3NhZ2UnKS5zbGlkZURvd24oKTtcbiAgICB9LCA1MDApO1xuXG4gICAgLy8gRm9yIHJlZmVyZW5jZSwgcHV0IHRoZSBzZXJ2ZXIgcmVzcG9uc2UgaW4gdGhlIGNvbnNvbGVcbiAgICBjb25zb2xlLmxvZyhkYXRhKTtcbn1cblxuLyoqXG4gKiBBZGQgc3ViLURhdGUgR1VJIG9iamVjdFxuICpcbiAqIEFkZHMgYSBEYXRlIEdVSSBvYmplY3QgdG8gdGhlIERhdGUgbW9kYWwgZm9yIHRoZSBnaXZlbiBcInNob3J0XCIgdHlwZSBvZiBkYXRhIGluZGV4ZWQgYnkgaVxuICpcbiAqIEBwYXJhbSBzdHJpbmcgc2hvcnQgVGhlIHNob3J0IG5hbWUgb2YgdGhlIGRhdGEgb2JqZWN0LCBzdWNoIGFzIFwibmFtZUVudHJ5XCIgb3IgXCJvY2N1cGF0aW9uXCJcbiAqIEBwYXJhbSBzdHJpbmd8aW50IGkgVGhlIGluZGV4IG9mIHRoZSBvYmplY3QgdG8gYWRkIGEgZGF0ZSBvYmplY3QgdG8uXG4gKiBAcmV0dXJucyBib29sZWFuIGZhbHNlIHRvIGtlZXAgdGhlIGJyb3dzZXIgZnJvbSByZWRyYXdpbmcgdGhlIHBhZ2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkZERhdGVFbnRyeShzaG9ydCwgaSl7XG5cdC8vbmV4dF9kYXRlX3t7c2hvcnR9fV97e2l9fV9qXG5cdHZhciBqID0gcGFyc2VJbnQoJCgnI25leHRfZGF0ZV8nK3Nob3J0KydfJytpKydfaicpLnRleHQoKSk7XG5cdHZhciBpZCA9IGogKyBcIl9cIiArIGk7XG4gICAgc2V0RWRpdGVkRmxhZyh0cnVlKTtcbiAgICAvL3NvbWV0aGluZ0hhc0JlZW5FZGl0ZWQgPSB0cnVlO1xuXHR2YXIgdGV4dCA9ICQoJyNzdWJfZGF0ZV90ZW1wbGF0ZScpLmNsb25lKCk7XG4gICAgdmFyIGh0bWwgPSB0ZXh0Lmh0bWwoKS5yZXBsYWNlKC9aWi9nLCBpKS5yZXBsYWNlKC9YWC9nLCBqKS5yZXBsYWNlKC9TSE9SVC9nLCBzaG9ydCk7XG4gICAgJCgnI2FkZF9kYXRlXycrc2hvcnQrJ18nK2krJ19kaXYnKS5hZnRlcihodG1sKTtcbiAgICAkKCcjbmV4dF9kYXRlXycrc2hvcnQrJ18nK2krJ19qJykudGV4dChqICsgMSk7XG4gICAgdHVybk9uQnV0dG9ucyhzaG9ydCtcIl9kYXRlXCIraiwgaSk7XG4gICAgdHVybk9uVG9vbHRpcHMoc2hvcnQrXCJfZGF0ZV9cIitqLCBpKTtcbiAgICBtYWtlRWRpdGFibGUoc2hvcnQgKyBcIl9kYXRlX1wiK2osIGkpO1xuICAgIHJldHVybiBmYWxzZTtcbn1cblxuLyoqXG4gKiBBZGQgc3ViLURhdGUgR1VJIG9iamVjdFxuICpcbiAqIEFkZHMgYSBEYXRlIEdVSSBvYmplY3QgdG8gdGhlIERhdGUgbW9kYWwgZm9yIHRoZSBnaXZlbiBcInNob3J0XCIgdHlwZSBvZiBkYXRhIGluZGV4ZWQgYnkgaVxuICpcbiAqIEBwYXJhbSBzdHJpbmcgc2hvcnQgVGhlIHNob3J0IG5hbWUgb2YgdGhlIGRhdGEgb2JqZWN0LCBzdWNoIGFzIFwibmFtZUVudHJ5XCIgb3IgXCJvY2N1cGF0aW9uXCJcbiAqIEBwYXJhbSBzdHJpbmd8aW50IGkgVGhlIGluZGV4IG9mIHRoZSBvYmplY3QgdG8gYWRkIGEgZGF0ZSBvYmplY3QgdG8uXG4gKiBAcmV0dXJucyBib29sZWFuIGZhbHNlIHRvIGtlZXAgdGhlIGJyb3dzZXIgZnJvbSByZWRyYXdpbmcgdGhlIHBhZ2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkZERhdGVSYW5nZUVudHJ5KHNob3J0LCBpKXtcblx0Ly9uZXh0X2RhdGVfe3tzaG9ydH19X3t7aX19X2pcblx0dmFyIGogPSBwYXJzZUludCgkKCcjbmV4dF9kYXRlXycrc2hvcnQrJ18nK2krJ19qJykudGV4dCgpKTtcblx0dmFyIGlkID0gaiArIFwiX1wiICsgaTtcbiAgICBzZXRFZGl0ZWRGbGFnKHRydWUpO1xuICAgIC8vc29tZXRoaW5nSGFzQmVlbkVkaXRlZCA9IHRydWU7XG5cdHZhciB0ZXh0ID0gJCgnI3N1Yl9kYXRlUmFuZ2VfdGVtcGxhdGUnKS5jbG9uZSgpO1xuICAgIHZhciBodG1sID0gdGV4dC5odG1sKCkucmVwbGFjZSgvWlovZywgaSkucmVwbGFjZSgvWFgvZywgaikucmVwbGFjZSgvU0hPUlQvZywgc2hvcnQpO1xuICAgICQoJyNhZGRfZGF0ZV8nK3Nob3J0KydfJytpKydfZGl2JykuYWZ0ZXIoaHRtbCk7XG4gICAgJCgnI25leHRfZGF0ZV8nK3Nob3J0KydfJytpKydfaicpLnRleHQoaiArIDEpO1xuICAgIHR1cm5PbkJ1dHRvbnMoc2hvcnQrXCJfZGF0ZVwiK2osIGkpO1xuICAgIHR1cm5PblRvb2x0aXBzKHNob3J0K1wiX2RhdGVfXCIraiwgaSk7XG4gICAgbWFrZUVkaXRhYmxlKHNob3J0ICsgXCJfZGF0ZV9cIitqLCBpKTtcbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICogQWRkIFNDTSBHVUkgb2JqZWN0XG4gKlxuICogQWRkcyBhIEdVSSBTQ00gb2JqZWN0IHRvIHRoZSBTQ00gbW9kYWwgZm9yIHRoZSBnaXZlbiBcInNob3J0XCIgdHlwZSBvZiBkYXRhIGluZGV4ZWQgYnkgaVxuICpcbiAqIEBwYXJhbSBzdHJpbmcgc2hvcnQgVGhlIHNob3J0IG5hbWUgb2YgdGhlIGRhdGEgb2JqZWN0LCBzdWNoIGFzIFwibmFtZUVudHJ5XCIgb3IgXCJvY2N1cGF0aW9uXCJcbiAqIEBwYXJhbSBzdHJpbmd8aW50IGkgVGhlIGluZGV4IG9mIHRoZSBvYmplY3QgdG8gYWRkIGFuIFNDTSBvYmplY3QgdG8uXG4gKiBAcmV0dXJucyBib29sZWFuIGZhbHNlIHRvIGtlZXAgdGhlIGJyb3dzZXIgZnJvbSByZWRyYXdpbmcgdGhlIHBhZ2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkZFNDTUVudHJ5KHNob3J0LCBpKXtcblx0Ly9uZXh0X3NjbV97e3Nob3J0fX1fe3tpfX1falxuXHR2YXIgaiA9IHBhcnNlSW50KCQoJyNuZXh0X3NjbV8nK3Nob3J0KydfJytpKydfaicpLnRleHQoKSk7XG5cdHZhciBpZCA9IGogKyBcIl9cIiArIGk7XG4gICAgc2V0RWRpdGVkRmxhZyh0cnVlKTtcbiAgICAvL3NvbWV0aGluZ0hhc0JlZW5FZGl0ZWQgPSB0cnVlO1xuXHR2YXIgdGV4dCA9ICQoJyNzY21fdGVtcGxhdGUnKS5jbG9uZSgpO1xuICAgIHZhciBodG1sID0gdGV4dC5odG1sKCkucmVwbGFjZSgvWlovZywgaSkucmVwbGFjZSgvWVkvZywgaikucmVwbGFjZSgvU0hPUlQvZywgc2hvcnQpO1xuICAgICQoJyNhZGRfc2NtXycrc2hvcnQrJ18nK2krJ19kaXYnKS5hZnRlcihodG1sKTtcbiAgICAkKCcjbmV4dF9zY21fJytzaG9ydCsnXycraSsnX2onKS50ZXh0KGogKyAxKTtcbiAgICB0dXJuT25TQ01CdXR0b25zKHNob3J0LCBpLCBqKTtcbiAgICB0dXJuT25Ub29sdGlwcyhcInNjbV9cIitzaG9ydCwgaWQpO1xuICAgIG1ha2VTQ01FZGl0YWJsZShzaG9ydCwgaSwgaik7XG4gICAgcmV0dXJuIGZhbHNlO1xufVxuXG4vKipcbiAqIFVuZG8gRWRpdFxuICpcbiAqIFJldHVybnMgdGhlIGh0bWwgZm9yIHRoZSAoc2hvcnQsIGkpIHBhbmVsIGJhY2sgdG8gaXRzIG9yaWdpbmFsIHN0YXRlLCBpLmUuIHJlbW92ZXNcbiAqIHRoZSBlZGl0LiAgQmVmb3JlIGRvaW5nIHRoaXMsIHRvIGNsZWFuIHVwIHRoZSBwYWdlLCBpdCBmaXJzdCBtYWtlcyB0aGUgZWRpdGVkIHZlcnNpb25cbiAqIHVuZWRpdGFibGUuXG4gKlxuICogQHBhcmFtIHN0cmluZyBzaG9ydCBUaGUgc2hvcnQgbmFtZSBvZiB0aGUgZGF0YSBvYmplY3QsIHN1Y2ggYXMgXCJuYW1lRW50cnlcIiBvciBcIm9jY3VwYXRpb25cIlxuICogQHBhcmFtIHN0cmluZ3xpbnQgaSBUaGUgaW5kZXggd2l0aGluIHRoZSBlZGl0IHBhZ2Ugb2YgdGhlIG9iamVjdC5cbiAqL1xuZnVuY3Rpb24gdW5kb0VkaXQoc2hvcnQsIGkpIHtcblx0bWFrZVVuZWRpdGFibGUoc2hvcnQsIGkpO1xuXG5cdC8vIHJlc3RvcmUgdGhlIG9sZCBjb250ZW50XG5cdCQoXCIjXCIgKyBzaG9ydCArIFwiX2RhdGFwYXJ0X1wiICsgaSkucmVwbGFjZVdpdGgodW5kb1NldFtzaG9ydCtcIi1cIitpXSk7XG4gICAgdHVybk9uVG9vbHRpcHMoc2hvcnQsaSk7XG4gICAgJChcIiNcIiArIHNob3J0ICsgXCJfZGF0YXBhcnRfXCIgKyBpICsgXCIgaW5wdXRbdHlwZT0nY2hlY2tib3gnXVwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgb2JqID0gJCh0aGlzKTtcbiAgICAgICAgb2JqLmJvb3RzdHJhcFRvZ2dsZSgpO1xuICAgIH0pO1xufVxuXG4vKipcbiAqIFVuZG8gU0NNIEVkaXRcbiAqXG4gKiBUYWtlcyBhbiBTQ00gR1VJIG9iamVjdCAoaikgZm9yIGEgZGF0YSBvYmplY3QgKHNob3J0LCBpKSBhbmQgcmV0dXJucyBpdCBiYWNrIHRvIGl0c1xuICogb3JpZ2luYWwgc3RhdGUgKHJlbW92aW5nIHRoZSBlZGl0KS4gIEJlZm9yZSBkb2luZyB0aGlzLCB0byBjbGVhbiB1cCB0aGUgcGFnZSBhbmQgSlMsIGl0IGZpcnN0XG4gKiBtYWtlcyB0aGUgZWRpdGVkIHZlcnNpb24gdW5lZGl0YWJsZSwgdGhlbiByZXBsYWNlcyB0aGUgSFRNTC5cbiAqXG4gKiBAcGFyYW0gc3RyaW5nIHNob3J0IFRoZSBzaG9ydCBuYW1lIG9mIHRoZSBkYXRhIG9iamVjdCwgc3VjaCBhcyBcIm5hbWVFbnRyeVwiIG9yIFwib2NjdXBhdGlvblwiXG4gKiBAcGFyYW0gc3RyaW5nfGludCBpIFRoZSBpbmRleCB3aXRoaW4gdGhlIGVkaXQgcGFnZSBvZiB0aGUgb2JqZWN0LlxuICogQHBhcmFtIHN0cmluZ3xpbnQgaiBUaGUgaW5kZXggd2l0aGluIHRoZSBkYXRhIG9iamVjdCBTQ00gbGlzdCBvbiB0aGUgZWRpdCBwYWdlIG9mIHRoZSBTQ00gb2JqZWN0LlxuICovXG5mdW5jdGlvbiB1bmRvU0NNRWRpdChzaG9ydCwgaSwgaikge1xuXHR2YXIgaWQgPSBqICsgXCJfXCIgKyBpO1xuXHRtYWtlU0NNVW5lZGl0YWJsZShzaG9ydCwgaSwgaik7XG5cblx0Ly8gcmVzdG9yZSB0aGUgb2xkIGNvbnRlbnRcblx0JChcIiNzY21fXCIgKyBzaG9ydCArIFwiX2RhdGFwYXJ0X1wiICsgaWQpLnJlcGxhY2VXaXRoKHVuZG9TZXRbXCJzY21fXCIrc2hvcnQrXCItXCIraWRdKTtcbiAgICB0dXJuT25Ub29sdGlwcyhcInNjbV9cIitzaG9ydCwgaWQpO1xufVxuXG4vKipcbiAqIENoYW5nZSB2b2NhYnVsYXJ5IGlucHV0IGRpdnMgdG8gc2VsZWN0c1xuICpcbiAqIENoYW5nZXMgYWxsIGRpdidzIHdpdGggaWQgXCJzZWxlY3RfXCIgZm9yIGEgZ2l2ZW4gZGF0YSBvYmplY3QgKHNob3J0TmFtZSwgaWRTdHIpIGZyb20gYSBsaXN0IG9mXG4gKiBpbnB1dHMgZGVmaW5pbmcgdGhlIHBhcmFtZXRlcnMgdG8gYSBzZWxlY3QgKHZpZXcgbW9kZSkgdG8gYSBzZWxlY3QgYm94IChlZGl0IG1vZGUpLiAgSXQgdGhlblxuICogY2FsbHMgdGhlIHNlbGVjdDIgZnVuY3Rpb24gdG8gcmVwbGFjZSB0aGUgc2VsZWN0IHdpdGggYW4gQUpBWC1jb21wYXRpYmxlIHNlbGVjdC5cbiAqXG4gKiBUaGlzIGZ1bmN0aW9uIGhhbmRsZXMgVk9DQUJVTEFSWSBzZWxlY3QgYm94ZXMgT05MWS5cbiAqXG4gKiBOb3RlOiBpZFN0ciBtdXN0IG5vdCBoYXZlIHRoZSBcIl9cIiBwcmUtYXBwZW5kZWRcbiAqXG4gKiBAcGFyYW0gc3RyaW5nIHNob3J0TmFtZSBUaGUgc2hvcnQgbmFtZSBvZiB0aGUgZGF0YSBvYmplY3QsIHN1Y2ggYXMgXCJuYW1lRW50cnlcIiBvciBcIm9jY3VwYXRpb25cIlxuICogQHBhcmFtIHN0cmluZ3xpbnQgaWRTdHIgVGhlIGluZGV4IHdpdGhpbiB0aGUgZWRpdCBwYWdlIG9mIHRoZSBvYmplY3QuXG4gKi9cbmZ1bmN0aW9uIHRleHRUb1NlbGVjdChzaG9ydE5hbWUsIGlkU3RyKSB7XG4gICAgJChcIiNcIitzaG9ydE5hbWUrXCJfZGF0YXBhcnRfXCIgKyBpZFN0ciArIFwiIGRpdltpZF49J3NlbGVjdF9cIitzaG9ydE5hbWUrXCInXVwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY29udCA9ICQodGhpcyk7XG4gICAgICAgIGlmKGNvbnQuYXR0cignaWQnKS5lbmRzV2l0aChcIl9cIitpZFN0cikgJiYgIWNvbnQuYXR0cignaWQnKS5lbmRzV2l0aChcIlpaXCIpKSB7XG4gICAgICAgICAgICAvLyByZW1vdmUgdGhlIHNob3J0IG5hbWUgYW5kIFwic2VsZWN0X1wiIGZyb20gdGhlIHN0cmluZyB3ZSdyZSBwYXJzaW5nXG4gICAgICAgICAgICB2YXIgZGl2U3RyID0gY29udC5hdHRyKCdpZCcpLnJlcGxhY2UoXCJzZWxlY3RfXCIsIFwiXCIpLnJlcGxhY2Uoc2hvcnROYW1lICsgXCJfXCIsIFwiXCIpO1xuICAgICAgICAgICAgLy8gcmVtb3ZlIHRoZSBpZHN0ciB0byByZWNlaXZlIHRoZSBuYW1lIG9mIHRoaXMgZWxlbWVudFxuICAgICAgICAgICAgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cChcIlxcX1wiK2lkU3RyK1wiJFwiLCBcImdcIik7XG4gICAgICAgICAgICB2YXIgbmFtZSA9IGRpdlN0ci5yZXBsYWNlKHJlZ2V4LCBcIlwiKTtcbiAgICAgICAgICAgIHZhciBpZCA9ICQoXCIjXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfaWRfXCIraWRTdHIpLnZhbCgpO1xuICAgICAgICAgICAgdmFyIHRlcm0gPSAkKFwiI1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX3Rlcm1fXCIraWRTdHIpLnZhbCgpO1xuICAgICAgICAgICAgdmFyIHZvY2FidHlwZSA9ICQoXCIjXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfdm9jYWJ0eXBlX1wiK2lkU3RyKS52YWwoKTtcbiAgICAgICAgICAgIHZhciBtaW5sZW5ndGggPSAkKFwiI1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX21pbmxlbmd0aF9cIitpZFN0cikudmFsKCk7XG4gICAgICAgICAgICB2YXIgcGxhY2Vob2xkZXIgPSBcIlNlbGVjdFwiO1xuICAgICAgICAgICAgaWYgKCQoXCIjXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfcGxhY2Vob2xkZXJfXCIraWRTdHIpLmV4aXN0cygpKSB7XG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXIgPSAkKFwiI1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX3BsYWNlaG9sZGVyX1wiK2lkU3RyKS52YWwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBvcHRpb25zID0gXCJcIjtcbiAgICAgICAgICAgIGlmICgkKFwiI1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX2RlZmF1bHRPcHRpb25zX1wiK2lkU3RyKS5leGlzdHMoKSkge1xuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSAkKFwiI1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX2RlZmF1bHRPcHRpb25zX1wiK2lkU3RyKS52YWwoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29udC5odG1sKFwiPHNlbGVjdCBpZD0nXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfaWRfXCIraWRTdHIrXCInIG5hbWU9J1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX2lkX1wiK2lkU3RyK1wiJyBjbGFzcz0nZm9ybS1jb250cm9sJyBkYXRhLXBsYWNlaG9sZGVyPSdcIitwbGFjZWhvbGRlcitcIic+XCIrXG4gICAgICAgICAgICAgICAgICAgIFwiPG9wdGlvbj48L29wdGlvbj5cIitcbiAgICAgICAgICAgICAgICAgICAgXCI8b3B0aW9uIHZhbHVlPVxcXCJcIitpZCtcIlxcXCIgc2VsZWN0ZWQ+XCIrdGVybStcIjwvb3B0aW9uPlwiKyBvcHRpb25zICtcbiAgICAgICAgICAgICAgICAgICAgXCI8L3NlbGVjdD5cIitcbiAgICAgICAgICAgICAgICAgICAgXCI8aW5wdXQgdHlwZT1cXFwiaGlkZGVuXFxcIiBpZD1cXFwiXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfdm9jYWJ0eXBlX1wiK2lkU3RyK1wiXFxcIiBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWU9XFxcIlwiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX3ZvY2FidHlwZV9cIitpZFN0citcIlxcXCIgdmFsdWU9XFxcIlwiK3ZvY2FidHlwZStcIlxcXCIvPlwiICtcbiAgICAgICAgICAgICAgICAgICAgXCI8aW5wdXQgdHlwZT1cXFwiaGlkZGVuXFxcIiBpZD1cXFwiXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfbWlubGVuZ3RoX1wiK2lkU3RyK1wiXFxcIiBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWU9XFxcIlwiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX21pbmxlbmd0aF9cIitpZFN0citcIlxcXCIgdmFsdWU9XFxcIlwiK21pbmxlbmd0aCtcIlxcXCIvPlwiKTtcblxuICAgICAgICAgICAgaWYgKG5hbWUgPT0gXCJjaXRhdGlvblwiKVxuICAgICAgICAgICAgICAgIHNjbV9zb3VyY2Vfc2VsZWN0X3JlcGxhY2UoJChcIiNcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9pZF9cIitpZFN0ciksIFwiX1wiK2lkU3RyKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB2b2NhYl9zZWxlY3RfcmVwbGFjZSgkKFwiI1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX2lkX1wiK2lkU3RyKSwgXCJfXCIraWRTdHIsIHZvY2FidHlwZSwgbWlubGVuZ3RoKTtcblxuICAgICAgICB9XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIHRleHRUb0NoZWNrYm94KHNob3J0TmFtZSwgaWRTdHIpIHtcbiAgICAkKFwiI1wiK3Nob3J0TmFtZStcIl9kYXRhcGFydF9cIiArIGlkU3RyICsgXCIgZGl2W2lkXj0nY2hlY2tib3hfXCIrc2hvcnROYW1lK1wiJ11cIikuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGNvbnQgPSAkKHRoaXMpO1xuICAgICAgICBpZihjb250LmF0dHIoJ2lkJykuZW5kc1dpdGgoXCJfXCIraWRTdHIpICYmICFjb250LmF0dHIoJ2lkJykuZW5kc1dpdGgoXCJaWlwiKSkge1xuICAgICAgICAgICAgLy8gcmVtb3ZlIHRoZSBzaG9ydCBuYW1lIGFuZCBcInNlbGVjdF9cIiBmcm9tIHRoZSBzdHJpbmcgd2UncmUgcGFyc2luZ1xuICAgICAgICAgICAgdmFyIGRpdlN0ciA9IGNvbnQuYXR0cignaWQnKS5yZXBsYWNlKC9eY2hlY2tib3hfLywgXCJcIikucmVwbGFjZShzaG9ydE5hbWUgKyBcIl9cIiwgXCJcIik7XG4gICAgICAgICAgICAvLyByZW1vdmUgdGhlIGlkc3RyIHRvIHJlY2VpdmUgdGhlIG5hbWUgb2YgdGhpcyBlbGVtZW50XG4gICAgICAgICAgICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKFwiXFxfXCIraWRTdHIrXCIkXCIsIFwiZ1wiKTtcbiAgICAgICAgICAgIHZhciBuYW1lID0gZGl2U3RyLnJlcGxhY2UocmVnZXgsIFwiXCIpO1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gJChcIiNcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9cIitpZFN0cikudmFsKCk7XG4gICAgICAgICAgICB2YXIgcGxhY2Vob2xkZXJPbiA9IFwiXCI7XG4gICAgICAgICAgICBpZiAoJChcIiNcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9wbGFjZWhvbGRlck9uX1wiK2lkU3RyKS5leGlzdHMoKSkge1xuICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyT24gPSAkKFwiI1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX3BsYWNlaG9sZGVyT25fXCIraWRTdHIpLnZhbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHBsYWNlaG9sZGVyT2ZmID0gXCJcIjtcbiAgICAgICAgICAgIGlmICgkKFwiI1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX3BsYWNlaG9sZGVyT2ZmX1wiK2lkU3RyKS5leGlzdHMoKSkge1xuICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyT2ZmID0gJChcIiNcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9wbGFjZWhvbGRlck9mZl9cIitpZFN0cikudmFsKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBodG1sID0gXCI8aW5wdXQgaWQ9J1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX1wiK2lkU3RyK1wiJyBuYW1lPSdcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9cIitcbiAgICAgICAgICAgICAgICAgICAgaWRTdHIrXCInIGNsYXNzPSdmb3JtLWNvbnRyb2wnIHR5cGU9J2NoZWNrYm94JyB2YWx1ZT1cXFwiY2hlY2tlZFxcXCJcIitcbiAgICAgICAgICAgICAgICAgICAgXCJkYXRhLW9uPVxcXCJcIitwbGFjZWhvbGRlck9uK1wiXFxcIiBkYXRhLW9mZj1cXFwiXCIrcGxhY2Vob2xkZXJPZmYrXCJcXFwiXCI7XG4gICAgICAgICAgICBpZiAodmFsdWUgPT0gJ2NoZWNrZWQnKVxuICAgICAgICAgICAgICAgIGh0bWwgKz0gXCIgY2hlY2tlZFwiO1xuICAgICAgICAgICAgaHRtbCArPSBcIi8+XCI7XG4gICAgICAgICAgICBpZiAocGxhY2Vob2xkZXJPbiAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgaHRtbCArPSBcIjxpbnB1dCB0eXBlPVxcXCJoaWRkZW5cXFwiIGlkPVxcXCJcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9wbGFjZWhvbGRlck9uX1wiK2lkU3RyK1wiXFxcIiBcIiArXG4gICAgICAgICAgICAgICAgXCJ2YWx1ZT1cXFwiXCIrcGxhY2Vob2xkZXJPbitcIlxcXCIvPlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHBsYWNlaG9sZGVyT2ZmICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICBodG1sICs9IFwiPGlucHV0IHR5cGU9XFxcImhpZGRlblxcXCIgaWQ9XFxcIlwiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX3BsYWNlaG9sZGVyT2ZmX1wiK2lkU3RyK1wiXFxcIiBcIiArXG4gICAgICAgICAgICAgICAgXCJ2YWx1ZT1cXFwiXCIrcGxhY2Vob2xkZXJPZmYrXCJcXFwiLz5cIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29udC5odG1sKGh0bWwpO1xuICAgICAgICAgICAgJChcIiNcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9cIitpZFN0cikuYm9vdHN0cmFwVG9nZ2xlKCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuXG59XG5cblxuZnVuY3Rpb24gY2hlY2tib3hUb1RleHQoc2hvcnROYW1lLCBpZFN0cikge1xuICAgICQoXCIjXCIrc2hvcnROYW1lK1wiX2RhdGFwYXJ0X1wiICsgaWRTdHIgKyBcIiBkaXZbaWRePSdjaGVja2JveF9cIitzaG9ydE5hbWUrXCInXVwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY29udCA9ICQodGhpcyk7XG4gICAgICAgIGlmKGNvbnQuYXR0cignaWQnKS5lbmRzV2l0aChcIl9cIitpZFN0cikgJiYgIWNvbnQuYXR0cignaWQnKS5lbmRzV2l0aChcIlpaXCIpKSB7XG4gICAgICAgICAgICAvLyByZW1vdmUgdGhlIHNob3J0IG5hbWUgYW5kIFwic2VsZWN0X1wiIGZyb20gdGhlIHN0cmluZyB3ZSdyZSBwYXJzaW5nXG4gICAgICAgICAgICB2YXIgZGl2U3RyID0gY29udC5hdHRyKCdpZCcpLnJlcGxhY2UoL15jaGVja2JveF8vLCBcIlwiKS5yZXBsYWNlKHNob3J0TmFtZSArIFwiX1wiLCBcIlwiKTtcbiAgICAgICAgICAgIC8vIHJlbW92ZSB0aGUgaWRzdHIgdG8gcmVjZWl2ZSB0aGUgbmFtZSBvZiB0aGlzIGVsZW1lbnRcbiAgICAgICAgICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAoXCJcXF9cIitpZFN0citcIiRcIiwgXCJnXCIpO1xuICAgICAgICAgICAgdmFyIG5hbWUgPSBkaXZTdHIucmVwbGFjZShyZWdleCwgXCJcIik7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSAkKFwiI1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX1wiK2lkU3RyKS52YWwoKTtcbiAgICAgICAgICAgIHZhciBjaGVja2VkID0gJChcIiNcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9cIitpZFN0cikucHJvcCgnY2hlY2tlZCcpO1xuICAgICAgICAgICAgdmFyIHBsYWNlaG9sZGVyT24gPSBcIlwiO1xuICAgICAgICAgICAgaWYgKCQoXCIjXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfcGxhY2Vob2xkZXJPbl9cIitpZFN0cikuZXhpc3RzKCkpIHtcbiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlck9uID0gJChcIiNcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9wbGFjZWhvbGRlck9uX1wiK2lkU3RyKS52YWwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBwbGFjZWhvbGRlck9mZiA9IFwiXCI7XG4gICAgICAgICAgICBpZiAoJChcIiNcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9wbGFjZWhvbGRlck9mZl9cIitpZFN0cikuZXhpc3RzKCkpIHtcbiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlck9mZiA9ICQoXCIjXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfcGxhY2Vob2xkZXJPZmZfXCIraWRTdHIpLnZhbCgpO1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIHZhciBodG1sID0gXCI8aW5wdXQgaWQ9J1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX1wiK2lkU3RyK1wiJyBuYW1lPSdcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9cIitcbiAgICAgICAgICAgICAgICAgICAgaWRTdHIrXCInIHR5cGU9J2hpZGRlbicgdmFsdWU9XFxcIlwiO1xuICAgICAgICAgICAgaWYgKGNoZWNrZWQpXG4gICAgICAgICAgICAgICAgaHRtbCArPSBcImNoZWNrZWRcIjtcbiAgICAgICAgICAgIGh0bWwgKz1cIlxcXCIvPlwiO1xuXG4gICAgICAgICAgICBodG1sICs9IFwiPHAgY2xhc3M9J2Zvcm0tY29udHJvbC1zdGF0aWMnPlwiO1xuICAgICAgICAgICAgaWYgKGNoZWNrZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAocGxhY2Vob2xkZXJPbiAhPSBcIlwiKVxuICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gcGxhY2Vob2xkZXJPbjtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgaHRtbCArPSB2YWx1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHBsYWNlaG9sZGVyT2ZmICE9IFwiXCIpXG4gICAgICAgICAgICAgICAgICAgaHRtbCArPSBwbGFjZWhvbGRlck9mZjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGh0bWwgKz0gXCI8L3A+XCI7XG4gICAgICAgICAgICBpZiAocGxhY2Vob2xkZXJPbiAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgaHRtbCArPSBcIjxpbnB1dCB0eXBlPVxcXCJoaWRkZW5cXFwiIGlkPVxcXCJcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9wbGFjZWhvbGRlck9uX1wiK2lkU3RyK1wiXFxcIiBcIiArXG4gICAgICAgICAgICAgICAgXCJ2YWx1ZT1cXFwiXCIrcGxhY2Vob2xkZXJPbitcIlxcXCIvPlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHBsYWNlaG9sZGVyT2ZmICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICBodG1sICs9IFwiPGlucHV0IHR5cGU9XFxcImhpZGRlblxcXCIgaWQ9XFxcIlwiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX3BsYWNlaG9sZGVyT2ZmX1wiK2lkU3RyK1wiXFxcIiBcIiArXG4gICAgICAgICAgICAgICAgXCJ2YWx1ZT1cXFwiXCIrcGxhY2Vob2xkZXJPZmYrXCJcXFwiLz5cIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJChcIiNcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9cIitpZFN0cikuYm9vdHN0cmFwVG9nZ2xlKFwiZGVzdHJveVwiKTtcbiAgICAgICAgICAgIGNvbnQuaHRtbChodG1sKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG5cbn1cblxuZnVuY3Rpb24gdGV4dFRvSW5wdXQoc2hvcnROYW1lLCBpZFN0cikge1xuICAgICQoXCIjXCIrc2hvcnROYW1lK1wiX2RhdGFwYXJ0X1wiICsgaWRTdHIgKyBcIiBkaXZbaWRePSd0ZXh0X1wiK3Nob3J0TmFtZStcIiddXCIpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjb250ID0gJCh0aGlzKTtcbiAgICAgICAgaWYoY29udC5hdHRyKCdpZCcpLmVuZHNXaXRoKFwiX1wiK2lkU3RyKSAmJiAhY29udC5hdHRyKCdpZCcpLmVuZHNXaXRoKFwiWlpcIikpIHtcbiAgICAgICAgICAgIC8vIHJlbW92ZSB0aGUgc2hvcnQgbmFtZSBhbmQgXCJzZWxlY3RfXCIgZnJvbSB0aGUgc3RyaW5nIHdlJ3JlIHBhcnNpbmdcbiAgICAgICAgICAgIHZhciBkaXZTdHIgPSBjb250LmF0dHIoJ2lkJykucmVwbGFjZSgvXnRleHRfLywgXCJcIikucmVwbGFjZShzaG9ydE5hbWUgKyBcIl9cIiwgXCJcIik7XG4gICAgICAgICAgICAvLyByZW1vdmUgdGhlIGlkc3RyIHRvIHJlY2VpdmUgdGhlIG5hbWUgb2YgdGhpcyBlbGVtZW50XG4gICAgICAgICAgICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKFwiXFxfXCIraWRTdHIrXCIkXCIsIFwiZ1wiKTtcbiAgICAgICAgICAgIHZhciBuYW1lID0gZGl2U3RyLnJlcGxhY2UocmVnZXgsIFwiXCIpO1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gJChcIiNcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9cIitpZFN0cikudmFsKCk7XG4gICAgICAgICAgICB2YXIgc2l6ZSA9IDA7XG4gICAgICAgICAgICB2YXIgc2l6ZVN0ciA9IFwiXCI7XG4gICAgICAgICAgICBpZiAoJChcIiNcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9zaXplX1wiK2lkU3RyKS5leGlzdHMoKSkge1xuICAgICAgICAgICAgICAgIHNpemUgPSBwYXJzZUludCgkKFwiI1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX3NpemVfXCIraWRTdHIpLnZhbCgpKTtcbiAgICAgICAgICAgICAgICBzaXplU3RyID0gXCIgc2l6ZT0nXCIgKyBzaXplICtcIicgXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcGxhY2Vob2xkZXIgPSBcIlwiO1xuICAgICAgICAgICAgaWYgKCQoXCIjXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfcGxhY2Vob2xkZXJfXCIraWRTdHIpLmV4aXN0cygpKSB7XG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXIgPSAkKFwiI1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX3BsYWNlaG9sZGVyX1wiK2lkU3RyKS52YWwoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIG9uS2V5VXAgPSBcIlwiO1xuICAgICAgICAgICAgaWYgKCQoXCIjXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfb25LZXlVcF9cIitpZFN0cikuZXhpc3RzKCkpIHtcbiAgICAgICAgICAgICAgICBvbktleVVwID0gJChcIiNcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9vbktleVVwX1wiK2lkU3RyKS52YWwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBvbktleVVwU3RyID0gXCJcIjtcbiAgICAgICAgICAgIGlmIChvbktleVVwICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICBvbktleVVwU3RyID0gXCIgb25LZXlVcD0nXCIrb25LZXlVcCtcIicgXCI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBodG1sID0gXCI8aW5wdXQgaWQ9J1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX1wiK2lkU3RyK1wiJyBuYW1lPSdcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9cIitcbiAgICAgICAgICAgICAgICAgICAgaWRTdHIrXCInIGNsYXNzPSdmb3JtLWNvbnRyb2wnIHR5cGU9J3RleHQnIHZhbHVlPVxcXCJcIisgdmFsdWUgK1wiXFxcIlwiK3NpemVTdHIgKyBvbktleVVwU3RyICtcbiAgICAgICAgICAgICAgICAgICAgXCJwbGFjZWhvbGRlcj1cXFwiXCIrcGxhY2Vob2xkZXIrXCJcXFwiLz5cIjtcbiAgICAgICAgICAgIGlmIChzaXplICE9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgaHRtbCArPSBcIjxpbnB1dCB0eXBlPVxcXCJoaWRkZW5cXFwiIGlkPVxcXCJcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9zaXplX1wiK2lkU3RyK1wiXFxcIiBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcInZhbHVlPVxcXCJcIitzaXplK1wiXFxcIi8+XCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocGxhY2Vob2xkZXIgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgIGh0bWwgKz0gXCI8aW5wdXQgdHlwZT1cXFwiaGlkZGVuXFxcIiBpZD1cXFwiXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfcGxhY2Vob2xkZXJfXCIraWRTdHIrXCJcXFwiIFwiICtcbiAgICAgICAgICAgICAgICBcInZhbHVlPVxcXCJcIitwbGFjZWhvbGRlcitcIlxcXCIvPlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9uS2V5VXAgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgIGh0bWwgKz0gXCI8aW5wdXQgdHlwZT1cXFwiaGlkZGVuXFxcIiBpZD1cXFwiXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfb25LZXlVcF9cIitpZFN0citcIlxcXCIgXCIgK1xuICAgICAgICAgICAgICAgIFwidmFsdWU9XFxcIlwiK29uS2V5VXArXCJcXFwiLz5cIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29udC5odG1sKGh0bWwpO1xuICAgICAgICB9XG4gICAgfSk7XG5cblxufVxuXG5cbmZ1bmN0aW9uIGlucHV0VG9UZXh0KHNob3J0TmFtZSwgaWRTdHIpIHtcbiAgICAkKFwiI1wiK3Nob3J0TmFtZStcIl9kYXRhcGFydF9cIiArIGlkU3RyICsgXCIgZGl2W2lkXj0ndGV4dF9cIitzaG9ydE5hbWUrXCInXVwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY29udCA9ICQodGhpcyk7XG4gICAgICAgIGlmKGNvbnQuYXR0cignaWQnKS5lbmRzV2l0aChcIl9cIitpZFN0cikgJiYgIWNvbnQuYXR0cignaWQnKS5lbmRzV2l0aChcIlpaXCIpKSB7XG4gICAgICAgICAgICAvLyByZW1vdmUgdGhlIHNob3J0IG5hbWUgYW5kIFwic2VsZWN0X1wiIGZyb20gdGhlIHN0cmluZyB3ZSdyZSBwYXJzaW5nXG4gICAgICAgICAgICB2YXIgZGl2U3RyID0gY29udC5hdHRyKCdpZCcpLnJlcGxhY2UoL150ZXh0Xy8sIFwiXCIpLnJlcGxhY2Uoc2hvcnROYW1lICsgXCJfXCIsIFwiXCIpO1xuICAgICAgICAgICAgLy8gcmVtb3ZlIHRoZSBpZHN0ciB0byByZWNlaXZlIHRoZSBuYW1lIG9mIHRoaXMgZWxlbWVudFxuICAgICAgICAgICAgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cChcIlxcX1wiK2lkU3RyK1wiJFwiLCBcImdcIik7XG4gICAgICAgICAgICB2YXIgbmFtZSA9IGRpdlN0ci5yZXBsYWNlKHJlZ2V4LCBcIlwiKTtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9ICQoXCIjXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfXCIraWRTdHIpLnZhbCgpO1xuICAgICAgICAgICAgdmFyIHNpemUgPSAwO1xuICAgICAgICAgICAgaWYgKCQoXCIjXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfc2l6ZV9cIitpZFN0cikuZXhpc3RzKCkpIHtcbiAgICAgICAgICAgICAgICBzaXplID0gcGFyc2VJbnQoJChcIiNcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9zaXplX1wiK2lkU3RyKS52YWwoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcGxhY2Vob2xkZXIgPSBcIlwiO1xuICAgICAgICAgICAgaWYgKCQoXCIjXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfcGxhY2Vob2xkZXJfXCIraWRTdHIpLmV4aXN0cygpKSB7XG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXIgPSAkKFwiI1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX3BsYWNlaG9sZGVyX1wiK2lkU3RyKS52YWwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBvbktleVVwID0gXCJcIjtcbiAgICAgICAgICAgIGlmICgkKFwiI1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX29uS2V5VXBfXCIraWRTdHIpLmV4aXN0cygpKSB7XG4gICAgICAgICAgICAgICAgb25LZXlVcCA9ICQoXCIjXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfb25LZXlVcF9cIitpZFN0cikudmFsKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBodG1sID0gXCI8aW5wdXQgaWQ9J1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX1wiK2lkU3RyK1wiJyBuYW1lPSdcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9cIitcbiAgICAgICAgICAgICAgICAgICAgaWRTdHIrXCInIHR5cGU9J2hpZGRlbicgdmFsdWU9XFxcIlwiKyB2YWx1ZSArXCJcXFwiLz5cIjtcbiAgICAgICAgICAgIGh0bWwgKz0gXCI8cCBjbGFzcz0nZm9ybS1jb250cm9sLXN0YXRpYyc+XCIgKyB2YWx1ZSArIFwiPC9wPlwiO1xuICAgICAgICAgICAgaWYgKHNpemUgIT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBodG1sICs9IFwiPGlucHV0IHR5cGU9XFxcImhpZGRlblxcXCIgaWQ9XFxcIlwiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX3NpemVfXCIraWRTdHIrXCJcXFwiIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidmFsdWU9XFxcIlwiK3NpemUrXCJcXFwiLz5cIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwbGFjZWhvbGRlciAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgaHRtbCArPSBcIjxpbnB1dCB0eXBlPVxcXCJoaWRkZW5cXFwiIGlkPVxcXCJcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9wbGFjZWhvbGRlcl9cIitpZFN0citcIlxcXCIgXCIgK1xuICAgICAgICAgICAgICAgIFwidmFsdWU9XFxcIlwiK3BsYWNlaG9sZGVyK1wiXFxcIi8+XCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAob25LZXlVcCAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgaHRtbCArPSBcIjxpbnB1dCB0eXBlPVxcXCJoaWRkZW5cXFwiIGlkPVxcXCJcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9vbktleVVwX1wiK2lkU3RyK1wiXFxcIiBcIiArXG4gICAgICAgICAgICAgICAgXCJ2YWx1ZT1cXFwiXCIrb25LZXlVcCtcIlxcXCIvPlwiO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb250Lmh0bWwoaHRtbCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuXG59XG5cblxuXG5mdW5jdGlvbiB0ZXh0VG9UZXh0QXJlYShzaG9ydE5hbWUsIGlkU3RyKSB7XG4gICAgJChcIiNcIitzaG9ydE5hbWUrXCJfZGF0YXBhcnRfXCIgKyBpZFN0ciArIFwiIGRpdltpZF49J3RleHRhcmVhX1wiK3Nob3J0TmFtZStcIiddXCIpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjb250ID0gJCh0aGlzKTtcbiAgICAgICAgaWYoY29udC5hdHRyKCdpZCcpLmVuZHNXaXRoKFwiX1wiK2lkU3RyKSAmJiAhY29udC5hdHRyKCdpZCcpLmVuZHNXaXRoKFwiWlpcIikpIHtcbiAgICAgICAgICAgIC8vIHJlbW92ZSB0aGUgc2hvcnQgbmFtZSBhbmQgXCJzZWxlY3RfXCIgZnJvbSB0aGUgc3RyaW5nIHdlJ3JlIHBhcnNpbmdcbiAgICAgICAgICAgIHZhciBkaXZTdHIgPSBjb250LmF0dHIoJ2lkJykucmVwbGFjZSgvXnRleHRhcmVhXy8sIFwiXCIpLnJlcGxhY2Uoc2hvcnROYW1lICsgXCJfXCIsIFwiXCIpO1xuICAgICAgICAgICAgLy8gcmVtb3ZlIHRoZSBpZHN0ciB0byByZWNlaXZlIHRoZSBuYW1lIG9mIHRoaXMgZWxlbWVudFxuICAgICAgICAgICAgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cChcIlxcX1wiK2lkU3RyK1wiJFwiLCBcImdcIik7XG4gICAgICAgICAgICB2YXIgbmFtZSA9IGRpdlN0ci5yZXBsYWNlKHJlZ2V4LCBcIlwiKTtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9ICQoXCIjXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfXCIraWRTdHIpLnZhbCgpO1xuXG4gICAgICAgICAgICB2YXIgaHRtbCA9IFwiPHRleHRhcmVhIGlkPSdcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9cIitpZFN0citcIicgbmFtZT0nXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfXCIrXG4gICAgICAgICAgICAgICAgICAgIGlkU3RyK1wiJyBjbGFzcz0nZm9ybS1jb250cm9sJyBzdHlsZT0nd2lkdGg6IDEwMCU7Jz5cIisgdmFsdWUgK1wiPC90ZXh0YXJlYT5cIjtcblxuICAgICAgICAgICAgY29udC5odG1sKGh0bWwpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5cblxuZnVuY3Rpb24gdGV4dEFyZWFUb1RleHQoc2hvcnROYW1lLCBpZFN0cikge1xuICAgICQoXCIjXCIrc2hvcnROYW1lK1wiX2RhdGFwYXJ0X1wiICsgaWRTdHIgKyBcIiBkaXZbaWRePSd0ZXh0YXJlYV9cIitzaG9ydE5hbWUrXCInXVwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY29udCA9ICQodGhpcyk7XG4gICAgICAgIGlmKGNvbnQuYXR0cignaWQnKS5lbmRzV2l0aChcIl9cIitpZFN0cikgJiYgIWNvbnQuYXR0cignaWQnKS5lbmRzV2l0aChcIlpaXCIpKSB7XG4gICAgICAgICAgICAvLyByZW1vdmUgdGhlIHNob3J0IG5hbWUgYW5kIFwic2VsZWN0X1wiIGZyb20gdGhlIHN0cmluZyB3ZSdyZSBwYXJzaW5nXG4gICAgICAgICAgICB2YXIgZGl2U3RyID0gY29udC5hdHRyKCdpZCcpLnJlcGxhY2UoL150ZXh0YXJlYV8vLCBcIlwiKS5yZXBsYWNlKHNob3J0TmFtZSArIFwiX1wiLCBcIlwiKTtcbiAgICAgICAgICAgIC8vIHJlbW92ZSB0aGUgaWRzdHIgdG8gcmVjZWl2ZSB0aGUgbmFtZSBvZiB0aGlzIGVsZW1lbnRcbiAgICAgICAgICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAoXCJcXF9cIitpZFN0citcIiRcIiwgXCJnXCIpO1xuICAgICAgICAgICAgdmFyIG5hbWUgPSBkaXZTdHIucmVwbGFjZShyZWdleCwgXCJcIik7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSAkKFwiI1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX1wiK2lkU3RyKS52YWwoKTtcblxuICAgICAgICAgICAgLy92YXIgaHRtbCA9IFwiPGlucHV0IHR5cGU9J2hpZGRlbicgaWQ9J1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX1wiK2lkU3RyK1wiJyBuYW1lPSdcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9cIitcbiAgICAgICAgICAgIC8vICAgICAgICBpZFN0citcIicgdmFsdWU9XFxcIlwiKyB2YWx1ZSArXCJcXFwiLz5cIjtcbiAgICAgICAgICAgIHZhciBodG1sID0gXCI8dGV4dGFyZWEgc3R5bGU9J2Rpc3BsYXk6bm9uZTsnIGlkPSdcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9cIitpZFN0citcIicgbmFtZT0nXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfXCIrXG4gICAgICAgICAgICAgICAgICAgIGlkU3RyK1wiJz5cIisgdmFsdWUgK1wiPC90ZXh0YXJlYT5cIjtcbiAgICAgICAgICAgIGh0bWwgKz0gXCI8ZGl2IGNsYXNzPSdmb3JtLWNvbnRyb2wtc3RhdGljJz5cIiArIHZhbHVlICsgXCI8L2Rpdj5cIjtcblxuICAgICAgICAgICAgY29udC5odG1sKGh0bWwpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5cbi8qKlxuICogQ2hhbmdlIHZvY2FidWxhcnkgc2VsZWN0cyB0byBkaXZzIG9mIGlucHV0c1xuICpcbiAqIENoYW5nZXMgYWxsIGRpdidzIHdpdGggaWQgXCJzZWxlY3RfXCIgZm9yIGEgZ2l2ZW4gZGF0YSBvYmplY3QgKHNob3J0TmFtZSwgaWRTdHIpIGZyb20gYSBzZWxlY3RcbiAqIGJveCAoZWRpdCBtb2RlKSB0byBhIGxpc3Qgb2YgaW5wdXRzIGRlZmluaW5nIHRoZSBwYXJhbWV0ZXJzIHRvIGEgc2VsZWN0ICh2aWV3IG1vZGUpLlxuICpcbiAqIFRoaXMgZnVuY3Rpb24gaGFuZGxlcyBWT0NBQlVMQVJZIHNlbGVjdCBib3hlcyBPTkxZLlxuICpcbiAqIE5vdGU6IGlkU3RyIG11c3Qgbm90IGhhdmUgdGhlIFwiX1wiIHByZS1hcHBlbmRlZFxuICpcbiAqIEBwYXJhbSBzdHJpbmcgc2hvcnROYW1lIFRoZSBzaG9ydCBuYW1lIG9mIHRoZSBkYXRhIG9iamVjdCwgc3VjaCBhcyBcIm5hbWVFbnRyeVwiIG9yIFwib2NjdXBhdGlvblwiXG4gKiBAcGFyYW0gc3RyaW5nfGludCBpZFN0ciBUaGUgaW5kZXggd2l0aGluIHRoZSBlZGl0IHBhZ2Ugb2YgdGhlIG9iamVjdC5cbiAqL1xuZnVuY3Rpb24gc2VsZWN0VG9UZXh0KHNob3J0TmFtZSwgaWRTdHIpIHtcbiAgICAkKFwiZGl2W2lkXj0nc2VsZWN0X1wiK3Nob3J0TmFtZStcIiddXCIpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjb250ID0gJCh0aGlzKTtcbiAgICAgICAgaWYoY29udC5hdHRyKCdpZCcpLmVuZHNXaXRoKFwiX1wiK2lkU3RyKSAmJiAhY29udC5hdHRyKCdpZCcpLmVuZHNXaXRoKFwiWlpcIikpIHtcbiAgICAgICAgICAgIC8vIHJlbW92ZSB0aGUgc2hvcnQgbmFtZSBhbmQgXCJzZWxlY3RfXCIgZnJvbSB0aGUgc3RyaW5nIHdlJ3JlIHBhcnNpbmdcbiAgICAgICAgICAgIHZhciBkaXZTdHIgPSBjb250LmF0dHIoJ2lkJykucmVwbGFjZShcInNlbGVjdF9cIiwgXCJcIikucmVwbGFjZShzaG9ydE5hbWUgKyBcIl9cIiwgXCJcIik7XG4gICAgICAgICAgICAvLyByZW1vdmUgdGhlIGlkc3RyIHRvIHJlY2VpdmUgdGhlIG5hbWUgb2YgdGhpcyBlbGVtZW50XG4gICAgICAgICAgICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKFwiXFxfXCIraWRTdHIrXCIkXCIsIFwiZ1wiKTtcbiAgICAgICAgICAgIHZhciBuYW1lID0gZGl2U3RyLnJlcGxhY2UocmVnZXgsIFwiXCIpO1xuICAgICAgICAgICAgdmFyIGlkID0gJChcIiNcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9pZF9cIitpZFN0cikudmFsKCk7XG4gICAgICAgICAgICB2YXIgdGVybSA9ICQoXCIjXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfaWRfXCIraWRTdHIrIFwiIG9wdGlvbjpzZWxlY3RlZFwiKS50ZXh0KCk7XG4gICAgICAgICAgICB2YXIgdm9jYWJ0eXBlID0gJChcIiNcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl92b2NhYnR5cGVfXCIraWRTdHIpLnZhbCgpO1xuICAgICAgICAgICAgdmFyIG1pbmxlbmd0aCA9ICQoXCIjXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfbWlubGVuZ3RoX1wiK2lkU3RyKS52YWwoKTtcblxuICAgICAgICAgICAgdmFyIGFkZGl0aW9uYWxTdHlsZSA9IFwiXCI7XG4gICAgICAgICAgICB2YXIgcG9zdFRleHQgPSBcIlwiO1xuICAgICAgICAgICAgaWYgKHZvY2FidHlwZSA9PSBcIm5hbWVfY29tcG9uZW50XCIpIHtcbiAgICAgICAgICAgICAgICBhZGRpdGlvbmFsU3R5bGUgPSBcIm5hbWUtY29tcG9uZW50LXR5cGVcIjtcbiAgICAgICAgICAgICAgICBwb3N0VGV4dCA9IFwiIDpcIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29udC5odG1sKFwiPGlucHV0IHR5cGU9XFxcImhpZGRlblxcXCIgaWQ9XFxcIlwiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX2lkX1wiK2lkU3RyK1wiXFxcIiBcIiArXG4gICAgICAgICAgICAgICAgICAgIFwibmFtZT1cXFwiXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfaWRfXCIraWRTdHIrXCJcXFwiIHZhbHVlPVxcXCJcIitpZCtcIlxcXCIvPlwiICtcbiAgICAgICAgICAgICAgICAgICAgXCI8aW5wdXQgdHlwZT1cXFwiaGlkZGVuXFxcIiBpZD1cXFwiXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfdGVybV9cIitpZFN0citcIlxcXCIgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIm5hbWU9XFxcIlwiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX3Rlcm1fXCIraWRTdHIrXCJcXFwiIHZhbHVlPVxcXCJcIit0ZXJtK1wiXFxcIi8+XCIgK1xuICAgICAgICAgICAgICAgICAgICBcIjxpbnB1dCB0eXBlPVxcXCJoaWRkZW5cXFwiIGlkPVxcXCJcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl92b2NhYnR5cGVfXCIraWRTdHIrXCJcXFwiIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZT1cXFwiXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfdm9jYWJ0eXBlX1wiK2lkU3RyK1wiXFxcIiB2YWx1ZT1cXFwiXCIrdm9jYWJ0eXBlK1wiXFxcIi8+XCIgK1xuICAgICAgICAgICAgICAgICAgICBcIjxpbnB1dCB0eXBlPVxcXCJoaWRkZW5cXFwiIGlkPVxcXCJcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9taW5sZW5ndGhfXCIraWRTdHIrXCJcXFwiIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZT1cXFwiXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfbWlubGVuZ3RoX1wiK2lkU3RyK1wiXFxcIiB2YWx1ZT1cXFwiXCIrbWlubGVuZ3RoK1wiXFxcIi8+XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCI8cCBjbGFzcz1cXFwiZm9ybS1jb250cm9sLXN0YXRpYyBcIithZGRpdGlvbmFsU3R5bGUrXCJcXFwiPlwiK3Rlcm0rcG9zdFRleHQrXCI8L3A+XCIpO1xuXG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuXG52YXIgZ2VvUGxhY2VMb2FkUmVzdWx0cyA9IG51bGw7XG5cbmZ1bmN0aW9uIHRleHRUb0dlb1BsYWNlU2VsZWN0KHNob3J0TmFtZSwgaWRTdHIpIHtcbiAgICAkKFwiI1wiK3Nob3J0TmFtZStcIl9kYXRhcGFydF9cIiArIGlkU3RyICsgXCIgZGl2W2lkXj0nc2VsZWN0R2VvX1wiK3Nob3J0TmFtZStcIiddXCIpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjb250ID0gJCh0aGlzKTtcbiAgICAgICAgaWYoY29udC5hdHRyKCdpZCcpLmVuZHNXaXRoKFwiX1wiK2lkU3RyKSAmJiAhY29udC5hdHRyKCdpZCcpLmVuZHNXaXRoKFwiWlpcIikpIHtcbiAgICAgICAgICAgIC8vIHJlbW92ZSB0aGUgc2hvcnQgbmFtZSBhbmQgXCJzZWxlY3RfXCIgZnJvbSB0aGUgc3RyaW5nIHdlJ3JlIHBhcnNpbmdcbiAgICAgICAgICAgIHZhciBkaXZTdHIgPSBjb250LmF0dHIoJ2lkJykucmVwbGFjZShcInNlbGVjdEdlb19cIiwgXCJcIikucmVwbGFjZShzaG9ydE5hbWUgKyBcIl9cIiwgXCJcIik7XG4gICAgICAgICAgICAvLyByZW1vdmUgdGhlIGlkc3RyIHRvIHJlY2VpdmUgdGhlIG5hbWUgb2YgdGhpcyBlbGVtZW50XG4gICAgICAgICAgICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKFwiXFxfXCIraWRTdHIrXCIkXCIsIFwiZ1wiKTtcbiAgICAgICAgICAgIHZhciBuYW1lID0gZGl2U3RyLnJlcGxhY2UocmVnZXgsIFwiXCIpO1xuICAgICAgICAgICAgdmFyIGlkID0gJChcIiNcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9pZF9cIitpZFN0cikudmFsKCk7XG4gICAgICAgICAgICB2YXIgdGVybSA9ICQoXCIjXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfdGVybV9cIitpZFN0cikudmFsKCk7XG4gICAgICAgICAgICB2YXIgcGxhY2Vob2xkZXIgPSBcIlNlbGVjdCBHZW8gUGxhY2UgVGVybVwiO1xuXG4gICAgICAgICAgICB2YXIgY29uZmlybWVkID0gJChcIiNcIitzaG9ydE5hbWUrXCJfY29uZmlybWVkX1wiICsgaWRTdHIpLnZhbCgpID09IFwidHJ1ZVwiID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgdmFyIGZpcnN0T3B0aW9uU2VsZWN0ID0gXCJcIjtcbiAgICAgICAgICAgIHZhciBzZWNvbmRPcHRpb25TZWxlY3QgPSBcIiBzZWxlY3RlZFwiO1xuICAgICAgICAgICAgaWYgKCFjb25maXJtZWQpIHtcbiAgICAgICAgICAgICAgICBmaXJzdE9wdGlvblNlbGVjdCA9IFwiIHNlbGVjdGVkXCI7XG4gICAgICAgICAgICAgICAgc2Vjb25kT3B0aW9uU2VsZWN0ID0gXCJcIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29udC5odG1sKFwiPHNlbGVjdCBpZD0nXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfaWRfXCIraWRTdHIrXCInIG5hbWU9J1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX2lkX1wiK2lkU3RyK1wiJyBjbGFzcz0nZm9ybS1jb250cm9sJyBkYXRhLXBsYWNlaG9sZGVyPSdcIitwbGFjZWhvbGRlcitcIic+XCIrXG4gICAgICAgICAgICAgICAgICAgIFwiPG9wdGlvblwiK2ZpcnN0T3B0aW9uU2VsZWN0K1wiPjwvb3B0aW9uPlwiK1xuICAgICAgICAgICAgICAgICAgICBcIjxvcHRpb24gdmFsdWU9XFxcIlwiK2lkK1wiXFxcIlwiK3NlY29uZE9wdGlvblNlbGVjdCtcIj5cIit0ZXJtK1wiPC9vcHRpb24+XCIrXG4gICAgICAgICAgICAgICAgICAgIFwiPC9zZWxlY3Q+XCIpO1xuXG4gICAgICAgICAgICBnZW92b2NhYl9zZWxlY3RfcmVwbGFjZSgkKFwiI1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX2lkX1wiK2lkU3RyKSwgXCJfXCIraWRTdHIpO1xuXG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gZ2VvUGxhY2VTZWxlY3RUb1RleHQoc2hvcnROYW1lLCBpZFN0cikge1xuICAgICQoXCJkaXZbaWRePSdzZWxlY3RHZW9fXCIrc2hvcnROYW1lK1wiJ11cIikuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGNvbnQgPSAkKHRoaXMpO1xuICAgICAgICBpZihjb250LmF0dHIoJ2lkJykuZW5kc1dpdGgoXCJfXCIraWRTdHIpICYmICFjb250LmF0dHIoJ2lkJykuZW5kc1dpdGgoXCJaWlwiKSkge1xuICAgICAgICAgICAgLy8gcmVtb3ZlIHRoZSBzaG9ydCBuYW1lIGFuZCBcInNlbGVjdF9cIiBmcm9tIHRoZSBzdHJpbmcgd2UncmUgcGFyc2luZ1xuICAgICAgICAgICAgdmFyIGRpdlN0ciA9IGNvbnQuYXR0cignaWQnKS5yZXBsYWNlKFwic2VsZWN0R2VvX1wiLCBcIlwiKS5yZXBsYWNlKHNob3J0TmFtZSArIFwiX1wiLCBcIlwiKTtcbiAgICAgICAgICAgIC8vIHJlbW92ZSB0aGUgaWRzdHIgdG8gcmVjZWl2ZSB0aGUgbmFtZSBvZiB0aGlzIGVsZW1lbnRcbiAgICAgICAgICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAoXCJcXF9cIitpZFN0citcIiRcIiwgXCJnXCIpO1xuICAgICAgICAgICAgdmFyIG5hbWUgPSBkaXZTdHIucmVwbGFjZShyZWdleCwgXCJcIik7XG4gICAgICAgICAgICB2YXIgaWQgPSAkKFwiI1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX2lkX1wiK2lkU3RyKS52YWwoKTtcbiAgICAgICAgICAgIHZhciB0ZXJtID0gJChcIiNcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9pZF9cIitpZFN0cisgXCIgb3B0aW9uOnNlbGVjdGVkXCIpLnRleHQoKTtcblxuICAgICAgICAgICAgY29udC5odG1sKFwiPGlucHV0IHR5cGU9XFxcImhpZGRlblxcXCIgaWQ9XFxcIlwiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX2lkX1wiK2lkU3RyK1wiXFxcIiBcIiArXG4gICAgICAgICAgICAgICAgICAgIFwibmFtZT1cXFwiXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfaWRfXCIraWRTdHIrXCJcXFwiIHZhbHVlPVxcXCJcIitpZCtcIlxcXCIvPlwiICtcbiAgICAgICAgICAgICAgICAgICAgXCI8aW5wdXQgdHlwZT1cXFwiaGlkZGVuXFxcIiBpZD1cXFwiXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfdGVybV9cIitpZFN0citcIlxcXCIgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIm5hbWU9XFxcIlwiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX3Rlcm1fXCIraWRTdHIrXCJcXFwiIHZhbHVlPVxcXCJcIit0ZXJtK1wiXFxcIi8+XCIpO1xuXG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuLyoqXG4gKiBNYWtlIGEgZGF0YSBvYmplY3QgZWRpdGFibGVcbiAqXG4gKiBNYWtlIHRoZSBHVUkgcGFuZSBmb3IgYSBnaXZlbiBjb25zdGVsbGF0aW9uIG9iamVjdCAoc2hvcnQsIGkpIGVkaXRhYmxlLiAgU2V0cyB1cCB0aGUgZWRpdCBhbmQgZGVsZXRlXG4gKiBidXR0b25zIGZvciBmaXJzdC1vcmRlciBkYXRhIG9iamVjdHMuXG4gKlxuICogQHBhcmFtIHN0cmluZyBzaG9ydE5hbWUgVGhlIHNob3J0IG5hbWUgb2YgdGhlIGRhdGEgb2JqZWN0LCBzdWNoIGFzIFwibmFtZUVudHJ5XCIgb3IgXCJvY2N1cGF0aW9uXCJcbiAqIEBwYXJhbSBzdHJpbmd8aW50IGkgICAgIFRoZSBpbmRleCB3aXRoaW4gdGhlIGVkaXQgcGFnZSBvZiB0aGUgb2JqZWN0LlxuICogQHJldHVybiBib29sZWFuICAgICAgICAgRmFsc2UgdG8gcGxheSBuaWNlIHdpdGggdGhlIGJyb3dzZXJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1ha2VFZGl0YWJsZShzaG9ydCwgaSkge1xuICAgIC8vIE5vIGVkaXRpbmcgaWYgaXQncyBhbHJlYWR5IGluIGVkaXQgbW9kZVxuICAgIGlmICgkKFwiI1wiICsgc2hvcnQgKyBcIl9vcGVyYXRpb25fXCIgKyBpKS52YWwoKSA9PSBcInVwZGF0ZVwiKVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgLy8gSWYgaXQncyBkZWxldGVkLCB0aGVuIHlvdSBiZXR0ZXIgdW5kZWxldGUgaXQgZmlyc3RcbiAgICBpZiAoJChcIiNcIiArIHNob3J0ICsgXCJfb3BlcmF0aW9uX1wiICsgaSkudmFsKCkgPT0gXCJkZWxldGVcIilcbiAgICAgICAgc2V0RGVsZXRlZChzaG9ydCwgaSk7XG5cbiAgICAkKFwiI1wiICsgc2hvcnQgKyBcIl9lZGl0YnV0dG9uX1wiICsgaSkucmVtb3ZlQ2xhc3MoXCJsaXN0LWdyb3VwLWl0ZW0taW5mb1wiKS5hZGRDbGFzcyhcImxpc3QtZ3JvdXAtaXRlbS13YXJuaW5nXCIpO1xuICAgICQoXCIjXCIgKyBzaG9ydCArIFwiX2VkaXRidXR0b25fXCIgKyBpKS5odG1sKFwiPHNwYW4gY2xhc3M9XFxcImZhIGZhLTJ4IGZhLXVuZG9cXFwiPjwvc3Bhbj48YnI+VW5kb1wiKTtcbiAgICAkKFwiI1wiICsgc2hvcnQgKyBcIl9lZGl0YnV0dG9uX1wiICsgaSkub2ZmKCdjbGljaycpLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XG4gICAgXHR1bmRvRWRpdChzaG9ydCwgaSk7XG4gICAgfSk7XG4gICAgJChcIiNcIiArIHNob3J0ICsgXCJfZGVsZXRlYnV0dG9uX1wiICsgaSkucmVtb3ZlQ2xhc3MoXCJsaXN0LWdyb3VwLWl0ZW0tZGFuZ2VyXCIpLmFkZENsYXNzKFwiZGlzYWJsZWRcIik7XG4gICAgJChcIiNcIiArIHNob3J0ICsgXCJfZGVsZXRlYnV0dG9uX1wiICsgaSkub2ZmKCdjbGljaycpLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcblxuICAgICQoXCIjXCIgKyBzaG9ydCArIFwiX3BhbmVsX1wiICsgaSkucmVtb3ZlQ2xhc3MoXCJwYW5lbC1kZWZhdWx0XCIpLmFkZENsYXNzKFwiYWxlcnQtaW5mb1wiKS5hZGRDbGFzcyhcImVkaXRlZC1jb21wb25lbnRcIik7XG5cbiAgICByZXR1cm4gc3ViTWFrZUVkaXRhYmxlKHNob3J0LCBpKTtcbn1cblxuLyoqXG4gKiBNYWtlIGEgZGF0YSBvYmplY3QgZWRpdGFibGVcbiAqXG4gKiBNYWtlIHRoZSBHVUkgcGFuZSBmb3IgYSBnaXZlbiBjb25zdGVsbGF0aW9uIG9iamVjdCAoc2hvcnQsIGkpIGVkaXRhYmxlLiAgSGFuZGxlcyByZW1vdmluZyB0aGUgcmVhZC1vbmx5XG4gKiBzdGF0dXNlcyBhbmQgY2hhbmdpbmcgZGl2cyBpbnRvIHNlbGVjdHMuXG4gKlxuICogQHBhcmFtIHN0cmluZyBzaG9ydE5hbWUgVGhlIHNob3J0IG5hbWUgb2YgdGhlIGRhdGEgb2JqZWN0LCBzdWNoIGFzIFwibmFtZUVudHJ5XCIgb3IgXCJvY2N1cGF0aW9uXCJcbiAqIEBwYXJhbSBzdHJpbmd8aW50IGkgICAgIFRoZSBpbmRleCB3aXRoaW4gdGhlIGVkaXQgcGFnZSBvZiB0aGUgb2JqZWN0LlxuICogQHJldHVybiBib29sZWFuICAgICAgICAgRmFsc2UgdG8gcGxheSBuaWNlIHdpdGggdGhlIGJyb3dzZXJcbiAqL1xuZnVuY3Rpb24gc3ViTWFrZUVkaXRhYmxlKHNob3J0LCBpKSB7XG4gICAgLy8gTm8gZWRpdGluZyBpZiBpdCdzIGFscmVhZHkgaW4gZWRpdCBtb2RlXG4gICAgaWYgKCQoXCIjXCIgKyBzaG9ydCArIFwiX29wZXJhdGlvbl9cIiArIGkpLnZhbCgpID09IFwidXBkYXRlXCIpXG4gICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgIC8vIEFkZCB0byB0aGUgdW5kbyBzZXRcbiAgICB1bmRvU2V0W3Nob3J0ICsgXCItXCIgKyBpXSA9ICQoXCIjXCIrc2hvcnQrXCJfZGF0YXBhcnRfXCIgKyBpKS5jbG9uZSgpO1xuXG5cbiAgICB0ZXh0VG9JbnB1dChzaG9ydCwgaSk7XG4gICAgdGV4dFRvVGV4dEFyZWEoc2hvcnQsIGkpO1xuICAgIHRleHRUb0NoZWNrYm94KHNob3J0LCBpKTtcblxuICAgIHZhciBpZHN0ciA9IFwiX1wiICsgaTtcblxuICAgIC8vIEVuYWJsZSBidXR0b25zXG4gICAgJChcIiNcIitzaG9ydCtcIl9kYXRhcGFydF9cIiArIGkgKyBcIiBidXR0b25baWRePSdcIitzaG9ydCtcIl8nXVwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgb2JqID0gJCh0aGlzKTtcbiAgICAgICAgaWYob2JqLmF0dHIoJ2lkJykuZW5kc1dpdGgoaWRzdHIpICYmICFvYmouYXR0cignaWQnKS5lbmRzV2l0aChcIlpaXCIpKSB7XG4gICAgICAgICAgICBvYmoucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpLnJlbW92ZUNsYXNzKFwic25hYy1oaWRkZW5cIik7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICAvLyBFbmFibGUgYnV0dG9uc1xuICAgICQoXCIjXCIrc2hvcnQrXCJfZGF0YXBhcnRfXCIgKyBpICsgXCIgYS5sYWJlbFwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKFwic25hYy1oaWRkZW5cIik7XG4gICAgfSk7XG5cbiAgICAvLyBFbmFibGUgY2hlY2tib3hlc1xuICAgICQoXCIjXCIrc2hvcnQrXCJfZGF0YXBhcnRfXCIgKyBpICsgXCIgaW5wdXRbdHlwZT0nY2hlY2tib3gnXVwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgb2JqID0gJCh0aGlzKTtcbiAgICAgICAgaWYob2JqLmF0dHIoJ2lkJykuZW5kc1dpdGgoaWRzdHIpICYmICFvYmouYXR0cignaWQnKS5lbmRzV2l0aChcIlpaXCIpKSB7XG4gICAgICAgICAgICBvYmouYm9vdHN0cmFwVG9nZ2xlKCdlbmFibGUnKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gVHVybiBvbiBDb2RlTWlycm9yIEVkaXRvcnNcbiAgICAkKFwiI1wiK3Nob3J0K1wiX2RhdGFwYXJ0X1wiICsgaSArIFwiIHRleHRhcmVhW2lkXj0nXCIrc2hvcnQrXCJfJ11cIikuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG9iaiA9ICQodGhpcyk7XG4gICAgICAgIGlmKG9iai5hdHRyKCdpZCcpLmVuZHNXaXRoKGlkc3RyKVxuICAgICAgICAgICAgJiYgIW9iai5hdHRyKCdpZCcpLmVuZHNXaXRoKFwiWlpcIikpIHtcbiAgICAgICAgICAgIC8vIHJlbW92ZSB0aGUgc2hvcnQgbmFtZSBmcm9tIHRoZSBzdHJpbmcgd2UncmUgcGFyc2luZ1xuICAgICAgICAgICAgdmFyIGlkU3RyID0gb2JqLmF0dHIoJ2lkJykucmVwbGFjZShzaG9ydCwgXCJcIik7XG4gICAgICAgICAgICBpZiAoaWRTdHIuaW5kZXhPZignX3RleHRfJykgIT0gLTEgfHwgaWRTdHIuaW5kZXhPZignX3NvdXJjZV8nKSAhPSAtMSkge1xuICAgICAgICAgICAgICAgIG9iai5nZXQoMCkuQ29kZU1pcnJvciA9IENvZGVNaXJyb3IuZnJvbVRleHRBcmVhKG9iai5nZXQoMCksIHtcbiAgICAgICAgICAgICAgICAgIGxpbmVOdW1iZXJzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgbGluZVdyYXBwaW5nOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgdmlld3BvcnRNYXJnaW46IEluZmluaXR5LFxuICAgICAgICAgICAgICAgICAgbW9kZToge25hbWU6IFwieG1sXCJ9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICB2YXIgc2F3U2VsZWN0ID0gZmFsc2U7XG4gICAgJChcIiNcIitzaG9ydCtcIl9kYXRhcGFydF9cIiArIGkgKyBcIiBzZWxlY3RbaWRePSdcIitzaG9ydCtcIl8nXVwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgb2JqID0gJCh0aGlzKTtcbiAgICAgICAgaWYob2JqLmF0dHIoJ2lkJykuZW5kc1dpdGgoaWRzdHIpICYmICFvYmouYXR0cignaWQnKS5lbmRzV2l0aChcIlpaXCIpKSB7XG4gICAgICAgICAgICBzYXdTZWxlY3QgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICBpZiAoIXNhd1NlbGVjdCkge1xuICAgICAgICB0ZXh0VG9TZWxlY3Qoc2hvcnQsIGkpO1xuICAgICAgICB0ZXh0VG9HZW9QbGFjZVNlbGVjdChzaG9ydCwgaSk7XG4gICAgICAgIHRleHRUb0RhdGUoc2hvcnQsIGkpO1xuICAgIH1cblxuICAgIC8vIE1ha2UgdGhpbmdzIHJlLW9yZGVyYWJsZSBpZiBzb21ldGhpbmcgZXhpc3RzXG4gICAgLy8gJCggXCIjbmFtZUVudHJ5X2NvbXBvbmVudF91aV8wXCIgKS5zb3J0YWJsZSh7ICAvLyBpZCBvZiB0aGUgY29udGFpbmVyIGNvbnRhaW5pbmcgc29ydGFibGUgdGhpbmdzXG4gICAgLy8gICAgICBpdGVtcyAgICAgICA6ICcubmFtZV9jb21wb25lbnQnICAgICAgICAgLy8gY2xhc3Mgb2YgdGhlIHRoaW5ncyB0aGF0IGFyZSBzb3J0YWJsZS4gIFRoZXkgTVVTVCBoYXZlIGlkc1xuICAgIC8vIH0pO1xuICAgICQoXCIjXCIrc2hvcnQrXCJfZGF0YXBhcnRfXCIgKyBpICsgXCIgc3Bhbi5tb3ZlLWhhbmRsZVwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKFwic25hYy1oaWRkZW5cIik7XG4gICAgfSk7XG4gICAgJCggXCIjXCIrc2hvcnQrXCJfcmVvcmRlcmFibGVfXCIraSApLnNvcnRhYmxlKHtcbiAgICAgICAgICBpdGVtcyAgICAgICA6ICcucmVvcmRlcmFibGUnLFxuICAgICAgICAgIG9wYWNpdHkgICAgIDogMC41LFxuICAgICAgICAgIHVwZGF0ZSAgICAgIDogZnVuY3Rpb24oIGV2ZW50LCB1aSApIHtcbiAgICAgICAgICAgICAgdmFyIG5ld29yZGVyID0gJCggXCIjXCIrc2hvcnQrXCJfcmVvcmRlcmFibGVfXCIraSApLnNvcnRhYmxlKFwidG9BcnJheVwiKTtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2cobmV3b3JkZXIpO1xuICAgICAgICAgICAgICBuZXdvcmRlci5mb3JFYWNoKGZ1bmN0aW9uKG9yZGVyZWRJRCwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgJChcIiNcIitvcmRlcmVkSUQgKyBcIiBpbnB1dC5vcmRlci1pbmRleFwiKS52YWwoaW5kZXgpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgaWYgKHNob3J0ID09IFwibmFtZUVudHJ5XCIpXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZU5hbWVFbnRyeUhlYWRpbmcoaSk7XG4gICAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gTWFrZSB0aGUgcmVsYXRpb24gcGljdHVyZXMgdXBkYXRlIGFwcHJvcHJpYXRlbHlcbiAgICBpZiAoc2hvcnQgPT0gJ2NvbnN0ZWxsYXRpb25SZWxhdGlvbicpIHtcbiAgICAgICAgLy8gbWFrZSB0aGUgcm9sZSBkcm9wZG93biBhZmZlY3QgdGhlIHBpY3R1cmVcbiAgICAgICAgJCgnIycrc2hvcnQrJ190eXBlX2lkXycraSkuY2hhbmdlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdXBkYXRlUGljdHVyZUFycm93KHNob3J0LCBpLFxuICAgICAgICAgICAgICAgICQoJyMnK3Nob3J0KydfdHlwZV9pZF8nK2krJyBvcHRpb246c2VsZWN0ZWQnKS50ZXh0KCkpO1xuICAgICAgICB9KTtcblxuICAgIH1cbiAgICBpZiAoc2hvcnQgPT0gJ3Jlc291cmNlUmVsYXRpb24nKSB7XG4gICAgICAgIC8vIG1ha2UgdGhlIHJvbGUgZHJvcGRvd24gYWZmZWN0IHRoZSBwaWN0dXJlXG4gICAgICAgICQoJyMnK3Nob3J0Kydfcm9sZV9pZF8nK2kpLmNoYW5nZShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHVwZGF0ZVBpY3R1cmVBcnJvdyhzaG9ydCwgaSxcbiAgICAgICAgICAgICAgICAkKCcjJytzaG9ydCsnX3JvbGVfaWRfJytpKycgb3B0aW9uOnNlbGVjdGVkJykudGV4dCgpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8vIFBsYWNlcyBzaG91bGQgdXBkYXRlIHRoZSBwbGFjZSBoZWFkaW5nXG4gICAgaWYgKHNob3J0ID09ICdwbGFjZScpIHtcbiAgICAgICAgLy8gSWYgdGhlcmUgaXMgYSB2YWx1ZSBwcmUtc2V0LCB0aGVuIGF1dG9tYXRpY2FsbHkgY29uZmlybSBhbmQgdXBkYXRlXG4gICAgICAgIGlmICgkKCcjJytzaG9ydCsnX2dlb3BsYWNlX2lkXycraSkudmFsKCkgIT0gbnVsbCAmJiAkKCcjJytzaG9ydCsnX2dlb3BsYWNlX2lkXycraSkudmFsKCkgIT0gXCJcIikge1xuICAgICAgICAgICAgdXBkYXRlUGxhY2VIZWFkaW5nKHNob3J0LCBpLCAkKCcjJytzaG9ydCsnX2dlb3BsYWNlX2lkXycraSkudmFsKCkpO1xuICAgICAgICB9XG4gICAgICAgIC8vIG1ha2UgdGhlIHJvbGUgZHJvcGRvd24gYWZmZWN0IHRoZSBwaWN0dXJlXG4gICAgICAgICQoJyMnK3Nob3J0KydfZ2VvcGxhY2VfaWRfJytpKS5jaGFuZ2UoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB1cGRhdGVQbGFjZUhlYWRpbmcoc2hvcnQsIGksXG4gICAgICAgICAgICAgICAgJCgnIycrc2hvcnQrJ19nZW9wbGFjZV9pZF8nK2kpLnZhbCgpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gYWRkIHBhcnNlciBidG4gaWYgbmFtZUVudHJ5IGlzIGEgY29tcHV0ZWQgbmFtZSwgZW50aXR5IGlzIHBlcnNvbiwgYW5kIGlmIG5vIGJ0biBvciBleHRyYSBuYW1lIGNvbXBvbmVudHMgYWxyZWFkeSBleGlzdFxuICAgIGlmIChzaG9ydCA9PT0gJ25hbWVFbnRyeScgJiYgKCQoXCIjZW50aXR5VHlwZVwiKS52YWwoKSA9PT0gXCI3MDBcIikgJiZcbiAgICAgICAgKCQoXCIjbmFtZUVudHJ5X2NvbXBvbmVudF8wX3BhbmVsX1wiICsgaSkuZmluZCgnc2VsZWN0OmZpcnN0JykudGV4dCgpID09PSBcIk5hbWVcIikgJiZcbiAgICAgICAgKCEkKFwiI25hbWVFbnRyeV9wYW5lbF9cIiArIGkpLmZpbmQoJy5uYW1lLXBhcnNlcicpLmxlbmd0aCAmJlxuICAgICAgICAgICAgJChcIiNuYW1lRW50cnlfY29tcG9uZW50XzFfcGFuZWxfXCIgKyBpKS5sZW5ndGggPT09IDApKSB7XG4gICAgICAgICQoJyNuYW1lRW50cnlfY29tcG9uZW50X2FkZF8nICsgaSkuYWZ0ZXIoJzxidXR0b24gY2xhc3M9XCJidG4gYnRuLXByaW1hcnkgbmFtZS1wYXJzZXJcIiBpZD1cIm5hbWVFbnRyeV9wYXJzZV8nICsgaSArXG4gICAgICAgICAgICAnXCIgc3R5bGU9XCJtYXJnaW4tbGVmdDo1cHg7XCI+IDxpIGNsYXNzPVwiZmEgZmEtbWFnaWNcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+IFBhcnNlIDwvYnV0dG9uPicpO1xuICAgIH1cblxuICAgIC8vIFNldCB0aGlzIGRhdGEncyBvcGVyYXRpb24gdmFsdWUgYXBwcm9wcmlhdGVseVxuICAgIGlmICgkKFwiI1wiICsgc2hvcnQgKyBcIl9pZF9cIiArIGkpLnZhbCgpICE9IFwiXCIpXG4gICAgXHQkKFwiI1wiICsgc2hvcnQgKyBcIl9vcGVyYXRpb25fXCIgKyBpKS52YWwoXCJ1cGRhdGVcIik7XG4gICAgZWxzZVxuICAgIFx0JChcIiNcIiArIHNob3J0ICsgXCJfb3BlcmF0aW9uX1wiICsgaSkudmFsKFwiaW5zZXJ0XCIpO1xuXG4gICAgLy8gQXNrZWQgdG8gZWRpdCBzb21ldGhpbmcsIHNvIG1ha2UgaXQgZ2xvYmFsbHkga25vd25cbiAgICBzZXRFZGl0ZWRGbGFnKHRydWUpO1xuICAgIC8vc29tZXRoaW5nSGFzQmVlbkVkaXRlZCA9IHRydWU7XG5cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICogTWFrZSBhIGRhdGEgb2JqZWN0IHVuZWRpdGFibGVcbiAqXG4gKiBNYWtlIGVhY2ggb2JqZWN0IGluIHRoZSBHVUkgcGFnZSBmb3IgdGhlIGdpdmVuIHBpZWNlIHVuZWRpdGFibGUgYnkgdHVybmluZyB0aGVtIGJhY2sgdG8gdGV4dC4gIEFsc29cbiAqIHRha2VzIHRoZSBjb2xvciBhd2F5IGZyb20gdGhlIHBhbmUgYW5kIHJlbW92ZXMgdGhlIG9wZXJhdGlvbiBmbGFnLlxuICpcbiAqIEBwYXJhbSBzdHJpbmcgc2hvcnROYW1lIFRoZSBzaG9ydCBuYW1lIG9mIHRoZSBkYXRhIG9iamVjdCwgc3VjaCBhcyBcIm5hbWVFbnRyeVwiIG9yIFwib2NjdXBhdGlvblwiXG4gKiBAcGFyYW0gc3RyaW5nfGludCBpICAgICBUaGUgaW5kZXggd2l0aGluIHRoZSBlZGl0IHBhZ2Ugb2YgdGhlIG9iamVjdC5cbiAqIEByZXR1cm4gYm9vbGVhbiAgICAgICAgIEZhbHNlIHRvIHBsYXkgbmljZSB3aXRoIHRoZSBicm93c2VyXG4gKi9cbmZ1bmN0aW9uIHN1Yk1ha2VVbmVkaXRhYmxlKHNob3J0TmFtZSwgaSkge1xuXG5cdC8vIE1ha2UgaW5wdXRzIHJlYWQtb25seVxuICAgIHZhciBpZHN0ciA9IFwiX1wiICsgaTtcblxuXG4gICAgLy8gVHVybiBvZmYgdGhlIHJlb3JkZXJpbmcganNcbiAgICAkKFwiI1wiK3Nob3J0TmFtZStcIl9kYXRhcGFydF9cIiArIGkgKyBcIiBzcGFuLm1vdmUtaGFuZGxlXCIpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgICQodGhpcykuYWRkQ2xhc3MoXCJzbmFjLWhpZGRlblwiKTtcbiAgICB9KTtcbiAgICBpZiAoJCggXCIjXCIrc2hvcnROYW1lK1wiX3Jlb3JkZXJhYmxlX1wiK2kgKS5oYXNDbGFzcyhcInVpLXNvcnRhYmxlXCIpKVxuICAgICAgICAkKCBcIiNcIitzaG9ydE5hbWUrXCJfcmVvcmRlcmFibGVfXCIraSApLnNvcnRhYmxlKFwiZGVzdHJveVwiKTtcblxuICAgIC8vIFJlbW92ZSBDb2RlTWlycm9yIGVkaXRvcnNcbiAgICAkKFwiI1wiK3Nob3J0TmFtZStcIl9kYXRhcGFydF9cIiArIGkgKyBcIiB0ZXh0YXJlYVtpZF49J1wiK3Nob3J0TmFtZStcIl8nXVwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgb2JqID0gJCh0aGlzKTtcbiAgICAgICAgaWYob2JqLmF0dHIoJ2lkJykuZW5kc1dpdGgoaWRzdHIpXG4gICAgICAgICAgICAmJiAhb2JqLmF0dHIoJ2lkJykuZW5kc1dpdGgoXCJaWlwiKVxuICAgICAgICAgICAgJiYgKG9iai5hdHRyKCdpZCcpLmluZGV4T2YoJ190ZXh0XycpICE9IC0xIHx8IG9iai5hdHRyKCdpZCcpLmluZGV4T2YoJ19zb3VyY2VfJykgIT0gLTEpKSB7XG5cbiAgICAgICAgICAgIGlmIChvYmouZ2V0KDApLkNvZGVNaXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvYmouZ2V0KDApLkNvZGVNaXJyb3IudG9UZXh0QXJlYSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8oZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQob2JqLmF0dHIoJ2lkJykpKS5Db2RlTWlycm9yLnRvVGV4dEFyZWEoKTtcbiAgICAgICAgICAgICAgICAvL29iai5nZXQoMCkuQ29kZU1pcnJvci50b1RleHRBcmVhKCk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICAvLyBEaXNhYmxlIGJ1dHRvbnNcbiAgICAkKFwiI1wiK3Nob3J0TmFtZStcIl9kYXRhcGFydF9cIiArIGkgKyBcIiBidXR0b25baWRePSdcIitzaG9ydE5hbWUrXCJfJ11cIikuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG9iaiA9ICQodGhpcyk7XG4gICAgICAgIGlmKG9iai5hdHRyKCdpZCcpLmVuZHNXaXRoKGlkc3RyKSAmJiAhb2JqLmF0dHIoJ2lkJykuZW5kc1dpdGgoXCJaWlwiKSkge1xuICAgICAgICAgICAgb2JqLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIikuYWRkQ2xhc3MoXCJzbmFjLWhpZGRlblwiKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gRGlzYWJsZSBidXR0b25zXG4gICAgJChcIiNcIitzaG9ydE5hbWUrXCJfZGF0YXBhcnRfXCIgKyBpICsgXCIgYS5sYWJlbFwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAkKHRoaXMpLmFkZENsYXNzKFwic25hYy1oaWRkZW5cIik7XG4gICAgfSk7XG5cbiAgICAvLyBEaXNhYmxlIGNoZWNrYm94ZXNcbiAgICAkKFwiI1wiK3Nob3J0TmFtZStcIl9kYXRhcGFydF9cIiArIGkgKyBcIiBpbnB1dFt0eXBlPSdjaGVja2JveCddXCIpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBvYmogPSAkKHRoaXMpO1xuICAgICAgICBpZihvYmouYXR0cignaWQnKS5lbmRzV2l0aChpZHN0cikgJiYgIW9iai5hdHRyKCdpZCcpLmVuZHNXaXRoKFwiWlpcIikpIHtcbiAgICAgICAgICAgIG9iai5ib290c3RyYXBUb2dnbGUoXCJkaXNhYmxlXCIpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICBpbnB1dFRvVGV4dChzaG9ydE5hbWUsIGkpO1xuICAgIHRleHRBcmVhVG9UZXh0KHNob3J0TmFtZSwgaSk7XG4gICAgY2hlY2tib3hUb1RleHQoc2hvcnROYW1lLCBpKTtcbiAgICAvLyBDaGVjayBmb3IgYSBzZWxlY3QgYm94XG4gICAgdmFyIHNhd1NlbGVjdCA9IGZhbHNlO1xuICAgICQoXCIjXCIrc2hvcnROYW1lK1wiX2RhdGFwYXJ0X1wiICsgaSArIFwiIHNlbGVjdFtpZF49J1wiK3Nob3J0TmFtZStcIl8nXVwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgb2JqID0gJCh0aGlzKTtcbiAgICAgICAgaWYob2JqLmF0dHIoJ2lkJykuZW5kc1dpdGgoaWRzdHIpICYmICFvYmouYXR0cignaWQnKS5lbmRzV2l0aChcIlpaXCIpKSB7XG4gICAgICAgICAgICBzYXdTZWxlY3QgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgLy8gSWYgYSBzZWxlY3QgYm94IHdhcyBzZWVuLCB1bmRvIGl0XG4gICAgaWYgKHNhd1NlbGVjdCkge1xuICAgICAgICBzZWxlY3RUb1RleHQoc2hvcnROYW1lLCBpKTtcbiAgICAgICAgZ2VvUGxhY2VTZWxlY3RUb1RleHQoc2hvcnROYW1lLCBpKTtcbiAgICAgICAgZGF0ZVRvVGV4dChzaG9ydE5hbWUsaSk7XG4gICAgfVxuXG5cbiAgICAvLyBDbGVhciB0aGUgb3BlcmF0aW9uIGZsYWdzXG4gICAgLy8kKFwiI1wiICsgc2hvcnROYW1lICsgXCJfb3BlcmF0aW9uX1wiICsgaSkudmFsKFwiXCIpO1xuICAgICQoXCIjXCIrc2hvcnROYW1lK1wiX2RhdGFwYXJ0X1wiICsgaSArIFwiIGlucHV0W2lkXj0nXCIrc2hvcnROYW1lK1wiXyddXCIpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBvYmogPSAkKHRoaXMpO1xuICAgICAgICBpZihvYmouYXR0cignaWQnKS5lbmRzV2l0aChcIl9vcGVyYXRpb25cIiArIGlkc3RyKSAmJiAhb2JqLmF0dHIoJ2lkJykuZW5kc1dpdGgoXCJaWlwiKSkge1xuICAgICAgICAgICAgb2JqLnZhbChcIlwiKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG5cdCQoXCIjXCIgKyBzaG9ydE5hbWUgKyBcIl9wYW5lbF9cIiArIGkpLmFkZENsYXNzKFwicGFuZWwtZGVmYXVsdFwiKS5yZW1vdmVDbGFzcyhcImFsZXJ0LWluZm9cIikucmVtb3ZlQ2xhc3MoXCJlZGl0ZWQtY29tcG9uZW50XCIpO1xuXG5cblxufVxuXG4vKipcbiAqIE1ha2UgYSBkYXRhIG9iamVjdCB1bmVkaXRhYmxlXG4gKlxuICogTWFrZSB0aGUgR1VJIHBhbmUgZm9yIGEgZ2l2ZW4gY29uc3RlbGxhdGlvbiBvYmplY3QgKHNob3J0LCBpKSB1bi1lZGl0YWJsZS4gIFNldHMgdXAgdGhlIGVkaXQgYW5kIGRlbGV0ZVxuICogYnV0dG9ucyBmb3IgZmlyc3Qtb3JkZXIgZGF0YSBvYmplY3RzLCBhbmQgY2FsbHMgdGhlIGZ1bmN0aW9uIHRvIHR1cm4gdGhlIGVsZW1lbnRzIGJhY2sgdG8gdGV4dC5cbiAqXG4gKiBAcGFyYW0gc3RyaW5nIHNob3J0TmFtZSBUaGUgc2hvcnQgbmFtZSBvZiB0aGUgZGF0YSBvYmplY3QsIHN1Y2ggYXMgXCJuYW1lRW50cnlcIiBvciBcIm9jY3VwYXRpb25cIlxuICogQHBhcmFtIHN0cmluZ3xpbnQgaSAgICAgVGhlIGluZGV4IHdpdGhpbiB0aGUgZWRpdCBwYWdlIG9mIHRoZSBvYmplY3QuXG4gKiBAcmV0dXJuIGJvb2xlYW4gICAgICAgICBGYWxzZSB0byBwbGF5IG5pY2Ugd2l0aCB0aGUgYnJvd3NlclxuICovXG5leHBvcnQgZnVuY3Rpb24gbWFrZVVuZWRpdGFibGUoc2hvcnROYW1lLCBpKSB7XG5cdC8vIE1ha2UgaW5wdXRzIHJlYWQtb25seVxuICAgIHZhciBpZHN0ciA9IFwiX1wiICsgaTtcblxuICAgIHN1Yk1ha2VVbmVkaXRhYmxlKHNob3J0TmFtZSwgaSk7XG5cbiAgICAvLyByZXN0b3JlIHRoZSBlZGl0IGJ1dHRvblxuICAgICQoXCIjXCIgKyBzaG9ydE5hbWUgKyBcIl9lZGl0YnV0dG9uX1wiICsgaSkuYWRkQ2xhc3MoXCJsaXN0LWdyb3VwLWl0ZW0taW5mb1wiKS5yZW1vdmVDbGFzcyhcImxpc3QtZ3JvdXAtaXRlbS13YXJuaW5nXCIpO1xuICAgICQoXCIjXCIgKyBzaG9ydE5hbWUgKyBcIl9lZGl0YnV0dG9uX1wiICsgaSkuaHRtbChcIjxzcGFuIGNsYXNzPVxcXCJmYSBmYS0yeCBmYS1wZW5jaWwtc3F1YXJlLW9cXFwiPjwvc3Bhbj48YnI+RWRpdFwiKTtcbiAgICAkKFwiI1wiICsgc2hvcnROYW1lICsgXCJfZWRpdGJ1dHRvbl9cIiArIGkpLm9mZignY2xpY2snKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xuICAgIFx0bWFrZUVkaXRhYmxlKHNob3J0TmFtZSwgaSk7XG4gICAgfSk7XG5cbiAgICAvLyByZXN0b3JlIHRoZSBkZWxldGUgYnV0dG9uXG4gICAgJChcIiNcIiArIHNob3J0TmFtZSArIFwiX2RlbGV0ZWJ1dHRvbl9cIiArIGkpLmFkZENsYXNzKFwibGlzdC1ncm91cC1pdGVtLWRhbmdlclwiKS5yZW1vdmVDbGFzcyhcImRpc2FibGVkXCIpO1xuICAgICQoXCIjXCIgKyBzaG9ydE5hbWUgKyBcIl9kZWxldGVidXR0b25fXCIgKyBpKS5vZmYoJ2NsaWNrJykub24oXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcbiAgICAgICBzZXREZWxldGVkKHNob3J0TmFtZSwgaSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICogTWFrZSBhbiBTQ00gZGF0YSBvYmplY3QgZWRpdGFibGVcbiAqXG4gKiBNYWtlIHRoZSBHVUkgcGFuZSBmb3IgYW4gU0NNIChqKSBvZiBhIGdpdmVuIGNvbnN0ZWxsYXRpb24gb2JqZWN0IChzaG9ydCwgaSkgZWRpdGFibGUuICBTZXRzIHVwIHRoZSBlZGl0IGFuZCBkZWxldGVcbiAqIGJ1dHRvbnMgZm9yIGZpcnN0LW9yZGVyIGRhdGEgb2JqZWN0cy5cbiAqXG4gKiBAcGFyYW0gc3RyaW5nIHNob3J0TmFtZSAgVGhlIHNob3J0IG5hbWUgb2YgdGhlIGRhdGEgb2JqZWN0LCBzdWNoIGFzIFwibmFtZUVudHJ5XCIgb3IgXCJvY2N1cGF0aW9uXCJcbiAqIEBwYXJhbSBzdHJpbmd8aW50IGkgICAgICBUaGUgaW5kZXggd2l0aGluIHRoZSBlZGl0IHBhZ2Ugb2YgdGhlIG9iamVjdC5cbiAqIEBwYXJhbSBzdHJpbmd8aW50IGogICAgICBUaGUgaW5kZXggd2l0aGluIHRoZSBkYXRhIG9iamVjdCBTQ00gbGlzdCBvbiB0aGUgZWRpdCBwYWdlIG9mIHRoZSBTQ00gb2JqZWN0LlxuICogQHJldHVybiBib29sZWFuICAgICAgICAgIEZhbHNlIHRvIHBsYXkgbmljZSB3aXRoIHRoZSBicm93c2VyXG4gKi9cbmZ1bmN0aW9uIG1ha2VTQ01FZGl0YWJsZShzaG9ydE5hbWUsIGksIGopIHtcblx0dmFyIGlkID0gaiArIFwiX1wiICsgaTtcbiAgICB2YXIgc2NtU2hvcnROYW1lID0gXCJzY21fXCIgKyBzaG9ydE5hbWU7XG5cbiAgICAvLyBObyBlZGl0aW5nIGlmIGl0J3MgYWxyZWFkeSBpbiBlZGl0IG1vZGVcbiAgICBpZiAoJChcIiNcIiArIHNjbVNob3J0TmFtZSArIFwiX29wZXJhdGlvbl9cIiArIGlkKS52YWwoKSA9PSBcInVwZGF0ZVwiKVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgLy8gSWYgaXQncyBkZWxldGVkLCB0aGVuIHlvdSBiZXR0ZXIgdW5kZWxldGUgaXQgZmlyc3RcbiAgICBpZiAoJChcIiNcIiArIHNjbVNob3J0TmFtZSArIFwiX29wZXJhdGlvbl9cIiArIGlkKS52YWwoKSA9PSBcImRlbGV0ZVwiKVxuICAgICAgICBzZXRTQ01EZWxldGVkKHNob3J0TmFtZSwgaSwgaik7XG5cbiAgICAkKFwiI1wiICsgc2NtU2hvcnROYW1lICsgXCJfZWRpdGJ1dHRvbl9cIiArIGlkKS5yZW1vdmVDbGFzcyhcImxpc3QtZ3JvdXAtaXRlbS1pbmZvXCIpLmFkZENsYXNzKFwibGlzdC1ncm91cC1pdGVtLXdhcm5pbmdcIik7XG4gICAgJChcIiNcIiArIHNjbVNob3J0TmFtZSArIFwiX2VkaXRidXR0b25fXCIgKyBpZCkuaHRtbChcIjxzcGFuIGNsYXNzPVxcXCJmYSBmYS11bmRvXFxcIj48L3NwYW4+XCIpO1xuICAgICQoXCIjXCIgKyBzY21TaG9ydE5hbWUgKyBcIl9lZGl0YnV0dG9uX1wiICsgaWQpLm9mZignY2xpY2snKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xuICAgIFx0dW5kb1NDTUVkaXQoc2hvcnROYW1lLCBpLCBqKTtcbiAgICB9KTtcbiAgICAkKFwiI1wiICsgc2NtU2hvcnROYW1lICsgXCJfZGVsZXRlYnV0dG9uX1wiICsgaWQpLnJlbW92ZUNsYXNzKFwibGlzdC1ncm91cC1pdGVtLWRhbmdlclwiKS5hZGRDbGFzcyhcImRpc2FibGVkXCIpO1xuICAgICQoXCIjXCIgKyBzY21TaG9ydE5hbWUgKyBcIl9kZWxldGVidXR0b25fXCIgKyBpZCkub2ZmKCdjbGljaycpLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcblxuICAgICQoXCIjXCIgKyBzY21TaG9ydE5hbWUgKyBcIl9wYW5lbF9cIiArIGlkKS5yZW1vdmVDbGFzcyhcInBhbmVsLWRlZmF1bHRcIikuYWRkQ2xhc3MoXCJhbGVydC1pbmZvXCIpLmFkZENsYXNzKFwiZWRpdGVkLWNvbXBvbmVudFwiKTtcblxuICAgIHJldHVybiBzdWJNYWtlRWRpdGFibGUoc2NtU2hvcnROYW1lLCBpZCk7XG59XG5cbi8qKlxuICogTWFrZSBhbiBTQ00gZGF0YSBvYmplY3QgdW4tZWRpdGFibGVcbiAqXG4gKiBNYWtlIHRoZSBHVUkgcGFuZSBmb3IgYW4gU0NNIG9iamVjdCAoaikgZm9yIGEgZ2l2ZW4gY29uc3RlbGxhdGlvbiBvYmplY3QgKHNob3J0LCBpKSB1bi1lZGl0YWJsZS4gIFNldHMgdXAgdGhlIGVkaXQgYW5kIGRlbGV0ZVxuICogYnV0dG9ucyBmb3IgU0NNIGRhdGEgb2JqZWN0cy5cbiAqXG4gKiBAcGFyYW0gc3RyaW5nIHNob3J0TmFtZSBUaGUgc2hvcnQgbmFtZSBvZiB0aGUgZGF0YSBvYmplY3QsIHN1Y2ggYXMgXCJuYW1lRW50cnlcIiBvciBcIm9jY3VwYXRpb25cIlxuICogQHBhcmFtIHN0cmluZ3xpbnQgaSAgICAgVGhlIGluZGV4IHdpdGhpbiB0aGUgZWRpdCBwYWdlIG9mIHRoZSBvYmplY3QuXG4gKiBAcGFyYW0gc3RyaW5nfGludCBqICAgICAgVGhlIGluZGV4IHdpdGhpbiB0aGUgZGF0YSBvYmplY3QgU0NNIGxpc3Qgb24gdGhlIGVkaXQgcGFnZSBvZiB0aGUgU0NNIG9iamVjdC5cbiAqIEByZXR1cm4gYm9vbGVhbiAgICAgICAgIEZhbHNlIHRvIHBsYXkgbmljZSB3aXRoIHRoZSBicm93c2VyXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBtYWtlU0NNVW5lZGl0YWJsZShzaG9ydE5hbWUsIGksIGopIHtcblxuXHQvLyBNYWtlIGlucHV0cyByZWFkLW9ubHlcbiAgICB2YXIgaWRzdHIgPSBqICsgXCJfXCIgKyBpO1xuXG4gICAgc3ViTWFrZVVuZWRpdGFibGUoJ3NjbV8nK3Nob3J0TmFtZSwgaWRzdHIpO1xuXG4gICAgLy8gcmVzdG9yZSB0aGUgZWRpdCBidXR0b25cbiAgICAkKFwiI3NjbV9cIiArIHNob3J0TmFtZSArIFwiX2VkaXRidXR0b25fXCIgKyBpZHN0cikuYWRkQ2xhc3MoXCJsaXN0LWdyb3VwLWl0ZW0taW5mb1wiKS5yZW1vdmVDbGFzcyhcImxpc3QtZ3JvdXAtaXRlbS13YXJuaW5nXCIpO1xuICAgICQoXCIjc2NtX1wiICsgc2hvcnROYW1lICsgXCJfZWRpdGJ1dHRvbl9cIiArIGlkc3RyKS5odG1sKFwiPHNwYW4gY2xhc3M9XFxcImZhIGZhLXBlbmNpbC1zcXVhcmUtb1xcXCI+PC9zcGFuPlwiKTtcbiAgICAkKFwiI3NjbV9cIiArIHNob3J0TmFtZSArIFwiX2VkaXRidXR0b25fXCIgKyBpZHN0cikub2ZmKCdjbGljaycpLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XG4gICAgXHRtYWtlU0NNRWRpdGFibGUoc2hvcnROYW1lLCBpLCBqKTtcbiAgICB9KTtcblxuICAgIC8vIHJlc3RvcmUgdGhlIGRlbGV0ZSBidXR0b25cbiAgICAkKFwiI3NjbV9cIiArIHNob3J0TmFtZSArIFwiX2RlbGV0ZWJ1dHRvbl9cIiArIGlkc3RyKS5hZGRDbGFzcyhcImxpc3QtZ3JvdXAtaXRlbS1kYW5nZXJcIikucmVtb3ZlQ2xhc3MoXCJkaXNhYmxlZFwiKTtcbiAgICAkKFwiI3NjbV9cIiArIHNob3J0TmFtZSArIFwiX2RlbGV0ZWJ1dHRvbl9cIiArIGlkc3RyKS5vZmYoJ2NsaWNrJykub24oXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcbiAgICAgICBzZXRTQ01EZWxldGVkKHNob3J0TmFtZSwgaSwgaik7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICogU2V0IGEgQ29udHJpYnV0b3IgT2JqZWN0IGFzIGRlbGV0ZWRcbiAqXG4gKiBTZXRzIHRoZSBjb250cmlidXRvciBvYmplY3QgKHNob3J0TmFtZSwgaSkgYXMgZGVsZXRlZCBvciB1bmRlbGV0ZWQgYW5kIG1ha2VzIHRoZSBhcHByb3ByaWF0ZSBjaGFuZ2VzLlxuICpcbiAqIEBwYXJhbSBzdHJpbmcgc2hvcnROYW1lIFRoZSBzaG9ydCBuYW1lIG9mIHRoZSBjb250cmlidXRvciBvYmplY3QuXG4gKiBAcGFyYW0gc3RyaW5nfGludCBpICAgICBUaGUgaW5kZXggd2l0aGluIHRoZSBlZGl0IHBhZ2Ugb2YgdGhlIG9iamVjdC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldFJlcGVhdGVkRGF0YURlbGV0ZWQoc2hvcnROYW1lLCBpKSB7XG4gICAgaWYgKCQoXCIjXCIgKyBzaG9ydE5hbWUgKyBcIl9vcGVyYXRpb25fXCIgKyBpKS52YWwoKSAhPSBcImRlbGV0ZVwiKSB7XG4gICAgICAgICQoXCIjXCIgKyBzaG9ydE5hbWUgKyBcIl9yZW1vdmVfXCIgKyBpKS5yZW1vdmVDbGFzcyhcImJ0bi1kYW5nZXJcIikuYWRkQ2xhc3MoXCJidG4td2FybmluZ1wiKTtcbiAgICAgICAgJChcIiNcIiArIHNob3J0TmFtZSArIFwiX3JlbW92ZV9cIiArIGkpLmh0bWwoXCI8aSBjbGFzcz1cXFwiZmEgZmEtdW5kb1xcXCIgYXJpYS1oaWRkZW49XFxcInRydWVcXFwiPjwvaT5cIik7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgJChcIiNcIiArIHNob3J0TmFtZSArIFwiX3JlbW92ZV9cIiArIGkpLnJlbW92ZUNsYXNzKFwiYnRuLXdhcm5pbmdcIikuYWRkQ2xhc3MoXCJidG4tZGFuZ2VyXCIpO1xuICAgICAgICAkKFwiI1wiICsgc2hvcnROYW1lICsgXCJfcmVtb3ZlX1wiICsgaSkuaHRtbChcIjxzcGFuIGNsYXNzPVxcXCJnbHlwaGljb24gZ2x5cGhpY29uLW1pbnVzLXNpZ25cXFwiPjwvc3Bhbj5cIik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHN1YlNldERlbGV0ZWQoc2hvcnROYW1lLCBpKTtcbn1cblxuLyoqXG4gKiBTZXQgYSBmaXJzdC1vcmRlciBkYXRhIG9iamVjdCBhcyBkZWxldGVkXG4gKlxuICogU2V0cyBhIGZpcnN0LW9yZGVyIGRhdGEgb2JqZWN0IChzaG9ydCwgaSkgYXMgZGVsZXRlZCBvciB1bmRlbGV0ZWQgYW5kIG1ha2VzIHRoZSBhcHByb3ByaWF0ZSBjaGFuZ2VzIHRocm91Z2hvdXQgdGhlIHBhZ2UuXG4gKlxuICogQHBhcmFtIHN0cmluZyBzaG9ydE5hbWUgVGhlIHNob3J0IG5hbWUgb2YgdGhlIGRhdGEgb2JqZWN0LCBzdWNoIGFzIFwibmFtZUVudHJ5XCIgb3IgXCJvY2N1cGF0aW9uXCJcbiAqIEBwYXJhbSBzdHJpbmd8aW50IGkgICAgIFRoZSBpbmRleCB3aXRoaW4gdGhlIGVkaXQgcGFnZSBvZiB0aGUgb2JqZWN0LlxuICovXG5mdW5jdGlvbiBzZXREZWxldGVkKHNob3J0LCBpKSB7XG4gICAgaWYgKCQoXCIjXCIgKyBzaG9ydCArIFwiX29wZXJhdGlvbl9cIiArIGkpLnZhbCgpICE9IFwiZGVsZXRlXCIpIHtcbiAgICBcdC8vIHNldCBkZWxldGVkXG4gICAgICAgICQoXCIjXCIgKyBzaG9ydCArIFwiX2RlbGV0ZWJ1dHRvbl9cIiArIGkpLnJlbW92ZUNsYXNzKFwibGlzdC1ncm91cC1pdGVtLWRhbmdlclwiKS5hZGRDbGFzcyhcImxpc3QtZ3JvdXAtaXRlbS13YXJuaW5nXCIpO1xuICAgICAgICAkKFwiI1wiICsgc2hvcnQgKyBcIl9kZWxldGVidXR0b25fXCIgKyBpKS5odG1sKFwiPHNwYW4gY2xhc3M9XFxcImZhIGZhLTJ4IGZhLXVuZG9cXFwiPjwvc3Bhbj48YnI+VW5kb1wiKTtcblxuICAgICAgICAvLyBkaXNhYmxlIGVkaXQgYnV0dG9uXG4gICAgICAgICQoXCIjXCIgKyBzaG9ydCArIFwiX2VkaXRidXR0b25fXCIgKyBpKS5yZW1vdmVDbGFzcyhcImxpc3QtZ3JvdXAtaXRlbS1pbmZvXCIpLmFkZENsYXNzKFwiZGlzYWJsZWRcIik7XG4gICAgICAgICQoXCIjXCIgKyBzaG9ydCArIFwiX2VkaXRidXR0b25fXCIgKyBpKS5vZmYoJ2NsaWNrJykub24oXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBkaXNhYmxlIHRoZSBEYXRlIGJ1dHRvblxuICAgICAgICAkKFwiI1wiICsgc2hvcnQgKyBcIl9kYXRlYnV0dG9uX1wiICsgaSkucmVtb3ZlQ2xhc3MoXCJsaXN0LWdyb3VwLWl0ZW0tc3VjY2Vzc1wiKS5hZGRDbGFzcyhcImRpc2FibGVkXCIpLnByb3AoJ2Rpc2FibGVkJywgdHJ1ZSk7XG5cbiAgICAgICAgLy8gZGlzYWJsZSB0aGUgU0NNIGJ1dHRvblxuICAgICAgICAkKFwiI1wiICsgc2hvcnQgKyBcIl9zY21idXR0b25fXCIgKyBpKS5yZW1vdmVDbGFzcyhcImxpc3QtZ3JvdXAtaXRlbS1zdWNjZXNzXCIpLmFkZENsYXNzKFwiZGlzYWJsZWRcIikucHJvcCgnZGlzYWJsZWQnLCB0cnVlKTtcblxuICAgIH0gZWxzZSB7XG4gICAgXHQvLyBzZXQgdW5kZWxldGVcbiAgICAgICAgJChcIiNcIiArIHNob3J0ICsgXCJfZGVsZXRlYnV0dG9uX1wiICsgaSkucmVtb3ZlQ2xhc3MoXCJsaXN0LWdyb3VwLWl0ZW0td2FybmluZ1wiKS5hZGRDbGFzcyhcImxpc3QtZ3JvdXAtaXRlbS1kYW5nZXJcIik7XG4gICAgICAgICQoXCIjXCIgKyBzaG9ydCArIFwiX2RlbGV0ZWJ1dHRvbl9cIiArIGkpLmh0bWwoXCI8c3BhbiBjbGFzcz1cXFwiZmEgZmEtMnggZmEtdHJhc2gtb1xcXCI+PC9zcGFuPjxicj5UcmFzaFwiKTtcblxuICAgICAgICAvLyByZXN0b3JlIGVkaXQgYnV0dG9uXG4gICAgICAgICQoXCIjXCIgKyBzaG9ydCArIFwiX2VkaXRidXR0b25fXCIgKyBpKS5hZGRDbGFzcyhcImxpc3QtZ3JvdXAtaXRlbS1pbmZvXCIpLnJlbW92ZUNsYXNzKFwiZGlzYWJsZWRcIik7XG4gICAgICAgICQoXCIjXCIgKyBzaG9ydCArIFwiX2VkaXRidXR0b25fXCIgKyBpKS5vZmYoJ2NsaWNrJykub24oXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgbWFrZUVkaXRhYmxlKHNob3J0LCBpKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gcmVzdG9yZSB0aGUgRGF0ZSBidXR0b25cbiAgICAgICAgJChcIiNcIiArIHNob3J0ICsgXCJfZGF0ZWJ1dHRvbl9cIiArIGkpLmFkZENsYXNzKFwibGlzdC1ncm91cC1pdGVtLXN1Y2Nlc3NcIikucmVtb3ZlQ2xhc3MoXCJkaXNhYmxlZFwiKS5wcm9wKCdkaXNhYmxlZCcsIGZhbHNlKTtcblxuICAgICAgICAvLyByZXN0b3JlIHRoZSBTQ00gYnV0dG9uXG4gICAgICAgICQoXCIjXCIgKyBzaG9ydCArIFwiX3NjbWJ1dHRvbl9cIiArIGkpLmFkZENsYXNzKFwibGlzdC1ncm91cC1pdGVtLXN1Y2Nlc3NcIikucmVtb3ZlQ2xhc3MoXCJkaXNhYmxlZFwiKS5wcm9wKCdkaXNhYmxlZCcsIGZhbHNlKTtcblxuICAgIH1cblxuICAgIHJldHVybiBzdWJTZXREZWxldGVkKHNob3J0LCBpKTtcbn1cblxuLyoqXG4gKiBNYWtlIHRoZSBkZWxldGUvdW5kZWxldGUgaGFwcGVuXG4gKlxuICogQWN0dWFsbHkgcGVyZm9ybXMgdGhlIGNoYW5nZXMgdG8gdGhlIG9iamVjdCwgYWZmZWN0aW5nIHRoZSBvcGVyYXRpb24gYW5kIHBhbmVsIGNvbG9yLlxuICpcbiAqIEBwYXJhbSBzdHJpbmcgc2hvcnROYW1lIFRoZSBzaG9ydCBuYW1lIG9mIHRoZSBkYXRhIG9iamVjdCwgc3VjaCBhcyBcIm5hbWVFbnRyeVwiIG9yIFwib2NjdXBhdGlvblwiXG4gKiBAcGFyYW0gc3RyaW5nfGludCBpICAgICBUaGUgaW5kZXggd2l0aGluIHRoZSBlZGl0IHBhZ2Ugb2YgdGhlIG9iamVjdC5cbiAqIEByZXR1cm4gYm9vbGVhbiAgICAgICAgIEZhbHNlIHRvIHBsYXkgbmljZSB3aXRoIHRoZSBicm93c2VyXG4gKi9cbmZ1bmN0aW9uIHN1YlNldERlbGV0ZWQoc2hvcnQsIGkpIHtcbiAgICBpZiAoJChcIiNcIiArIHNob3J0ICsgXCJfb3BlcmF0aW9uX1wiICsgaSkudmFsKCkgIT0gXCJkZWxldGVcIikge1xuICAgIFx0Ly8gc2V0IGRlbGV0ZWRcbiAgICBcdCQoXCIjXCIgKyBzaG9ydCArIFwiX3BhbmVsX1wiICsgaSkucmVtb3ZlQ2xhc3MoXCJwYW5lbC1kZWZhdWx0XCIpLmFkZENsYXNzKFwiYWxlcnQtZGFuZ2VyXCIpLmFkZENsYXNzKFwiZGVsZXRlZC1jb21wb25lbnRcIik7XG5cbiAgICAgICAgJChcIiNcIiArIHNob3J0ICsgXCJfb3BlcmF0aW9uX1wiICsgaSkudmFsKFwiZGVsZXRlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgXHQvLyBzZXQgdW5kZWxldGVcbiAgICBcdCQoXCIjXCIgKyBzaG9ydCArIFwiX3BhbmVsX1wiICsgaSkucmVtb3ZlQ2xhc3MoXCJhbGVydC1kYW5nZXJcIikuYWRkQ2xhc3MoXCJwYW5lbC1kZWZhdWx0XCIpLnJlbW92ZUNsYXNzKFwiZGVsZXRlZC1jb21wb25lbnRcIik7XG5cbiAgICAgICAgLy8gSWYgdGhpcyB0aGluZyB3YXMgZGVsZXRlZCBidXQgaXMgc3VwcG9zZWQgdG8gYmUgYW4gdXBkYXRlLCB0aGVuIHJldHVybiBpdCBiYWNrIHRvIHVwZGF0ZSBzdGF0dXNcbiAgICAgICAgdmFyIHNhd1NlbGVjdCA9IGZhbHNlO1xuICAgICAgICAkKFwic2VsZWN0W2lkXj0nXCIrc2hvcnQrXCJfJ11cIikuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBvYmogPSAkKHRoaXMpO1xuICAgICAgICAgICAgaWYob2JqLmF0dHIoJ2lkJykuZW5kc1dpdGgoXCJfXCIgKyBpKSAgJiYgIW9iai5hdHRyKCdpZCcpLmVuZHNXaXRoKFwiWlpcIikpIHtcbiAgICAgICAgICAgICAgICBzYXdTZWxlY3QgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHNhd1NlbGVjdCkge1xuICAgIFx0ICAgIGlmICgkKFwiI1wiICsgc2hvcnQgKyBcIl9pZF9cIiArIGkpLnZhbCgpICE9IFwiXCIpXG4gICAgXHQgICAgXHQkKFwiI1wiICsgc2hvcnQgKyBcIl9vcGVyYXRpb25fXCIgKyBpKS52YWwoXCJ1cGRhdGVcIik7XG4gICAgXHQgICAgZWxzZVxuICAgIFx0ICAgIFx0JChcIiNcIiArIHNob3J0ICsgXCJfb3BlcmF0aW9uX1wiICsgaSkudmFsKFwiaW5zZXJ0XCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICBcdCQoXCIjXCIgKyBzaG9ydCArIFwiX29wZXJhdGlvbl9cIiArIGkpLnZhbChcIlwiKTtcbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgLy8gQXNrZWQgdG8gZGVsZXRlIHNvbWV0aGluZywgc28gbWFrZSBpdCBnbG9iYWxseSBrbm93blxuICAgIHNldEVkaXRlZEZsYWcodHJ1ZSk7XG4gICAgLy9zb21ldGhpbmdIYXNCZWVuRWRpdGVkID0gdHJ1ZTtcblxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuLyoqXG4gKiBTZXQgYW4gU0NNIGRhdGEgb2JqZWN0IGFzIGRlbGV0ZWRcbiAqXG4gKiBTZXRzIGFuIFNDTSBvYmplY3QgKGopIGZvciBhIGNvbnN0ZWxsYXRpb24gb2JqZWN0IChzaG9ydCwgaSkgYXMgZGVsZXRlZCBvciB1bmRlbGV0ZWQgYW5kIG1ha2VzIHRoZSBhcHByb3ByaWF0ZSBjaGFuZ2VzIHRocm91Z2hvdXQgdGhlIHBhZ2UuXG4gKlxuICogQHBhcmFtIHN0cmluZyBzaG9ydE5hbWUgVGhlIHNob3J0IG5hbWUgb2YgdGhlIGRhdGEgb2JqZWN0LCBzdWNoIGFzIFwibmFtZUVudHJ5XCIgb3IgXCJvY2N1cGF0aW9uXCJcbiAqIEBwYXJhbSBzdHJpbmd8aW50IGkgICAgIFRoZSBpbmRleCB3aXRoaW4gdGhlIGVkaXQgcGFnZSBvZiB0aGUgb2JqZWN0LlxuICogQHBhcmFtIHN0cmluZ3xpbnQgaiAgICAgIFRoZSBpbmRleCB3aXRoaW4gdGhlIGRhdGEgb2JqZWN0IFNDTSBsaXN0IG9uIHRoZSBlZGl0IHBhZ2Ugb2YgdGhlIFNDTSBvYmplY3QuXG4gKi9cbmZ1bmN0aW9uIHNldFNDTURlbGV0ZWQoc2hvcnQsIGksIGopIHtcblx0dmFyIGlkID0gaiArICdfJyArIGk7XG4gICAgaWYgKCQoXCIjc2NtX1wiICsgc2hvcnQgKyBcIl9vcGVyYXRpb25fXCIgKyBpZCkudmFsKCkgIT0gXCJkZWxldGVcIikge1xuICAgIFx0Ly8gc2V0IGRlbGV0ZWRcbiAgICAgICAgJChcIiNzY21fXCIgKyBzaG9ydCArIFwiX2RlbGV0ZWJ1dHRvbl9cIiArIGlkKS5yZW1vdmVDbGFzcyhcImxpc3QtZ3JvdXAtaXRlbS1kYW5nZXJcIikuYWRkQ2xhc3MoXCJsaXN0LWdyb3VwLWl0ZW0td2FybmluZ1wiKTtcbiAgICAgICAgJChcIiNzY21fXCIgKyBzaG9ydCArIFwiX2RlbGV0ZWJ1dHRvbl9cIiArIGlkKS5odG1sKFwiPHNwYW4gY2xhc3M9XFxcImZhIGZhLXVuZG9cXFwiPjwvc3Bhbj5cIik7XG5cbiAgICAgICAgLy8gZGlzYWJsZSBlZGl0IGJ1dHRvblxuICAgICAgICAkKFwiI3NjbV9cIiArIHNob3J0ICsgXCJfZWRpdGJ1dHRvbl9cIiArIGlkKS5yZW1vdmVDbGFzcyhcImxpc3QtZ3JvdXAtaXRlbS1pbmZvXCIpLmFkZENsYXNzKFwiZGlzYWJsZWRcIik7XG4gICAgICAgICQoXCIjc2NtX1wiICsgc2hvcnQgKyBcIl9lZGl0YnV0dG9uX1wiICsgaWQpLm9mZignY2xpY2snKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0pO1xuXG4gICAgfSBlbHNlIHtcbiAgICBcdC8vIHNldCB1bmRlbGV0ZVxuICAgICAgICAkKFwiI3NjbV9cIiArIHNob3J0ICsgXCJfZGVsZXRlYnV0dG9uX1wiICsgaWQpLnJlbW92ZUNsYXNzKFwibGlzdC1ncm91cC1pdGVtLXdhcm5pbmdcIikuYWRkQ2xhc3MoXCJsaXN0LWdyb3VwLWl0ZW0tZGFuZ2VyXCIpO1xuICAgICAgICAkKFwiI3NjbV9cIiArIHNob3J0ICsgXCJfZGVsZXRlYnV0dG9uX1wiICsgaWQpLmh0bWwoXCI8c3BhbiBjbGFzcz1cXFwiZmEgZmEtdHJhc2gtb1xcXCI+PC9zcGFuPlwiKTtcblxuICAgICAgICAvLyByZXN0b3JlIGVkaXQgYnV0dG9uXG4gICAgICAgICQoXCIjc2NtX1wiICsgc2hvcnQgKyBcIl9lZGl0YnV0dG9uX1wiICsgaWQpLmFkZENsYXNzKFwibGlzdC1ncm91cC1pdGVtLWluZm9cIikucmVtb3ZlQ2xhc3MoXCJkaXNhYmxlZFwiKTtcbiAgICAgICAgJChcIiNzY21fXCIgKyBzaG9ydCArIFwiX2VkaXRidXR0b25fXCIgKyBpZCkub2ZmKCdjbGljaycpLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgIG1ha2VTQ01FZGl0YWJsZShzaG9ydCwgaSwgaik7XG4gICAgICAgIH0pO1xuXG4gICAgfVxuXG4gICAgcmV0dXJuIHN1YlNldERlbGV0ZWQoXCJzY21fXCIrc2hvcnQsIGlkKTtcbn1cblxuLyoqXG4gKiBUdXJuIG9uIHRoZSBFZGl0L0RlbGV0ZSBidXR0b25zIGZvciBhbiBvYmplY3RcbiAqXG4gKiBAcGFyYW0gc3RyaW5nIHNob3J0TmFtZSBUaGUgc2hvcnQgbmFtZSBvZiB0aGUgZGF0YSBvYmplY3QsIHN1Y2ggYXMgXCJuYW1lRW50cnlcIiBvciBcIm9jY3VwYXRpb25cIlxuICogQHBhcmFtIHN0cmluZ3xpbnQgaSAgICAgVGhlIGluZGV4IHdpdGhpbiB0aGUgZWRpdCBwYWdlIG9mIHRoZSBvYmplY3QuXG4gKi9cbmZ1bmN0aW9uIHR1cm5PbkJ1dHRvbnMoc2hvcnROYW1lLCBpKSB7XG5cbiAgICAvLyBUdXJuIG9uIHRoZSBlZGl0IGJ1dHRvblxuICAgICQoXCIjXCIrc2hvcnROYW1lK1wiX2VkaXRidXR0b25fXCIraSkub24oXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgbWFrZUVkaXRhYmxlKHNob3J0TmFtZSwgaSk7XG4gICAgfSk7XG5cbiAgICAvLyBUdXJuIG9uIHRoZSBkZWxldGUgYnV0dG9uc1xuICAgICQoXCIjXCIrc2hvcnROYW1lK1wiX2RlbGV0ZWJ1dHRvbl9cIitpKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICBzZXREZWxldGVkKHNob3J0TmFtZSwgaSk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIHR1cm5PblRvb2x0aXBzKHNob3J0TmFtZSwgaSkge1xuICAgIC8vIExvYWQgdG9vbHRpcHNcbiAgICAkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAkKCcjJytzaG9ydE5hbWUrJ19wYW5lbF8nKyBpICsnIFtkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIl0nKS50b29sdGlwKClcbiAgICB9KVxuXG4gICAgLy8gTG9hZCBwb3BvdmVyc1xuICAgICQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICQoJyMnK3Nob3J0TmFtZSsnX3BhbmVsXycrIGkgKycgW2RhdGEtdG9nZ2xlPVwicG9wb3ZlclwiXScpLnBvcG92ZXIoe1xuICAgICAgICAgICAgICAgIHRyaWdnZXI6ICdob3ZlcicsXG4gICAgICAgICAgICAgICAgY29udGFpbmVyOiAnYm9keSdcbiAgICAgICAgICB9KVxuICAgIH0pXG5cblxufVxuXG4vKipcbiAqIFR1cm4gb24gdGhlIEVkaXQvRGVsZXRlIGJ1dHRvbnMgZm9yIGFuIFNDTSBvYmplY3RcbiAqXG4gKiBAcGFyYW0gc3RyaW5nIHNob3J0TmFtZSBUaGUgc2hvcnQgbmFtZSBvZiB0aGUgZGF0YSBvYmplY3QsIHN1Y2ggYXMgXCJuYW1lRW50cnlcIiBvciBcIm9jY3VwYXRpb25cIlxuICogQHBhcmFtIHN0cmluZ3xpbnQgaSAgICAgVGhlIGluZGV4IHdpdGhpbiB0aGUgZWRpdCBwYWdlIG9mIHRoZSBvYmplY3QuXG4gKiBAcGFyYW0gc3RyaW5nfGludCBqICAgICAgVGhlIGluZGV4IHdpdGhpbiB0aGUgZGF0YSBvYmplY3QgU0NNIGxpc3Qgb24gdGhlIGVkaXQgcGFnZSBvZiB0aGUgU0NNIG9iamVjdC5cbiAqL1xuZnVuY3Rpb24gdHVybk9uU0NNQnV0dG9ucyhzaG9ydE5hbWUsIGksIGopIHtcblxuICAgIC8vIFR1cm4gb24gdGhlIGVkaXQgYnV0dG9uXG4gICAgJChcIiNzY21fXCIrc2hvcnROYW1lK1wiX2VkaXRidXR0b25fXCIraitcIl9cIitpKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICBtYWtlU0NNRWRpdGFibGUoc2hvcnROYW1lLCBpLCBqKTtcbiAgICB9KTtcblxuICAgIC8vIFR1cm4gb24gdGhlIGRlbGV0ZSBidXR0b25zXG4gICAgJChcIiNzY21fXCIrc2hvcnROYW1lK1wiX2RlbGV0ZWJ1dHRvbl9cIitqK1wiX1wiK2kpLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHNldFNDTURlbGV0ZWQoc2hvcnROYW1lLCBpLCBqKTtcbiAgICB9KTtcbn1cblxuLyoqXG4gKiBDcmVhdGUgYSBuZXcgQWRkcmVzcyBMaW5lIG9iamVjdCBvbiBwYWdlXG4gKlxuICogUHV0cyBhIG5ldyBQbGFjZSBBZGRyZXNzIExpbmUgb2JqZWN0IERJViBvbiB0aGUgcGFnZSBhbmQgYXR0YWNoZXMgaXQgY29ycmVjdGx5IHRvIHRoZSBET00gYW5kIGphdmFzY3JpcHQuXG4gKlxuICogQHBhcmFtICBpbnQgICAgIGkgICAgVGhlIGluZGV4IG9uIHRoZSBwYWdlIG9mIHRoZSBwbGFjZSB0byBhZGQgdGhpcyBjb21wb25lbnQgdG9cbiAqIEByZXR1cm4gYm9vbGVhbiAgICAgIGZhbHNlIHRvIHBsYXkgbmljZSB3aXRoIHRoZSBicm93c2VyLlxuICovXG5leHBvcnQgZnVuY3Rpb24gbmV3QWRkcmVzc0xpbmUoaSkge1xuXHR2YXIgbmV4dGlkID0gMTtcblx0aWYgKCQoJyNwbGFjZV9hZGRyZXNzX25leHRfal8nK2kpLmV4aXN0cygpKSB7XG5cdCAgICBuZXh0aWQgPSBwYXJzZUludCgkKCcjcGxhY2VfYWRkcmVzc19uZXh0X2pfJytpKS50ZXh0KCkpO1xuXHR9XG5cdGNvbnNvbGUubG9nKFwiQ3JlYXRpbmcgbmV3IGFkZHJlc3MgbGluZSBmb3IgcGxhY2UgXCIgKyBpICsgXCIgd2l0aCBpZDogXCIgKyBuZXh0aWQpO1xuICAgIHNldEVkaXRlZEZsYWcodHJ1ZSk7XG4gICAgLy9zb21ldGhpbmdIYXNCZWVuRWRpdGVkID0gdHJ1ZTtcbiAgICB2YXIgdGV4dCA9ICQoJyNhZGRyZXNzbGluZV90ZW1wbGF0ZScpLmNsb25lKCk7XG4gICAgdmFyIGh0bWwgPSB0ZXh0Lmh0bWwoKS5yZXBsYWNlKC9aWi9nLCBpKS5yZXBsYWNlKC9ZWS9nLCBuZXh0aWQpO1xuICAgICQoJyNwbGFjZV9hZGRyZXNzX2FkZF9kaXZfJytpKS5iZWZvcmUoaHRtbCk7XG5cbiAgICAkKCcjcGxhY2VfYWRkcmVzc18nICsgbmV4dGlkICsgJ19vcGVyYXRpb25fJyArIDEpLnZhbChcImluc2VydFwiKTtcbiAgICBzdWJNYWtlRWRpdGFibGUoXCJwbGFjZV9hZGRyZXNzX1wiICsgbmV4dGlkLCBpKTtcblxuICAgIHZvY2FiX3NlbGVjdF9yZXBsYWNlKCQoXCIjcGxhY2VfYWRkcmVzc19cIituZXh0aWQrXCJfdHlwZV9pZF9cIitpKSwgXCJfXCIraSwgJ2FkZHJlc3NfcGFydCcsIDApO1xuXG4gICAgLy8gUHV0IHRoZSB1cGRhdGVkIHZlcnNpb24gbnVtYmVyIGJhY2sgaW4gdGhlIERPTVxuICAgICQoJyNwbGFjZV9hZGRyZXNzX25leHRfal8nK2kpLnRleHQoKytuZXh0aWQpO1xuXG4gICAgcmV0dXJuIGZhbHNlO1xufVxuXG4vKipcbiAqIENyZWF0ZSBhIG5ldyBSZXNvdXJjZSBSZWxhdGlvbiBPcmlnaW5hdGlvbiBOYW1lIG9iamVjdCBvbiBwYWdlXG4gKlxuICogUHV0cyBhIG5ldyBSZXNvdXJjZSBSZWxhdGlvbiBPcmlnaW5hdGlvbiBOYW1lIG9iamVjdCBESVYgb24gdGhlIHBhZ2UgYW5kIGF0dGFjaGVzIGl0IGNvcnJlY3RseSB0byB0aGUgRE9NIGFuZCBqYXZhc2NyaXB0LlxuICpcbiAqIEBwYXJhbSAgaW50ICAgICBpICAgIFRoZSBpbmRleCBvbiB0aGUgcGFnZSBvZiB0aGUgUmVzb3VyY2UgUmVsYXRpb24gdG8gYWRkIHRoaXMgT3JpZ2luYXRpb24gTmFtZSB0b1xuICogQHJldHVybiBib29sZWFuICAgICAgZmFsc2UgdG8gcGxheSBuaWNlIHdpdGggdGhlIGJyb3dzZXIuXG4gKi9cbmZ1bmN0aW9uIG5ld09yaWdpbmF0aW9uTmFtZShpKSB7XG5cdHZhciBuZXh0aWQgPSAxO1xuXHRpZiAoJCgnI3Jlc291cmNlX29yaWdpbmF0aW9uTmFtZV9uZXh0X2pfJytpKS5leGlzdHMoKSkge1xuXHQgICAgbmV4dGlkID0gcGFyc2VJbnQoJCgnI3Jlc291cmNlX29yaWdpbmF0aW9uTmFtZV9uZXh0X2pfJytpKS50ZXh0KCkpO1xuXHR9XG5cdGNvbnNvbGUubG9nKFwiQ3JlYXRpbmcgbmV3IG9yaWdpbmF0aW9uIG5hbWUgZm9yIHJlc291cmNlIFwiICsgaSArIFwiIHdpdGggaWQ6IFwiICsgbmV4dGlkKTtcbiAgICBzZXRFZGl0ZWRGbGFnKHRydWUpO1xuICAgIC8vc29tZXRoaW5nSGFzQmVlbkVkaXRlZCA9IHRydWU7XG4gICAgdmFyIHRleHQgPSAkKCcjb3JpZ2luYXRpb25OYW1lX3RlbXBsYXRlJykuY2xvbmUoKTtcbiAgICB2YXIgaHRtbCA9IHRleHQuaHRtbCgpLnJlcGxhY2UoL1paL2csIGkpLnJlcGxhY2UoL1lZL2csIG5leHRpZCk7XG4gICAgJCgnI3Jlc291cmNlX29yaWdpbmF0aW9uTmFtZV9hZGRfZGl2XycraSkuYmVmb3JlKGh0bWwpO1xuXG4gICAgJCgnI3Jlc291cmNlX29yaWdpbmF0aW9uTmFtZV8nICsgbmV4dGlkICsgJ19vcGVyYXRpb25fJyArIDEpLnZhbChcImluc2VydFwiKTtcbiAgICBzdWJNYWtlRWRpdGFibGUoXCJyZXNvdXJjZV9vcmlnaW5hdGlvbk5hbWVfXCIgKyBuZXh0aWQsIGkpO1xuXG4gICAgLy8gUHV0IHRoZSB1cGRhdGVkIHZlcnNpb24gbnVtYmVyIGJhY2sgaW4gdGhlIERPTVxuICAgICQoJyNyZXNvdXJjZV9vcmlnaW5hdGlvbk5hbWVfbmV4dF9qXycraSkudGV4dCgrK25leHRpZCk7XG5cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cblxuLyoqXG4gKiBDcmVhdGUgYSBuZXcgTmFtZSBFbnRyeSBDb21wb25lbnQgb2JqZWN0IG9uIHBhZ2VcbiAqXG4gKiBQdXRzIGEgbmV3IE5hbWUgRW50cnkgY29tcG9uZW50IG9iamVjdCBESVYgb24gdGhlIHBhZ2UgYW5kIGF0dGFjaGVzIGl0IGNvcnJlY3RseSB0byB0aGUgRE9NIGFuZCBqYXZhc2NyaXB0LlxuICpcbiAqIEBwYXJhbSAgaW50ICAgICBpICAgIFRoZSBpbmRleCBvbiB0aGUgcGFnZSBvZiB0aGUgbmFtZUVudHJ5IHRvIGFkZCB0aGlzIGNvbXBvbmVudCB0b1xuICogQHJldHVybiBib29sZWFuICAgICAgZmFsc2UgdG8gcGxheSBuaWNlIHdpdGggdGhlIGJyb3dzZXIuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBuZXdOYW1lRW50cnlDb21wb25lbnQoaSkge1xuICAgIHJlbW92ZVBhcnNlckJ1dHRvbihpKTtcblx0dmFyIG5leHRpZCA9IDE7XG5cdGlmICgkKCcjbmFtZUVudHJ5X2NvbXBvbmVudF9uZXh0X2pfJytpKS5leGlzdHMoKSkge1xuXHQgICAgbmV4dGlkID0gcGFyc2VJbnQoJCgnI25hbWVFbnRyeV9jb21wb25lbnRfbmV4dF9qXycraSkudGV4dCgpKTtcblx0fVxuXHRjb25zb2xlLmxvZyhcIkNyZWF0aW5nIG5ldyBuYW1lIGVudHJ5IGNvbXBvbmVudCBmb3IgbmFtZUVudHJ5IFwiICsgaSArIFwiIHdpdGggaWQ6IFwiICsgbmV4dGlkKTtcblxuICAgIC8vIGFkZCBwYXJzZXIgYnRuIGlmIGVudGl0eSBpcyBwZXJzb24sIGFuZCBpZiBubyBidG4gb3Igb3RoZXIgbmFtZSBjb21wb25lbnRzIGFscmVhZHkgZXhpc3RcbiAgICBpZiAoKCQoXCIjZW50aXR5VHlwZVwiKS52YWwoKSA9PT0gXCI3MDBcIikgJiYgKG5leHRpZCA9PSAwKSAmJlxuICAgICAgICAoISQoXCIjbmFtZUVudHJ5X3BhbmVsX1wiICsgaSkuZmluZCgnLm5hbWUtcGFyc2VyJykubGVuZ3RoICYmXG4gICAgICAgICAgICAkKFwiI25hbWVFbnRyeV9jb21wb25lbnRfMV9wYW5lbF9cIiArIGkpLmxlbmd0aCA9PT0gMCkpIHtcbiAgICAgICAgJCgnI25hbWVFbnRyeV9jb21wb25lbnRfYWRkXycgKyBpKS5hZnRlcignPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeSBuYW1lLXBhcnNlclwiIGlkPVwibmFtZUVudHJ5X3BhcnNlXycgKyBpICtcbiAgICAgICAgICAgICdcIiBzdHlsZT1cIm1hcmdpbi1sZWZ0OjVweDtcIj4gPGkgY2xhc3M9XCJmYSBmYS1tYWdpY1wiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT4gUGFyc2UgPC9idXR0b24+Jyk7XG4gICAgfVxuXG4gICAgc2V0RWRpdGVkRmxhZyh0cnVlKTtcbiAgICAvL3NvbWV0aGluZ0hhc0JlZW5FZGl0ZWQgPSB0cnVlO1xuXG4gICAgdmFyIHRleHQgPSAkKCcjY29tcG9uZW50X3RlbXBsYXRlJykuY2xvbmUoKTtcbiAgICB2YXIgaHRtbCA9IHRleHQuaHRtbCgpLnJlcGxhY2UoL1paL2csIGkpLnJlcGxhY2UoL1lZL2csIG5leHRpZCk7XG4gICAgJCgnI25hbWVFbnRyeV9jb21wb25lbnRfYWRkX2Rpdl8nK2kpLmJlZm9yZShodG1sKTtcblxuICAgICQoJyNuYW1lRW50cnlfY29tcG9uZW50XycgKyBuZXh0aWQgKyAnX29wZXJhdGlvbl8nICsgMSkudmFsKFwiaW5zZXJ0XCIpO1xuICAgIHN1Yk1ha2VFZGl0YWJsZShcIm5hbWVFbnRyeV9jb21wb25lbnRfXCIgKyBuZXh0aWQsIGkpO1xuXG4gICAgdm9jYWJfc2VsZWN0X3JlcGxhY2UoJChcIiNuYW1lRW50cnlfY29tcG9uZW50X1wiK25leHRpZCtcIl90eXBlX2lkX1wiK2kpLCBcIl9cIitpLCAnbmFtZV9jb21wb25lbnQnLCAwKTtcblxuICAgIC8vIFB1dCB0aGUgdXBkYXRlZCB2ZXJzaW9uIG51bWJlciBiYWNrIGluIHRoZSBET01cbiAgICAkKCcjbmFtZUVudHJ5X2NvbXBvbmVudF9uZXh0X2pfJytpKS50ZXh0KCsrbmV4dGlkKTtcblxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZU5hbWVFbnRyeUhlYWRpbmcoaSkge1xuICAgIHZhciB0ZXh0ID0gXCJcIjtcbiAgICB2YXIgY29tcG9uZW50cyA9IFtdO1xuXG4gICAgJChcIiNuYW1lRW50cnlfcGFuZWxfXCIraStcIiBkaXZbaWRePSduYW1lRW50cnlfY29tcG9uZW50XyddXCIpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBvYmogPSAkKHRoaXMpO1xuICAgICAgICBpZiAoIW9iai5oYXNDbGFzcyhcImRlbGV0ZWQtY29tcG9uZW50XCIpICYmIG9iai5hdHRyKCdpZCcpLmVuZHNXaXRoKFwiX3BhbmVsX1wiICsgaSlcbiAgICAgICAgICAgICAgICAmJiAhb2JqLmF0dHIoJ2lkJykuZW5kc1dpdGgoXCJaWlwiKSkge1xuICAgICAgICAgICAgdmFyIGogPSBvYmouYXR0cignaWQnKS5yZXBsYWNlKFwibmFtZUVudHJ5X2NvbXBvbmVudF9cIiwgXCJcIikucmVwbGFjZShcIl9wYW5lbF9cIitpLCBcIlwiKTtcbiAgICAgICAgICAgIHZhciB0eXBlID0gJChcIiNuYW1lRW50cnlfY29tcG9uZW50X1wiK2orXCJfdHlwZV9pZF9cIitpK1wiIG9wdGlvbjpzZWxlY3RlZFwiKS50ZXh0KCk7XG4gICAgICAgICAgICB2YXIgcGFydFRleHQgPSAkKFwiI25hbWVFbnRyeV9jb21wb25lbnRfXCIraitcIl90ZXh0X1wiK2kpLnZhbCgpO1xuXG4gICAgICAgICAgICBjb21wb25lbnRzLnB1c2goW3R5cGUsIHBhcnRUZXh0XSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHZhciBlbnRpdHlUeXBlID0gJChcIiNlbnRpdHlUeXBlIG9wdGlvbjpzZWxlY3RlZFwiKS50ZXh0KCk7XG4gICAgdGV4dCA9IGNvbWJpbmVOYW1lSGVhZGluZyhjb21wb25lbnRzLCBlbnRpdHlUeXBlKTtcblxuXG4gICAgJChcIiNuYW1lRW50cnlfaGVhZGluZ19cIitpKS50ZXh0KHRleHQudHJpbSgpKTtcbiAgICAkKFwiI25hbWVFbnRyeV9vcmlnaW5hbF9cIitpKS52YWwodGV4dC50cmltKCkpO1xufVxuXG5cbi8qKlxuICogQ3JlYXRlIGEgbmV3IE5hbWUgRW50cnkgUnVsZXMgb2JqZWN0IG9uIHBhZ2VcbiAqXG4gKiBQdXRzIGEgbmV3IE5hbWUgRW50cnkgcnVsZSBvYmplY3QgRElWIG9uIHRoZSBwYWdlIGFuZCBhdHRhY2hlcyBpdCBjb3JyZWN0bHkgdG8gdGhlIERPTSBhbmQgamF2YXNjcmlwdC5cbiAqXG4gKiBAcGFyYW0gIGludCAgICAgaSAgICBUaGUgaW5kZXggb24gdGhlIHBhZ2Ugb2YgdGhlIG5hbWVFbnRyeSB0byBhZGQgdGhpcyBydWxlIHRvXG4gKiBAcmV0dXJuIGJvb2xlYW4gICAgICBmYWxzZSB0byBwbGF5IG5pY2Ugd2l0aCB0aGUgYnJvd3Nlci5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG5ld05hbWVFbnRyeVJ1bGUoaSkge1xuXHR2YXIgbmV4dGlkID0gMTtcblx0aWYgKCQoJyNuYW1lRW50cnlfcnVsZV9uZXh0X2pfJytpKS5leGlzdHMoKSkge1xuXHQgICAgbmV4dGlkID0gcGFyc2VJbnQoJCgnI25hbWVFbnRyeV9ydWxlX25leHRfal8nK2kpLnRleHQoKSk7XG5cdH1cblx0Y29uc29sZS5sb2coXCJDcmVhdGluZyBuZXcgbmFtZSBlbnRyeSBydWxlIGZvciBuYW1lRW50cnkgXCIgKyBpICsgXCIgd2l0aCBpZDogXCIgKyBuZXh0aWQpO1xuICAgIHNldEVkaXRlZEZsYWcodHJ1ZSk7XG4gICAgLy9zb21ldGhpbmdIYXNCZWVuRWRpdGVkID0gdHJ1ZTtcbiAgICB2YXIgdGV4dCA9ICQoJyNydWxlX3RlbXBsYXRlJykuY2xvbmUoKTtcbiAgICB2YXIgaHRtbCA9IHRleHQuaHRtbCgpLnJlcGxhY2UoL1paL2csIGkpLnJlcGxhY2UoL1lZL2csIG5leHRpZCk7XG4gICAgJCgnI25hbWVFbnRyeV9ydWxlX2FkZF9kaXZfJytpKS5iZWZvcmUoaHRtbCk7XG5cbiAgICAkKCcjbmFtZUVudHJ5X3J1bGVfJyArIG5leHRpZCArICdfb3BlcmF0aW9uXycgKyAxKS52YWwoXCJpbnNlcnRcIik7XG4gICAgdHVybk9uVG9vbHRpcHMoXCJuYW1lRW50cnlfcnVsZV9cIiArIG5leHRpZCwgaSk7XG4gICAgc3ViTWFrZUVkaXRhYmxlKFwibmFtZUVudHJ5X3J1bGVfXCIgKyBuZXh0aWQsIGkpO1xuXG4gICAgLy8gUHV0IHRoZSB1cGRhdGVkIHZlcnNpb24gbnVtYmVyIGJhY2sgaW4gdGhlIERPTVxuICAgICQoJyNuYW1lRW50cnlfcnVsZV9uZXh0X2pfJytpKS50ZXh0KCsrbmV4dGlkKTtcblxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuLyoqXG4gKiBQYXJzZSBhIGRhdGUgc3RyaW5nIGludG8gcGFydHNcbiAqL1xuZnVuY3Rpb24gcGFyc2VEYXRlKGRhdGVTdHJpbmcpIHtcbiAgIHZhciBwaWVjZXMgPSBkYXRlU3RyaW5nLnNwbGl0KFwiLVwiKTtcbiAgIGlmIChwaWVjZXMubGVuZ3RoID09IDMpXG4gICAgICByZXR1cm4ge1xuICAgICAgICAgIHllYXIgOiBwYXJzZUludChwaWVjZXNbMF0pLFxuICAgICAgICAgIG1vbnRoIDogcGFyc2VJbnQocGllY2VzWzFdKSxcbiAgICAgICAgICBkYXkgOiBwYXJzZUludChwaWVjZXNbMl0pXG4gICAgICB9O1xuICAgZWxzZSBpZiAocGllY2VzLmxlbmd0aCA9PSAyKVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB5ZWFyIDogcGFyc2VJbnQocGllY2VzWzBdKSxcbiAgICAgICAgICBtb250aCA6IHBhcnNlSW50KHBpZWNlc1sxXSksXG4gICAgICAgICAgZGF5IDogJydcbiAgICAgIH07XG4gICBlbHNlIGlmIChwaWVjZXMubGVuZ3RoID09IDEgJiYgcGllY2VzWzBdICE9ICcnKVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB5ZWFyIDogcGFyc2VJbnQocGllY2VzWzBdKSxcbiAgICAgICAgICBtb250aCA6ICcnLFxuICAgICAgICAgIGRheSA6ICcnXG4gICAgICB9O1xuICAgZWxzZSByZXR1cm4ge1xuICAgICAgIHllYXIgOiAnJywgbW9udGggOiAnJywgZGF5IDogJydcbiAgIH1cbn1cblxuLyoqXG4gKiBDaGFuZ2UgZGF0ZSBpbnB1dCBkaXZzIHRvIHNlbGVjdCBhbmQgYm94ZXNcbiAqXG4gKiBDaGFuZ2VzIGFsbCBkaXYncyB3aXRoIGlkIFwiZGF0ZV9cIiBmb3IgYSBnaXZlbiBkYXRhIG9iamVjdCAoc2hvcnROYW1lLCBpZFN0cikgZnJvbSBhIGxpc3Qgb2ZcbiAqIGlucHV0cyBkZWZpbmluZyB0aGUgcGFyYW1ldGVycyAodmlldyBtb2RlKSB0byBhIGlucHV0cyBhbmQgYSBzZWxlY3QgKGVkaXQgbW9kZSkuICBJdCB0aGVuXG4gKiBjYWxscyB0aGUgc2VsZWN0MiBmdW5jdGlvbiB0byByZXBsYWNlIHRoZSBzZWxlY3Qgd2l0aCBvbmUgbWF0Y2hpbmcgdGhlIHJlc3Qgb2YgdGhlIHBhZ2UuXG4gKlxuICogTm90ZTogaWRTdHIgbXVzdCBub3QgaGF2ZSB0aGUgXCJfXCIgcHJlLWFwcGVuZGVkXG4gKlxuICogQHBhcmFtIHN0cmluZyBzaG9ydE5hbWUgVGhlIHNob3J0IG5hbWUgb2YgdGhlIGRhdGEgb2JqZWN0LCBzdWNoIGFzIFwibmFtZUVudHJ5XCIgb3IgXCJvY2N1cGF0aW9uXCJcbiAqIEBwYXJhbSBzdHJpbmd8aW50IGlkU3RyIFRoZSBpbmRleCB3aXRoaW4gdGhlIGVkaXQgcGFnZSBvZiB0aGUgb2JqZWN0LlxuICovXG5mdW5jdGlvbiB0ZXh0VG9EYXRlKHNob3J0TmFtZSwgaWRTdHIpIHtcbiAgICAkKFwiZGl2W2lkXj0nZGF0ZV9cIitzaG9ydE5hbWUrXCInXVwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY29udCA9ICQodGhpcyk7XG4gICAgICAgIGlmKGNvbnQuYXR0cignaWQnKS5lbmRzV2l0aChcIl9cIitpZFN0cikgJiYgIWNvbnQuYXR0cignaWQnKS5lbmRzV2l0aChcIlpaXCIpKSB7XG4gICAgICAgICAgICAvLyByZW1vdmUgdGhlIHNob3J0IG5hbWUgYW5kIFwic2VsZWN0X1wiIGZyb20gdGhlIHN0cmluZyB3ZSdyZSBwYXJzaW5nXG4gICAgICAgICAgICB2YXIgZGl2U3RyID0gY29udC5hdHRyKCdpZCcpLnJlcGxhY2UoXCJkYXRlX1wiLCBcIlwiKS5yZXBsYWNlKHNob3J0TmFtZSArIFwiX1wiLCBcIlwiKTtcbiAgICAgICAgICAgIC8vIHJlbW92ZSB0aGUgaWRzdHIgdG8gcmVjZWl2ZSB0aGUgbmFtZSBvZiB0aGlzIGVsZW1lbnRcbiAgICAgICAgICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAoXCJcXF9cIitpZFN0citcIiRcIiwgXCJnXCIpO1xuICAgICAgICAgICAgdmFyIG5hbWUgPSBkaXZTdHIucmVwbGFjZShyZWdleCwgXCJcIik7XG4gICAgICAgICAgICB2YXIgZGF0ZVN0ciA9ICQoXCIjXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfXCIraWRTdHIpLnZhbCgpO1xuXG4gICAgICAgICAgICB2YXIgZGF0ZVBhcnRzID0gcGFyc2VEYXRlKGRhdGVTdHIpO1xuXG4gICAgICAgICAgICB2YXIgaHRtbCA9IFwiPGlucHV0IHR5cGU9J3RleHQnIHNpemU9JzQnIHN0eWxlPSd3aWR0aDoyMCU7ZGlzcGxheTppbmxpbmU7JyBwbGFjZWhvbGRlcj0nWVlZWScgaWQ9J1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX3llYXJfXCIraWRTdHIrXCInIGNsYXNzPSdmb3JtLWNvbnRyb2wnIHZhbHVlPSdcIitkYXRlUGFydHMueWVhcitcIic+XCI7XG4gICAgICAgICAgICBodG1sICs9IFwiPHNwYW4gY2xhc3M9J2Zvcm0tY29udHJvbC1zdGF0aWMnPiAtIDwvc3Bhbj5cIjtcbiAgICAgICAgICAgIGh0bWwgKz0gXCI8c2VsZWN0IGlkPSdcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9tb250aF9cIitpZFN0citcIicgY2xhc3M9J2Zvcm0tY29udHJvbCcgZGF0YS1wbGFjZWhvbGRlcj0nTW9udGgnIHN0eWxlPSd3aWR0aDogNTclOyBtYXJnaW4tYm90dG9tOiA1cHg7IGRpc3BsYXk6IGlubGluZS1ibG9jazsnPlwiK1xuICAgICAgICAgICAgICAgICAgICBcIjxvcHRpb24+PC9vcHRpb24+XCI7XG4gICAgICAgICAgICB2YXIgbW9udGhzID0gW1wiSmFudWFyeVwiLCBcIkZlYnJ1YXJ5XCIsIFwiTWFyY2hcIiwgXCJBcHJpbFwiLCBcIk1heVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiSnVuZVwiLCBcIkp1bHlcIiwgXCJBdWd1c3RcIiwgXCJTZXB0ZW1iZXJcIiwgXCJPY3RvYmVyXCIsIFwiTm92ZW1iZXJcIiwgXCJEZWNlbWJlclwiXTtcblxuICAgICAgICAgICAgbW9udGhzLmZvckVhY2goZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAgICAgICAgICAgIHZhciBtSW50ID0ga2V5ICsgMTtcblxuICAgICAgICAgICAgICAgIGlmIChtSW50ID09IGRhdGVQYXJ0cy5tb250aClcbiAgICAgICAgICAgICAgICAgICAgaHRtbCArPSBcIjxvcHRpb24gdmFsdWU9XFxcIlwiK21JbnQrXCJcXFwiIHNlbGVjdGVkPlwiK3ZhbHVlK1wiPC9vcHRpb24+XCI7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBodG1sICs9IFwiPG9wdGlvbiB2YWx1ZT1cXFwiXCIrbUludCtcIlxcXCI+XCIrdmFsdWUrXCI8L29wdGlvbj5cIjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaHRtbCArPSBcIjxzZWxlY3Q+IFwiO1xuICAgICAgICAgICAgaHRtbCArPSBcIjxzcGFuIGNsYXNzPSdmb3JtLWNvbnRyb2wtc3RhdGljJz4gLSA8L3NwYW4+XCI7XG4gICAgICAgICAgICBodG1sICs9IFwiPGlucHV0IHR5cGU9J3RleHQnIHN0eWxlPSd3aWR0aDoxNCU7ZGlzcGxheTppbmxpbmU7JyBzaXplPScyJyBwbGFjZWhvbGRlcj0nREQnIGlkPSdcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9kYXlfXCIraWRTdHIrXCInIGNsYXNzPSdmb3JtLWNvbnRyb2wnIHZhbHVlPSdcIitkYXRlUGFydHMuZGF5K1wiJz4gXCI7XG4gICAgICAgICAgICBodG1sICs9IFwiPGlucHV0IHR5cGU9J2hpZGRlbicgaWQ9J1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX1wiK2lkU3RyK1wiJyBuYW1lPSdcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9cIitpZFN0citcIicgdmFsdWU9J1wiK2RhdGVTdHIrXCInPlwiO1xuICAgICAgICAgICAgY29udC5odG1sKGh0bWwpO1xuXG4gICAgICAgICAgICAkKFwiI1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX21vbnRoX1wiK2lkU3RyKS5zZWxlY3QyKHtcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6ICc1NyUnLFxuICAgICAgICAgICAgICAgICAgICBhbGxvd0NsZWFyOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB0aGVtZTogJ2Jvb3RzdHJhcCcsXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAnTW9udGgnXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfVxuICAgIH0pO1xufVxuXG4vKipcbiAqIFBhZCBhbiBpbnRlZ2VyXG4gKlxuICogVGhpcyBpcyBhIGhlbHBlciBmdW5jdGlvbiB0byBwYWQgYW4gaW50ZWdlciB3aXRoIDBzIGZvciBkaXNwbGF5LiAgVGhpcyBpcyB1c2VmdWwgdG8gcGFkXG4gKiBhIG1vbnRoIG9yIGRheSB3aXRoIGEgbGVhZGluZyAwLlxuICpcbiAqIEBwYXJhbSBpbnR8c3RyaW5nIG51bSBUaGUgbnVtYmVyIHRvIHBhZFxuICogQHBhcmFtIGludCBzaXplIFRoZSB0b3RhbCB3aWR0aCBvZiB0aGUgZGVzaXJlZCBvdXRwdXRcbiAqIEByZXR1cm4gc3RyaW5nIEEgc3RyaW5nIGNvbnRhaW5pbmcgYSBzaXplLXdpZGUgaW50ZWdlciByZXByZXNlbnRhdGlvbiwgMC1wYWRkZWRcbiAqL1xuZnVuY3Rpb24gcGFkKG51bSwgc2l6ZSkge1xuICAgIHZhciBzID0gbnVtK1wiXCI7XG4gICAgd2hpbGUgKHMubGVuZ3RoIDwgc2l6ZSkgcyA9IFwiMFwiICsgcztcbiAgICByZXR1cm4gcztcbn1cblxuLyoqXG4gKiBVcGRhdGVzIHRoZSBzdGFuZGFyZCBkYXRlIGlucHV0IGZpZWxkXG4gKlxuICogSWYgdGhlIGRhdGUgZm9yIHRoZSBkYXRhIG9iamVjdCAoc2hvcnROYW1lLCBpZFN0cikgaGFzIGJlZW4gdHVybmVkIGludG8gYSAzLWZpZWxkIGVkaXRcbiAqIGFyZWEsIHRoZW4gdGhpcyBmdW5jdGlvbiB3aWxsIHVwZGF0ZSB0aGUgaGlkZGVuIHN0YW5kYXJkIGRhdGUgKFlZWVktTU0tREQpIGZpZWxkIHdpdGggdGhlXG4gKiBuZXdlc3QgdmFsdWVzIGZyb20gdGhlIGh1bWFuLWVudGVyYWJsZSBmaWVsZC5cbiAqXG4gKiBOb3RlOiBpZFN0ciBtdXN0IG5vdCBoYXZlIHRoZSBcIl9cIiBwcmUtYXBwZW5kZWRcbiAqXG4gKiBAcGFyYW0gc3RyaW5nIHNob3J0TmFtZSBUaGUgc2hvcnQgbmFtZSBvZiB0aGUgZGF0YSBvYmplY3QsIHN1Y2ggYXMgXCJuYW1lRW50cnlcIiBvciBcIm9jY3VwYXRpb25cIlxuICogQHBhcmFtIHN0cmluZ3xpbnQgaWRTdHIgVGhlIGluZGV4IHdpdGhpbiB0aGUgZWRpdCBwYWdlIG9mIHRoZSBvYmplY3QuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVEYXRlKHNob3J0TmFtZSwgaWRTdHIpIHtcbiAgICAkKFwiZGl2W2lkXj0nZGF0ZV9cIitzaG9ydE5hbWUrXCInXVwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY29udCA9ICQodGhpcyk7XG4gICAgICAgIGlmKGNvbnQuYXR0cignaWQnKS5lbmRzV2l0aChcIl9cIitpZFN0cikgJiYgIWNvbnQuYXR0cignaWQnKS5lbmRzV2l0aChcIlpaXCIpKSB7XG4gICAgICAgICAgICAvLyByZW1vdmUgdGhlIHNob3J0IG5hbWUgYW5kIFwic2VsZWN0X1wiIGZyb20gdGhlIHN0cmluZyB3ZSdyZSBwYXJzaW5nXG4gICAgICAgICAgICB2YXIgZGl2U3RyID0gY29udC5hdHRyKCdpZCcpLnJlcGxhY2UoXCJkYXRlX1wiLCBcIlwiKS5yZXBsYWNlKHNob3J0TmFtZSArIFwiX1wiLCBcIlwiKTtcbiAgICAgICAgICAgIC8vIHJlbW92ZSB0aGUgaWRzdHIgdG8gcmVjZWl2ZSB0aGUgbmFtZSBvZiB0aGlzIGVsZW1lbnRcbiAgICAgICAgICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAoXCJcXF9cIitpZFN0citcIiRcIiwgXCJnXCIpO1xuICAgICAgICAgICAgdmFyIG5hbWUgPSBkaXZTdHIucmVwbGFjZShyZWdleCwgXCJcIik7XG5cbiAgICAgICAgICAgIGlmICgkKFwiI1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX3llYXJfXCIraWRTdHIpLmV4aXN0cygpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHllYXIgPSAkKFwiI1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX3llYXJfXCIraWRTdHIpLnZhbCgpO1xuICAgICAgICAgICAgICAgIHZhciBkYXkgPSAkKFwiI1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX2RheV9cIitpZFN0cikudmFsKCk7XG4gICAgICAgICAgICAgICAgdmFyIG1vbnRoID0gJChcIiNcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9tb250aF9cIitpZFN0cisgXCIgb3B0aW9uOnNlbGVjdGVkXCIpLnZhbCgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGRhdGVTdHIgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmICh5ZWFyICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0ZVN0ciArPSBwYWQoeWVhciwgNCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtb250aCAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlU3RyICs9IFwiLVwiICsgcGFkKG1vbnRoLDIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRheSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZVN0ciArPSBcIi1cIiArIHBhZChkYXksMik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAkKFwiI1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX1wiK2lkU3RyKS52YWwoZGF0ZVN0cik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgIH0pO1xufVxuXG4vKipcbiAqIFJldHVybiBlZGl0YWJsZSBkYXRlIGFyZWEgYmFjayB0byB0ZXh0XG4gKlxuICogSWYgdGhlIGRhdGUgZm9yIHRoZSBkYXRhIG9iamVjdCAoc2hvcnROYW1lLCBpZFN0cikgaGFzIGJlZW4gdHVybmVkIGludG8gYSAzLWZpZWxkIGVkaXRcbiAqIGFyZWEsIHRoZW4gdGhpcyBmdW5jdGlvbiB3aWxsIHJldHVybiB0aGUgZWRpdGFibGUgYXJlYSBiYWNrIHRvIHRoZSB2aWV3IG1vZGUgdGV4dCwgcmVwbGFjaW5nXG4gKiB0aGUgZWRpdCBib3hlcyB3aXRoIGEgcGFyYWdyYXBoIGNvbnRhaW5pbmcgdGhlIGNvbXB1dGVkIHN0YW5kYXJkIGRhdGUgc3RyaW5nIChZWVlZLU1NLUREKS5cbiAqXG4gKiBOb3RlOiBpZFN0ciBtdXN0IG5vdCBoYXZlIHRoZSBcIl9cIiBwcmUtYXBwZW5kZWRcbiAqXG4gKiBAcGFyYW0gc3RyaW5nIHNob3J0TmFtZSBUaGUgc2hvcnQgbmFtZSBvZiB0aGUgZGF0YSBvYmplY3QsIHN1Y2ggYXMgXCJuYW1lRW50cnlcIiBvciBcIm9jY3VwYXRpb25cIlxuICogQHBhcmFtIHN0cmluZ3xpbnQgaWRTdHIgVGhlIGluZGV4IHdpdGhpbiB0aGUgZWRpdCBwYWdlIG9mIHRoZSBvYmplY3QuXG4gKi9cbmZ1bmN0aW9uIGRhdGVUb1RleHQoc2hvcnROYW1lLCBpZFN0cikge1xuICAgICQoXCJkaXZbaWRePSdkYXRlX1wiK3Nob3J0TmFtZStcIiddXCIpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjb250ID0gJCh0aGlzKTtcbiAgICAgICAgaWYoY29udC5hdHRyKCdpZCcpLmVuZHNXaXRoKFwiX1wiK2lkU3RyKSAmJiAhY29udC5hdHRyKCdpZCcpLmVuZHNXaXRoKFwiWlpcIikpIHtcbiAgICAgICAgICAgIC8vIHJlbW92ZSB0aGUgc2hvcnQgbmFtZSBhbmQgXCJzZWxlY3RfXCIgZnJvbSB0aGUgc3RyaW5nIHdlJ3JlIHBhcnNpbmdcbiAgICAgICAgICAgIHZhciBkaXZTdHIgPSBjb250LmF0dHIoJ2lkJykucmVwbGFjZShcImRhdGVfXCIsIFwiXCIpLnJlcGxhY2Uoc2hvcnROYW1lICsgXCJfXCIsIFwiXCIpO1xuICAgICAgICAgICAgLy8gcmVtb3ZlIHRoZSBpZHN0ciB0byByZWNlaXZlIHRoZSBuYW1lIG9mIHRoaXMgZWxlbWVudFxuICAgICAgICAgICAgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cChcIlxcX1wiK2lkU3RyK1wiJFwiLCBcImdcIik7XG4gICAgICAgICAgICB2YXIgbmFtZSA9IGRpdlN0ci5yZXBsYWNlKHJlZ2V4LCBcIlwiKTtcblxuICAgICAgICAgICAgdXBkYXRlRGF0ZShzaG9ydE5hbWUsIGlkU3RyKTtcblxuXG4gICAgICAgICAgICB2YXIgZGF0ZVN0ciA9ICQoXCIjXCIrc2hvcnROYW1lK1wiX1wiK25hbWUrXCJfXCIraWRTdHIpLnZhbCgpO1xuXG4gICAgICAgICAgICB2YXIgaHRtbCA9IFwiPHAgY2xhc3M9J2Zvcm0tY29udHJvbC1zdGF0aWMnPlwiK2RhdGVTdHIrXCI8L3A+XCI7XG4gICAgICAgICAgICBodG1sICs9IFwiPGlucHV0IHR5cGU9J2hpZGRlbicgaWQ9J1wiK3Nob3J0TmFtZStcIl9cIituYW1lK1wiX1wiK2lkU3RyK1wiJyBuYW1lPSdcIitzaG9ydE5hbWUrXCJfXCIrbmFtZStcIl9cIitpZFN0citcIicgdmFsdWU9J1wiK2RhdGVTdHIrXCInPlwiO1xuICAgICAgICAgICAgY29udC5odG1sKGh0bWwpO1xuXG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuXG4vLyBUT0RPOiBJZiB3ZSB3YW50IHRvIHNob3cgYSBESVYgb2YgZWRpdGVkIGFuZCBkZWxldGVkIGNvbXBvbmVudHMsIHdlIHNob3VsZCB1c2UgdGhlIGZvbGxvd2luZyB0d28gZnVuY3Rpb25zXG4vLyB0byBnZXQgY29waWVzIG9mIHRoZSBlZGl0ZWQvZGVsZXRlZCBjb21wb25lbnRzIGZyb20gdGhlIHBhZ2UuICBXZSBjYW4gdGhlbiBpbnNlcnQgdGhvc2UgY29waWVzIG9udG8gYSBtb2RhbFxuLy8gZGlhbG9nIGJveCB3aXRoIGEgXCJTYXZlXCIgb3IgXCJDb250aW51ZVwiIGJ1dHRvbiBhdCB0aGUgdG9wIGFuZCBib3R0b20uXG4vL1xuLy8gQWxsIHRoZSBwaWVjZXMgc2hvd24gaW4gdGhlIGRpYWxvZyBzaG91bGQgYmUgZGlzYWJsZWQuICBPbmUgd2F5IHRvIGRvIHRoaXMgd291bGQgYmUgdXNpbmcgdGhlIGZvbGxvd2luZ1xuLy8gbWV0aG9kIHRvIHBsYWNlIGEgc2VtaS10cmFuc3BhcmVudCBkaXYgb24gdG9wIG9mIHRoZSBlZGl0YWJsZSBwaWVjZXMsIG1ha2luZyB0aGVtIGFwcGVhciB0byBiZSBncmF5ZWQgb3V0XG4vLyBhbmQgd2l0aCB0aGUgbm90IHBlcm1pdHRlZCBjdXJzb3IuXG4vL1xuLy8gLmFwcGVuZCgnPGRpdiBzdHlsZT1cInBvc2l0aW9uOmFic29sdXRlOyB0b3A6MDsgbGVmdDowOyB3aWR0aDoxMDAlOyBoZWlnaHQ6MTAwJTsgYmFja2dyb3VuZDojZjNmM2YzOyB6LWluZGV4OjUwMDsgY3Vyc29yOm5vdC1hbGxvd2VkO29wYWNpdHk6MC40O2ZpbHRlcjogYWxwaGEob3BhY2l0eSA9IDUwKVwiPjwvZGl2PicpO1xuLy9cbi8vIE5vdGU6IHRoaXMgbW9kYWwgc2hvdWxkIE5PVCBiZSBpbnNpZGUgdGhlIGNvbnN0ZWxsYXRpb24gZm9ybSBzbyB0aGF0IHdlIGRvbid0IHN1Ym1pdCB0aGUgdmFsdWVzIHR3aWNlLlxuXG4vKipcbiAqIEdldCBhbGwgdGhlIGVkaXRlZCBjb21wb25lbnRzXG4gKi9cbmZ1bmN0aW9uIGdldEVkaXRlZCgpIHtcbiAgICB2YXIgaHRtbCA9IFwiXCI7XG5cbiAgICAkKFwiI2NvbnN0ZWxsYXRpb25fZm9ybSBkaXYuZWRpdGVkLWNvbXBvbmVudFwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY29udCA9ICQodGhpcyk7XG4gICAgICAgIGNvbnNvbGUubG9nKGNvbnQuYXR0cignaWQnKSk7XG4gICAgICAgIHZhciBwaWVjZXMgPSBjb250LmF0dHIoJ2lkJykuc3BsaXQoXCJfcGFuZWxfXCIpO1xuICAgICAgICBpZiAocGllY2VzLmxlbmd0aCA9PSAyKSB7XG4gICAgICAgICAgICBodG1sICs9IFwiPGRpdiBjbGFzcz0ncGFuZWwgcGFuZWwtYm9keSBlZGl0ZWQtY29tcG9uZW50Jz5cIiArICQoXCIjXCIrcGllY2VzWzBdICsgXCJfZGF0YXBhcnRfXCIgKyBwaWVjZXNbMV0pLmh0bWwoKSArIFwiPC9kaXY+XCI7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBodG1sO1xufVxuXG4vKipcbiAqIEdldCBhbGwgdGhlIGRlbGV0ZWQgY29tcG9uZW50c1xuICovXG5mdW5jdGlvbiBnZXREZWxldGVkKCkge1xuICAgIHZhciBodG1sID0gXCJcIjtcblxuICAgICQoXCIjY29uc3RlbGxhdGlvbl9mb3JtIGRpdi5kZWxldGVkLWNvbXBvbmVudFwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY29udCA9ICQodGhpcyk7XG4gICAgICAgIGNvbnNvbGUubG9nKGNvbnQuYXR0cignaWQnKSk7XG4gICAgICAgIHZhciBwaWVjZXMgPSBjb250LmF0dHIoJ2lkJykuc3BsaXQoXCJfcGFuZWxfXCIpO1xuICAgICAgICBpZiAocGllY2VzLmxlbmd0aCA9PSAyKSB7XG4gICAgICAgICAgICBodG1sICs9IFwiPGRpdiBjbGFzcz0ncGFuZWwgcGFuZWwtYm9keSBkZWxldGVkLWNvbXBvbmVudCc+XCIgKyAkKFwiI1wiK3BpZWNlc1swXSArIFwiX2RhdGFwYXJ0X1wiICsgcGllY2VzWzFdKS5odG1sKCkgKyBcIjwvZGl2PlwiO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gaHRtbDtcbn1cblxuZnVuY3Rpb24gdHVybk9uRWRpdERlbGV0ZUJ1dHRvbnMocGFydD0nJykge1xuICAgIHZhciBkaXZJRCA9ICcnO1xuICAgIGlmIChwYXJ0ICE9ICcnKVxuICAgICAgICBkaXZJRCA9IFwiI1wiICsgcGFydCArIFwiIFwiO1xuICAgIC8vIFR1cm4gb24gdGhlIGVkaXQgYnV0dG9uc1xuICAgICQoZGl2SUQgKyBcImFbaWQqPSdlZGl0YnV0dG9uJ11cIikuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG9iaiA9ICQodGhpcyk7XG4gICAgICAgIHZhciBwaWVjZXMgPSBvYmouYXR0cignaWQnKS5zcGxpdChcIl9cIik7XG5cbiAgICAgICAgaWYgKHBpZWNlcy5sZW5ndGggPT0gMykge1xuICAgICAgICAgICAgdmFyIHNob3J0ID0gcGllY2VzWzBdO1xuICAgICAgICAgICAgdmFyIGkgPSBwaWVjZXNbMl07XG4gICAgICAgICAgICBvYmoub24oXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBtYWtlRWRpdGFibGUoc2hvcnQsIGkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAocGllY2VzLmxlbmd0aCA9PSA1ICYmIHBpZWNlc1swXSA9PSBcInNjbVwiKSB7XG4gICAgICAgICAgICB2YXIgc2hvcnQgPSBwaWVjZXNbMV07XG4gICAgICAgICAgICB2YXIgaSA9IHBpZWNlc1s0XTtcbiAgICAgICAgICAgIHZhciBqID0gcGllY2VzWzNdO1xuICAgICAgICAgICAgb2JqLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgbWFrZVNDTUVkaXRhYmxlKHNob3J0LCBpLCBqKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKHBpZWNlcy5sZW5ndGggPT0gNSkge1xuICAgICAgICAgICAgdmFyIHNob3J0ID0gcGllY2VzWzBdICsgXCJfXCIgKyBwaWVjZXNbMV0gKyBcIl9cIiArIHBpZWNlc1syXTtcbiAgICAgICAgICAgIHZhciBpID0gcGllY2VzWzRdO1xuICAgICAgICAgICAgb2JqLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgbWFrZUVkaXRhYmxlKHNob3J0LCBpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBUdXJuIG9uIHRoZSBkZWxldGUgYnV0dG9uc1xuICAgICQoZGl2SUQgKyBcImFbaWQqPSdkZWxldGVidXR0b24nXVwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgb2JqID0gJCh0aGlzKTtcbiAgICAgICAgdmFyIHBpZWNlcyA9IG9iai5hdHRyKCdpZCcpLnNwbGl0KFwiX1wiKTtcblxuICAgICAgICBpZiAocGllY2VzLmxlbmd0aCA9PSAzKSB7XG4gICAgICAgICAgICB2YXIgc2hvcnQgPSBwaWVjZXNbMF07XG4gICAgICAgICAgICB2YXIgaSA9IHBpZWNlc1syXTtcbiAgICAgICAgICAgIG9iai5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHNldERlbGV0ZWQoc2hvcnQsIGkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAocGllY2VzLmxlbmd0aCA9PSA1ICYmIHBpZWNlc1swXSA9PSBcInNjbVwiKSB7XG4gICAgICAgICAgICB2YXIgc2hvcnQgPSBwaWVjZXNbMV07XG4gICAgICAgICAgICB2YXIgaSA9IHBpZWNlc1s0XTtcbiAgICAgICAgICAgIHZhciBqID0gcGllY2VzWzNdO1xuICAgICAgICAgICAgb2JqLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgc2V0U0NNRGVsZXRlZChzaG9ydCwgaSwgaik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChwaWVjZXMubGVuZ3RoID09IDUpIHtcbiAgICAgICAgICAgIHZhciBzaG9ydCA9IHBpZWNlc1swXSArIFwiX1wiICsgcGllY2VzWzFdICsgXCJfXCIgKyBwaWVjZXNbMl07XG4gICAgICAgICAgICB2YXIgaSA9IHBpZWNlc1s0XTtcbiAgICAgICAgICAgIG9iai5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHNldERlbGV0ZWQoc2hvcnQsIGkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gdHVybk9uVG9vbHRpcHNGb3JUYWIocGFydD0nJykge1xuICAgIHZhciBkaXZJRCA9ICcnO1xuICAgIGlmIChwYXJ0ICE9ICcnKVxuICAgICAgICBkaXZJRCA9IFwiI1wiICsgcGFydCArIFwiIFwiO1xuICAgIC8vIExvYWQgdG9vbHRpcHNcbiAgICAkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAkKGRpdklEICsgJ1tkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIl0nKS50b29sdGlwKClcbiAgICB9KVxuXG4gICAgLy8gTG9hZCBwb3BvdmVyc1xuICAgICQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICQoZGl2SUQgKyAnW2RhdGEtdG9nZ2xlPVwicG9wb3ZlclwiXScpLnBvcG92ZXIoe1xuICAgICAgICAgICAgICAgIHRyaWdnZXI6ICdob3ZlcicsXG4gICAgICAgICAgICAgICAgY29udGFpbmVyOiAnYm9keSdcbiAgICAgICAgICB9KVxuICAgIH0pXG5cbn1cblxuZnVuY3Rpb24gdXBkYXRlUGljdHVyZUFycm93KHNob3J0TmFtZSwgaSwgbmV3VmFsdWUpIHtcbiAgICAkKCcjJytzaG9ydE5hbWUrJ19yZWxhdGlvblBpY3R1cmVBcnJvd18nK2kpLnRleHQobmV3VmFsdWUpO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVQaWN0dXJlVGl0bGUoc2hvcnROYW1lLCBpLCBuZXdWYWx1ZSkge1xuICAgICQoJyMnK3Nob3J0TmFtZSsnX3JlbGF0aW9uUGljdHVyZVRpdGxlXycraSkudGV4dChuZXdWYWx1ZSk7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZVBpY3R1cmVJY29uKHNob3J0TmFtZSwgaSwgZW50aXR5VHlwZSkge1xuICAgIHZhciBodG1sID0gXCJcIjtcbiAgICBpZiAoZW50aXR5VHlwZSA9PSAncGVyc29uJylcbiAgICAgICAgaHRtbCA9ICc8aSBjbGFzcz1cImZhIGZhLXVzZXJcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+PGJyLz4nO1xuICAgIGVsc2UgaWYgKGVudGl0eVR5cGUgPT0gJ2NvcnBvcmF0ZUJvZHknKVxuICAgICAgICBodG1sID0gJzxpIGNsYXNzPVwiZmEgZmEtYnVpbGRpbmdcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+PGJyLz4nO1xuICAgIGVsc2UgaWYgKGVudGl0eVR5cGUgPT0gJ2ZhbWlseScpXG4gICAgICAgIGh0bWwgPSAnPGkgY2xhc3M9XCJmYSBmYS11c2Vyc1wiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT48YnIvPic7XG4gICAgJCgnIycrc2hvcnROYW1lKydfcmVsYXRpb25QaWN0dXJlSWNvbl8nK2kpLmh0bWwoaHRtbCk7XG59XG5cblxudmFyIGdlb1BsYWNlTG9hZFJlc3VsdHMgPSBudWxsO1xuXG5mdW5jdGlvbiBsb2FkR2VvUGxhY2VSZXN1bHRDYWNoZSgpIHtcbiAgICAkKFwiaW5wdXRbaWRePSdwbGFjZV9nZW9wbGFjZV9pZF8nXVwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgb2JqID0gJCh0aGlzKTtcbiAgICAgICAgLy8gUXVlcnkgZm9yIHRlcm0gYnkgYWpheFxuICAgICAgICBpZiAob2JqLnZhbCgpICE9IG51bGwgJiYgb2JqLnZhbCgpICE9IFwiXCIpIHtcbiAgICAgICAgICAgICQuZ2V0KHNuYWNVcmwrXCIvdm9jYWJ1bGFyeS9yZWFkP3R5cGU9Z2VvUGxhY2UmaWQ9XCIrb2JqLnZhbCgpLCBudWxsLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIC8vIENoZWNrIHRoZSByZXR1cm4gdmFsdWUgZnJvbSB0aGUgYWpheC4gSWYgc3VjY2VzcywgdGhlbiBnbyB0byBkYXNoYm9hcmRcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS50ZXJtKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZ2VvUGxhY2VMb2FkUmVzdWx0cylcbiAgICAgICAgICAgICAgICAgICAgICAgIGdlb1BsYWNlTG9hZFJlc3VsdHMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgZ2VvUGxhY2VMb2FkUmVzdWx0cy5wdXNoKGRhdGEudGVybSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNob29zZVN1Z2dlc3RlZEdlb1BsYWNlKHNlbGVjdElELCBpZFN0ciwgdmFsdWUpIHtcbiAgICAvLyBpZFN0ciA9PSBpZCBudW1iZXIgb24gdGhlIHBhZ2VcbiAgICB2YXIgb2JqID0gJChcIiNcIitzZWxlY3RJRCk7XG4gICAgb2JqLnNlbGVjdDIoJ2Rlc3Ryb3knKTtcbiAgICBvYmoudmFsKHZhbHVlKTtcbiAgICBnZW92b2NhYl9zZWxlY3RfcmVwbGFjZShvYmosIFwiX1wiK2lkU3RyKTtcbiAgICB1cGRhdGVQbGFjZUhlYWRpbmcoXCJwbGFjZVwiLCBpZFN0ciwgdmFsdWUpO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVQbGFjZUhlYWRpbmcoc2hvcnROYW1lLCBpLCBuZXdWYWx1ZSkge1xuICAgIHZhciBwbGFjZSA9IG51bGw7XG4gICAgaWYgKCFnZW9QbGFjZVNlYXJjaFJlc3VsdHMgJiYgIWdlb1BsYWNlTG9hZFJlc3VsdHMpIHtcbiAgICAgICAgJCgnIycrc2hvcnROYW1lKydfY29uZmlybWVkXycraSkudmFsKFwiZmFsc2VcIik7XG4gICAgICAgICQoJyMnK3Nob3J0TmFtZSsnX2dlb3Rlcm1fdGV4dF8nK2kpLmh0bWwoXCI8ZW0+VW5jb25maXJtZWQ8L2VtPlwiKTtcbiAgICAgICAgJCgnIycrc2hvcnROYW1lK1wiX2dlb3Rlcm1fbWFwbGlua19cIitpKS5hZGRDbGFzcyhcImRpc2FibGVkXCIpO1xuICAgICAgICAkKCcjJytzaG9ydE5hbWUrXCJfZ2VvdGVybV9tYXBsaW5rX1wiK2kpLnByb3AoJ29uY2xpY2snLG51bGwpLm9mZihcImNsaWNrXCIpO1xuICAgICAgICBpZiAoJCgnIycrc2hvcnROYW1lKydfb3JpZ2luYWxfJytpKS52YWwoKSAhPSBcIlwiKVxuICAgICAgICAgICAgJCgnIycrc2hvcnROYW1lKydfZ2VvdGVybV9jYXB0aW9uXycraSkudGV4dChcIlJlY29yZGVkIGFzOiBcIiArICQoJyMnK3Nob3J0TmFtZSsnX29yaWdpbmFsXycraSkudmFsKCkpO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICAkKCcjJytzaG9ydE5hbWUrJ19nZW90ZXJtX2NhcHRpb25fJytpKS50ZXh0KCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoZ2VvUGxhY2VTZWFyY2hSZXN1bHRzKSB7XG4gICAgICAgIGdlb1BsYWNlU2VhcmNoUmVzdWx0cy5mb3JFYWNoKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgaWYgKHJlc3VsdC5pZCA9PSBuZXdWYWx1ZSlcbiAgICAgICAgICAgICAgICBwbGFjZSA9IHJlc3VsdDtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKCFwbGFjZSAmJiBnZW9QbGFjZUxvYWRSZXN1bHRzKSB7XG4gICAgICAgIGdlb1BsYWNlTG9hZFJlc3VsdHMuZm9yRWFjaChmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgIGlmIChyZXN1bHQuaWQgPT0gbmV3VmFsdWUpXG4gICAgICAgICAgICAgICAgcGxhY2UgPSByZXN1bHQ7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICghcGxhY2UpIHtcbiAgICAgICAgJCgnIycrc2hvcnROYW1lKydfY29uZmlybWVkXycraSkudmFsKFwiZmFsc2VcIik7XG4gICAgICAgICQoJyMnK3Nob3J0TmFtZStcIl9nZW90ZXJtX21hcGxpbmtfXCIraSkuYWRkQ2xhc3MoXCJkaXNhYmxlZFwiKTtcbiAgICAgICAgJCgnIycrc2hvcnROYW1lK1wiX2dlb3Rlcm1fbWFwbGlua19cIitpKS5vZmYoXCJjbGlja1wiKTtcbiAgICAgICAgaWYgKCQoJyMnK3Nob3J0TmFtZSsnX29yaWdpbmFsXycraSkudmFsKCkgIT0gXCJcIikge1xuICAgICAgICAgICAgJCgnIycrc2hvcnROYW1lKydfZ2VvdGVybV90ZXh0XycraSkuaHRtbChcIjxlbT5VbmNvbmZpcm1lZDwvZW0+XCIpO1xuICAgICAgICAgICAgJCgnIycrc2hvcnROYW1lKydfZ2VvdGVybV9jYXB0aW9uXycraSkudGV4dChcIlJlY29yZGVkIGFzOiBcIiArICQoJyMnK3Nob3J0TmFtZSsnX29yaWdpbmFsXycraSkudmFsKCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJCgnIycrc2hvcnROYW1lKydfZ2VvdGVybV90ZXh0XycraSkudGV4dChcIi0tXCIpO1xuICAgICAgICAgICAgJCgnIycrc2hvcnROYW1lKydfZ2VvdGVybV9jYXB0aW9uXycraSkudGV4dChcIkdlb1BsYWNlIHRlcm0gbm90IHNwZWNpZmllZFwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgICQoJyMnK3Nob3J0TmFtZSsnX2NvbmZpcm1lZF8nK2kpLnZhbChcInRydWVcIik7XG4gICAgJCgnIycrc2hvcnROYW1lKydfZ2VvdGVybV90ZXh0XycraSkudGV4dChwbGFjZS5uYW1lKTtcbiAgICAkKCcjJytzaG9ydE5hbWUrJ19nZW90ZXJtX2NhcHRpb25fJytpKS50ZXh0KHBsYWNlLmFkbWluaXN0cmF0aW9uQ29kZSArIFwiLCBcIiArIHBsYWNlLmNvdW50cnlDb2RlKTtcbiAgICBpZiAocGxhY2UubGF0aXR1ZGUgJiYgcGxhY2UubG9uZ2l0dWRlKSB7XG4gICAgICAgICQoJyMnK3Nob3J0TmFtZStcIl9nZW90ZXJtX21hcGxpbmtfXCIraSkucHJvcCgnb25jbGljaycsbnVsbCkub2ZmKFwiY2xpY2tcIik7XG4gICAgICAgICQoJyMnK3Nob3J0TmFtZStcIl9nZW90ZXJtX21hcGxpbmtfXCIraSkub24oXCJjbGlja1wiLCBmdW5jdGlvbigpIHtvcGVuR2VvUGxhY2VWaWV3ZXIocGxhY2UuaWQpOyByZXR1cm4gZmFsc2U7fSk7XG4gICAgICAgICQoJyMnK3Nob3J0TmFtZStcIl9nZW90ZXJtX21hcGxpbmtfXCIraSkucmVtb3ZlQ2xhc3MoXCJkaXNhYmxlZFwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAkKCcjJytzaG9ydE5hbWUrXCJfZ2VvdGVybV9tYXBsaW5rX1wiK2kpLmFkZENsYXNzKFwiZGlzYWJsZWRcIik7XG4gICAgICAgICQoJyMnK3Nob3J0TmFtZStcIl9nZW90ZXJtX21hcGxpbmtfXCIraSkucHJvcCgnb25jbGljaycsbnVsbCkub2ZmKFwiY2xpY2tcIik7XG4gICAgfVxuXG5cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1hZ2ljRGVmYXVsdEZpbGwoc2VsZWN0SUQsIHZvY2FiVHlwZSkge1xuICAgaWYgKHR5cGVvZihkZWZhdWx0c1t2b2NhYlR5cGVdKSAhPT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgaWQ6IGRlZmF1bHRzW3ZvY2FiVHlwZV0uaWQsXG4gICAgICAgICAgIHRleHQ6IGRlZmF1bHRzW3ZvY2FiVHlwZV0udGVybVxuICAgICAgIH07XG5cbiAgICAgICAvLyBJZiB0aGUgc2VsZWN0ZWQgaXRlbSBleGlzdHMsIHRoZW4gc2VsZWN0IGl0LiBFbHNlLCBhZGQgYSBuZXcgb3B0aW9uXG4gICAgICAgLy8gYW5kIHNlbGVjdCBpdC5cbiAgICAgICBpZiAoJCgnIycrc2VsZWN0SUQpLmZpbmQoXCJvcHRpb25bdmFsdWU9J1wiICsgZGF0YS5pZCArIFwiJ11cIikubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAkKCcjJytzZWxlY3RJRCkudmFsKGRhdGEuaWQpLnRyaWdnZXIoJ2NoYW5nZScpO1xuICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgIHZhciBuZXdPcHRpb24gPSBuZXcgT3B0aW9uKGRhdGEudGV4dCwgZGF0YS5pZCwgZmFsc2UsIHRydWUpO1xuICAgICAgICAgICAkKCcjJytzZWxlY3RJRCkuYXBwZW5kKG5ld09wdGlvbikudHJpZ2dlcignY2hhbmdlJyk7XG4gICAgICAgfVxuICAgfVxuXG59XG5cbmZ1bmN0aW9uIGNhcGl0YWxpemUod29yZCkge1xuICAgIHJldHVybiB3b3JkWzBdLnRvVXBwZXJDYXNlKCkgKyB3b3JkLnNsaWNlKDEpO1xufVxuXG5mdW5jdGlvbiBwYXJzZU5hbWUoZSkge1xuICAgICQoJyNuYW1lLXBhcnNlci1vcHRpb25zJykudGV4dCgnJyk7XG4gICAgdmFyICRuYW1lQ29tcG9uZW50cyA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoJy5uYW1lLWNvbXBvbmVudHMnKTtcblxuICAgIHZhciAkcGFydFR5cGUgPSAkbmFtZUNvbXBvbmVudHMuZmluZChcInNlbGVjdDpsYXN0XCIpO1xuICAgIHZhciAkdGV4dGJveCA9ICRuYW1lQ29tcG9uZW50cy5maW5kKCdpbnB1dFt0eXBlPVwidGV4dFwiXTpsYXN0Jyk7XG5cbiAgICB2YXIgbmFtZSA9ICR0ZXh0Ym94LnZhbCgpO1xuXG4gICAgdmFyIGVudGl0eVR5cGUgPSAkKCcjZW50aXR5VHlwZScpLnRleHQoKS50cmltKCk7XG4gICAgJCgnI25hbWUtcGFyc2VyLXR5cGUnKS50ZXh0KGNhcGl0YWxpemUoZW50aXR5VHlwZSkpO1xuICAgICQoJyNuYW1lLXBhcnNlci1vcmlnaW5hbCcpLnRleHQobmFtZSk7XG5cbiAgICB2YXIgcGFyc2VyID0gbmV3IE5hbWVQYXJzZXIoKTtcbiAgICB2YXIgZ3Vlc3NlcyA9IHBhcnNlci5ndWVzc1BlcnNvbihuYW1lKTtcblxuICAgIHZhciBwYXJzZWRPcHRpb24gPSAnJztcblxuICAgIHZhciBjb3VudGVyID0gMDtcbiAgICBndWVzc2VzLmZvckVhY2goZnVuY3Rpb24oZ3Vlc3MpIHtcbiAgICAgICAgLy8gYXR0YWNoIG5hbWUgZGF0YSBvYmplY3QgdG8gcmFkaW9cbiAgICAgICAgZm9yICh2YXIga2V5IGluIGd1ZXNzKSB7XG4gICAgICAgICAgICBpZiAoZ3Vlc3Nba2V5XSAmJiBndWVzc1trZXldLmxlbmd0aCAhPSAwKSB7XG4gICAgICAgICAgICAgICAgcGFyc2VkT3B0aW9uICs9IFwiPGxpPjxzcGFuIHN0eWxlPSdmb250LXdlaWdodDogYm9sZDsnPlwiICsga2V5ICsgXCI8L3NwYW4+OiBcIiArIGd1ZXNzW2tleV0gKyBcIjwvbGk+XCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAkKCcjbmFtZS1wYXJzZXItb3B0aW9ucycpLmFwcGVuZChcIjxkaXYgY2xhc3M9J3JhZGlvJz5cIiArXG4gICAgICAgICAgICBcIjxsYWJlbCBjbGFzcz0ncmFkaW8gZm9ybS1pbmxpbmUnIGZvcj0nbmFtZS1wYXJzZXItb3B0aW9uLVwiICsgY291bnRlciArIFwiJz5cIiArXG4gICAgICAgICAgICBcIjxpbnB1dCB0eXBlPSdyYWRpbycgbmFtZT0ncGFyc2VkLW5hbWVzJyBpZD0nbmFtZS1wYXJzZXItb3B0aW9uLVwiICsgY291bnRlciArIFwiJz5cIiArXG4gICAgICAgICAgICBcIjx1bCBjbGFzcz0nbGlzdC11bnN0eWxlZCc+XCIgKyBwYXJzZWRPcHRpb24gKyBcIjwvdWw+PC9sYWJlbD4gPC9kaXY+XCIpO1xuXG5cbiAgICAgICAgJCgnI25hbWUtcGFyc2VyLW9wdGlvbnMnKS5maW5kKFwiaW5wdXRbdHlwZT0ncmFkaW8nXTpsYXN0XCIpLmRhdGEoXCJwYXJzZWQtbmFtZVwiLCBndWVzcyk7XG5cbiAgICAgICAgcGFyc2VkT3B0aW9uID0gJyc7XG4gICAgICAgIGNvdW50ZXIrKztcbiAgICB9KVxuXG4gICAgJCgnI25hbWUtcGFyc2VyLW9wdGlvbnMnKS5maW5kKFwiaW5wdXRbdHlwZT0ncmFkaW8nXTpmaXJzdFwiKS5wcm9wKCdjaGVja2VkJywgdHJ1ZSlcblxuXG4gICAgJCgnI3BhcnNlci1hY2NlcHQtYnRuJykudW5iaW5kKCdjbGljaycpXG4gICAgJCgnI3BhcnNlci1hY2NlcHQtYnRuJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzZWxlY3RlZE5hbWUgPSAkKCcjbmFtZS1wYXJzZXIgaW5wdXRbdHlwZT1cInJhZGlvXCJdOmNoZWNrZWQnKS5kYXRhKCdwYXJzZWQtbmFtZScpXG4gICAgICAgICQuZ2V0KCBzbmFjVXJsICsgXCIvdm9jYWJ1bGFyeS8/dHlwZT1uYW1lX2NvbXBvbmVudCZlbnRpdHlfdHlwZT03MDBcIilcbiAgICAgICAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIGFjY2VwdFBhcnNlZE5hbWUoc2VsZWN0ZWROYW1lLCAkbmFtZUNvbXBvbmVudHMsIG5hbWUsIGRhdGEucmVzdWx0cylcbiAgICAgICAgfSlcbiAgICB9KVxufVxuXG5mdW5jdGlvbiBhY2NlcHRQYXJzZWROYW1lKHNlbGVjdGVkTmFtZSwgJG5hbWVDb21wb25lbnRzLCBuYW1lLCBuYW1lQ29tcG9uZW50SURzKSB7XG4gICAgdmFyIGkgPSAkbmFtZUNvbXBvbmVudHMuYXR0cignaWQnKS5zcGxpdCgnXycpWzJdO1xuICAgIHZhciAkbmFtZUNvbXBvbmVudCA9ICRuYW1lQ29tcG9uZW50cy5maW5kKCcucmVvcmRlcmFibGUnKTsgLy8vXG4gICAgJG5hbWVDb21wb25lbnQucmVwbGFjZVdpdGgoJzxkaXYgc3R5bGU9XCJtYXJnaW4tbGVmdDoxMCU7IGZvbnQtc2l6ZTogMTR4OyBmb250LXN0eWxlOml0YWxpYzsgY29sb3I6ICM3Nzc3Nzc7XCI+IE5hbWU6ICcgKyBuYW1lICsgJzwvZGl2PicpO1xuXG4gICAgdmFyIG5hbWVDb21wb25lbnRNYXAgPSB7fTtcblxuICAgIGZvciAodmFyIGsgPSAwOyBrIDwgbmFtZUNvbXBvbmVudElEcy5sZW5ndGg7IGsrKykge1xuICAgICAgICBuYW1lQ29tcG9uZW50TWFwW25hbWVDb21wb25lbnRJRHNba10udGV4dF0gPSBuYW1lQ29tcG9uZW50SURzW2tdLmlkXG4gICAgfVxuICAgIC8vIHZhciBuYW1lQ29tcG9uZW50TWFwID0ge1xuICAgIC8vICAgICAnU3VybmFtZSc6IDQwMDIyMyxcbiAgICAvLyAgICAgJ0ZvcmVuYW1lJzogNDAwMjI0LFxuICAgIC8vICAgICAnTmFtZUFkZGl0aW9uJzogNDAwMjM2LFxuICAgIC8vICAgICAnRGF0ZSc6IDQwMDIzNyxcbiAgICAvLyAgICAgJ05hbWVFeHBhbnNpb24nOiA0MDAyMjYsXG4gICAgLy8gICAgICdOdW1lcmF0aW9uJzogNDAwMjI1XG4gICAgLy8gfTtcblxuICAgIGZvciAodmFyIGtleSBpbiBzZWxlY3RlZE5hbWUpIHtcbiAgICAgICAgaWYgKGtleSA9PSAnTmFtZUFkZGl0aW9ucycpIHtcbiAgICAgICAgICAgIGtleSA9ICdOYW1lQWRkaXRpb24nO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxlY3RlZE5hbWVbJ05hbWVBZGRpdGlvbnMnXS5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIG5ld05hbWVFbnRyeUNvbXBvbmVudChpKTtcbiAgICAgICAgICAgICAgICB2YXIgb3B0aW9uID0gbmV3IE9wdGlvbihrZXksIG5hbWVDb21wb25lbnRNYXBba2V5XSwgZmFsc2UsIHRydWUpO1xuICAgICAgICAgICAgICAgICRwYXJ0VHlwZSA9ICRuYW1lQ29tcG9uZW50cy5maW5kKFwic2VsZWN0Omxhc3RcIik7XG4gICAgICAgICAgICAgICAgJHBhcnRUeXBlLmFwcGVuZChvcHRpb24pLnRyaWdnZXIoJ2NoYW5nZScpO1xuICAgICAgICAgICAgICAgICR0ZXh0Ym94ID0gJG5hbWVDb21wb25lbnRzLmZpbmQoXCJpbnB1dFt0eXBlPSd0ZXh0J106bGFzdFwiKTtcbiAgICAgICAgICAgICAgICAkdGV4dGJveC52YWwoc2VsZWN0ZWROYW1lW1wiTmFtZUFkZGl0aW9uc1wiXVtqXSk7XG5cbiAgICAgICAgICAgICAgICAkcGFydFR5cGUuYXBwZW5kKG9wdGlvbikudHJpZ2dlcignY2hhbmdlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoc2VsZWN0ZWROYW1lW2tleV0gJiYgbmFtZUNvbXBvbmVudE1hcFtrZXldKSB7XG4gICAgICAgICAgICBuZXdOYW1lRW50cnlDb21wb25lbnQoaSk7XG4gICAgICAgICAgICB2YXIgb3B0aW9uID0gbmV3IE9wdGlvbihrZXksIG5hbWVDb21wb25lbnRNYXBba2V5XSwgZmFsc2UsIHRydWUpO1xuICAgICAgICAgICAgJHBhcnRUeXBlID0gJG5hbWVDb21wb25lbnRzLmZpbmQoXCJzZWxlY3Q6bGFzdFwiKTtcbiAgICAgICAgICAgICRwYXJ0VHlwZS5hcHBlbmQob3B0aW9uKS50cmlnZ2VyKCdjaGFuZ2UnKTtcbiAgICAgICAgICAgICR0ZXh0Ym94ID0gJG5hbWVDb21wb25lbnRzLmZpbmQoXCJpbnB1dFt0eXBlPSd0ZXh0J106bGFzdFwiKTtcbiAgICAgICAgICAgICR0ZXh0Ym94LnZhbChzZWxlY3RlZE5hbWVba2V5XSk7XG5cbiAgICAgICAgICAgICRwYXJ0VHlwZS5hcHBlbmQob3B0aW9uKS50cmlnZ2VyKCdjaGFuZ2UnKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgICQoXCIjbmFtZUVudHJ5X2RhdGFwYXJ0X1wiICsgaSkuZmluZChcIi5uYW1lLXBhcnNlclwiKS5yZW1vdmUoKTtcbiAgICB1cGRhdGVOYW1lRW50cnlIZWFkaW5nKGkpO1xufVxuXG5mdW5jdGlvbiByZW1vdmVQYXJzZXJCdXR0b24oaSkge1xuICAgICQoJyNuYW1lRW50cnlfZGF0YXBhcnRfJyArIGkpLmZpbmQoJy5uYW1lLXBhcnNlcicpLnJlbW92ZSgpO1xufVxuXG4vKipcbiAqIFRoaW5ncyB0byBkbyB3aGVuIHRoZSBwYWdlIGZpbmlzaGVzIGxvYWRpbmdcbiAqL1xuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XG4gICAgLy8gTG9hZCB0aGUgcGxhY2UgY2FjaGUsIGlmIG5lZWRlZFxuICAgIGxvYWRHZW9QbGFjZVJlc3VsdENhY2hlKCk7XG5cbiAgICAvLyBsaXN0ZW4gZm9yIG5hbWUtcGFyc2luZ1xuICAgICQoJyNuYW1lRW50cmllcycpLm9uKCdjbGljaycsICcubmFtZS1wYXJzZXInLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBwYXJzZU5hbWUoZXZlbnQpO1xuICAgICAgICAkKFwiI25hbWUtcGFyc2VyXCIpLm1vZGFsKCd0b2dnbGUnKTtcbiAgICB9KTtcblxuICAgICQoJyNuYW1lLXBhcnNlcicpLm9uKCdzaG93bi5icy5tb2RhbCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJCgnI3BhcnNlci1hY2NlcHQtYnRuJykuZm9jdXMoKTtcbiAgICB9KVxuXG4gICAgLy8gSWYgdGhlIGNvbnN0ZWxsYXRpb24gaXMgaW4gXCJpbnNlcnRcIiBtb2RlLCB0aGVuIHdlIHNob3VsZCBhdXRvbWF0aWNhbGx5IHNldCBcInNvbWV0aGluZ0hhc0JlZW5FZGl0ZWRcIlxuICAgIC8vIHRvIGJlIHRydWUuLi5cbiAgICBpZiAoJCgnI29wZXJhdGlvbicpLnZhbCgpID09ICdpbnNlcnQnKVxuICAgICAgICBzZXRFZGl0ZWRGbGFnKHRydWUpO1xuICAgICAgICAvL3NvbWV0aGluZ0hhc0JlZW5FZGl0ZWQgPSB0cnVlO1xuXG4gICAgdHVybk9uRWRpdERlbGV0ZUJ1dHRvbnMoKTtcblxuXHQvLyBBdHRhY2ggZnVuY3Rpb25zIHRvIHRoZSBlbnRpdHlUeXBlIHNlbGVjdFxuXHRpZiAoJCgnI2VudGl0eVR5cGUnKS5leGlzdHMoKSkge1xuXHRcdCQoJyNlbnRpdHlUeXBlJykuY2hhbmdlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2V0RWRpdGVkRmxhZyh0cnVlKTtcbiAgICAgICAgICAgIC8vc29tZXRoaW5nSGFzQmVlbkVkaXRlZCA9IHRydWU7XG4gICAgICAgICAgICAvLyBJZiB0aGVyZSBpcyBhbiBJRCwgdGhlbiB3ZSBuZWVkIHRvIHNldCB0aGlzIHRvIHVwZGF0ZVxuICAgICAgICAgICAgLy8gRWxzZSwgdGhlIG1haW4tbGV2ZWwgb3BlcmF0aW9uIHNob3VsZCBiZSBhbmQgcmVtYWluIGluc2VydFxuXHRcdFx0aWYgKCQoJyNjb25zdGVsbGF0aW9uaWQnKS52YWwoKSAhPSBudWxsICYmXG5cdFx0XHRcdFx0JCgnI2NvbnN0ZWxsYXRpb25pZCcpLnZhbCgpICE9IFwiXCIpIHtcblx0XHRcdFx0JCgnI29wZXJhdGlvbicpLnZhbChcInVwZGF0ZVwiKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG4gICAgLy8gTmFtZSBFbnRyeSBkb2Vzbid0IGdldCBhbnkgQUpBWCwgc2luY2UgaXQgaXMgcHJlLWxvYWRlZFxuXHR2YXIgbmFtZUVudHJ5aWQgPSAxO1xuXHRpZiAoJCgnI25leHRfbmFtZUVudHJ5X2knKS5leGlzdHMoKSkge1xuXHQgICAgbmFtZUVudHJ5aWQgPSBwYXJzZUludCgkKCcjbmV4dF9uYW1lRW50cnlfaScpLnRleHQoKSk7XG5cdH1cblx0Y29uc29sZS5sb2coXCJOZXh0IE5hbWVFbnRyeSBJRDogXCIgKyBuYW1lRW50cnlpZCk7XG5cdGlmICgkKCcjYnRuX2FkZF9uYW1lRW50cnknKS5leGlzdHMoKSl7XG5cdFx0JCgnI2J0bl9hZGRfbmFtZUVudHJ5JykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHNldEVkaXRlZEZsYWcodHJ1ZSk7XG4gICAgICAgICAgICAvL3NvbWV0aGluZ0hhc0JlZW5FZGl0ZWQgPSB0cnVlO1xuXHRcdFx0dmFyIHRleHQgPSAkKCcjbmFtZUVudHJ5X3RlbXBsYXRlJykuY2xvbmUoKTtcblx0ICAgICAgICB2YXIgaHRtbCA9IHRleHQuaHRtbCgpLnJlcGxhY2UoL1paL2csIG5hbWVFbnRyeWlkKTtcblx0ICAgICAgICAkKCcjYWRkX25hbWVFbnRyeV9kaXYnKS5hZnRlcihodG1sKTtcbiAgICAgICAgICAgIHR1cm5PbkJ1dHRvbnMoXCJuYW1lRW50cnlcIiwgbmFtZUVudHJ5aWQpO1xuICAgICAgICAgICAgdHVybk9uVG9vbHRpcHMoXCJuYW1lRW50cnlcIiwgbmFtZUVudHJ5aWQpO1xuICAgICAgICAgICAgbWFrZUVkaXRhYmxlKFwibmFtZUVudHJ5XCIsIG5hbWVFbnRyeWlkKTtcblx0ICAgICAgICBuYW1lRW50cnlpZCA9IG5hbWVFbnRyeWlkICsgMTtcblx0ICAgICAgICByZXR1cm4gZmFsc2U7XG5cdFx0fSk7XG5cdH1cblxuXG5cdC8vIEF0dGFjaCBmdW5jdGlvbnMgdG8gZWFjaCBvZiB0aGUgXCIrIEFkZCBOZXcgX19fX19fX1wiIGJ1dHRvbnNcblxuXHQvLyBDb2RlIHRvIGhhbmRsZSBhZGRpbmcgbmV3IGdlbmRlcnMgdG8gdGhlIHBhZ2Vcblx0dmFyIGdlbmRlcmlkID0gMTtcbiAgICB2YXIgZ2VuZGVyT3BlbiA9IGZhbHNlO1xuXHRpZiAoJCgnI2dlbmRlcnN0YWInKS5leGlzdHMoKSl7XG5cdFx0JCgnI2dlbmRlcnN0YWInKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAgICAgLy8gRG9uJ3Qgb3BlbiBhIHNlY29uZCB0aW1lXG4gICAgICAgICAgICBpZiAoZ2VuZGVyT3BlbilcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgICQuZ2V0KHNuYWNVcmwrXCIvZWRpdF9wYXJ0L1wiKyQoJyNjb25zdGVsbGF0aW9uaWQnKS52YWwoKStcIi9cIiskKCcjdmVyc2lvbicpLnZhbCgpK1wiP3BhcnQ9Z2VuZGVyc1wiLCBudWxsLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGdlbmRlck9wZW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgICQoJyNnZW5kZXJzJykuaHRtbChkYXRhKTtcblxuICAgICAgICAgICAgICAgIHR1cm5PbkVkaXREZWxldGVCdXR0b25zKFwiZ2VuZGVyc1wiKTtcblxuICAgICAgICAgICAgICAgIGlmICgkKCcjbmV4dF9nZW5kZXJfaScpLmV4aXN0cygpKSB7XG4gICAgICAgICAgICAgICAgICAgIGdlbmRlcmlkID0gcGFyc2VJbnQoJCgnI25leHRfZ2VuZGVyX2knKS50ZXh0KCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk5leHQgR2VuZGVyIElEOiBcIiArIGdlbmRlcmlkKTtcbiAgICAgICAgICAgICAgICBpZiAoJCgnI2J0bl9hZGRfZ2VuZGVyJykuZXhpc3RzKCkpe1xuICAgICAgICAgICAgICAgICAgICAkKCcjYnRuX2FkZF9nZW5kZXInKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0RWRpdGVkRmxhZyh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vc29tZXRoaW5nSGFzQmVlbkVkaXRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9ICQoJyNnZW5kZXJfdGVtcGxhdGUnKS5jbG9uZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWwgPSB0ZXh0Lmh0bWwoKS5yZXBsYWNlKC9aWi9nLCBnZW5kZXJpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcjYWRkX2dlbmRlcl9kaXYnKS5hZnRlcihodG1sKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR1cm5PbkJ1dHRvbnMoXCJnZW5kZXJcIiwgZ2VuZGVyaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHVybk9uVG9vbHRpcHMoXCJnZW5kZXJcIiwgZ2VuZGVyaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFrZUVkaXRhYmxlKFwiZ2VuZGVyXCIsIGdlbmRlcmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdlbmRlcmlkID0gZ2VuZGVyaWQgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0dXJuT25Ub29sdGlwc0ZvclRhYihcImdlbmRlcnNcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG5cdC8vIENvZGUgdG8gaGFuZGxlIGFkZGluZyBuZXcgZ2VuZGVycyB0byB0aGUgcGFnZVxuXHR2YXIgZXhpc3RpZCA9IDE7XG4gICAgdmFyIGV4aXN0T3BlbiA9IGZhbHNlO1xuXHRpZiAoJCgnI2V4aXN0c3RhYicpLmV4aXN0cygpKXtcblx0XHQkKCcjZXhpc3RzdGFiJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIC8vIERvbid0IG9wZW4gYSBzZWNvbmQgdGltZVxuICAgICAgICAgICAgaWYgKGV4aXN0T3BlbilcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgICQuZ2V0KHNuYWNVcmwrXCIvZWRpdF9wYXJ0L1wiKyQoJyNjb25zdGVsbGF0aW9uaWQnKS52YWwoKStcIi9cIiskKCcjdmVyc2lvbicpLnZhbCgpK1wiP3BhcnQ9ZGF0ZXNcIiwgbnVsbCwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBleGlzdE9wZW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgICQoJyNkYXRlcycpLmh0bWwoZGF0YSk7XG5cbiAgICAgICAgICAgICAgICB0dXJuT25FZGl0RGVsZXRlQnV0dG9ucyhcImRhdGVzXCIpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCQoJyNuZXh0X2V4aXN0X2knKS5leGlzdHMoKSkge1xuICAgICAgICAgICAgICAgICAgICBleGlzdGlkID0gcGFyc2VJbnQoJCgnI25leHRfZXhpc3RfaScpLnRleHQoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTmV4dCBFeGlzdCBEYXRlIElEOiBcIiArIGV4aXN0aWQpO1xuICAgICAgICAgICAgICAgIGlmICgkKCcjYnRuX2FkZF9leGlzdF9kYXRlJykuZXhpc3RzKCkpe1xuICAgICAgICAgICAgICAgICAgICAkKCcjYnRuX2FkZF9leGlzdF9kYXRlJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldEVkaXRlZEZsYWcodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3NvbWV0aGluZ0hhc0JlZW5FZGl0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSAkKCcjZXhpc3RfZGF0ZV90ZW1wbGF0ZScpLmNsb25lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbCA9IHRleHQuaHRtbCgpLnJlcGxhY2UoL1paL2csIGV4aXN0aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2FkZF9leGlzdF9kaXYnKS5hZnRlcihodG1sKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR1cm5PbkJ1dHRvbnMoXCJleGlzdFwiLCBleGlzdGlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR1cm5PblRvb2x0aXBzKFwiZXhpc3RcIiwgZXhpc3RpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYWtlRWRpdGFibGUoXCJleGlzdFwiLCBleGlzdGlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4aXN0aWQgPSBleGlzdGlkICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICgkKCcjYnRuX2FkZF9leGlzdF9kYXRlUmFuZ2UnKS5leGlzdHMoKSl7XG4gICAgICAgICAgICAgICAgICAgICQoJyNidG5fYWRkX2V4aXN0X2RhdGVSYW5nZScpLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRFZGl0ZWRGbGFnKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9zb21ldGhpbmdIYXNCZWVuRWRpdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gJCgnI2V4aXN0X2RhdGVSYW5nZV90ZW1wbGF0ZScpLmNsb25lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbCA9IHRleHQuaHRtbCgpLnJlcGxhY2UoL1paL2csIGV4aXN0aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2FkZF9leGlzdF9kaXYnKS5hZnRlcihodG1sKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR1cm5PbkJ1dHRvbnMoXCJleGlzdFwiLCBleGlzdGlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR1cm5PblRvb2x0aXBzKFwiZXhpc3RcIiwgZXhpc3RpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYWtlRWRpdGFibGUoXCJleGlzdFwiLCBleGlzdGlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4aXN0aWQgPSBleGlzdGlkICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdHVybk9uVG9vbHRpcHNGb3JUYWIoXCJkYXRlc1wiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cblx0dmFyIHNhbWVBc2lkID0gMTtcbiAgICB2YXIgc2FtZUFzT3BlbiA9IGZhbHNlO1xuXHRpZiAoJCgnI3NhbWVBc3RhYicpLmV4aXN0cygpKXtcblx0XHQkKCcjc2FtZUFzdGFiJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIC8vIERvbid0IG9wZW4gYSBzZWNvbmQgdGltZVxuICAgICAgICAgICAgaWYgKHNhbWVBc09wZW4pXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgLy9zZXQgc2FtZUFzIHZvY2FiIHR5cGUgaWRcbiAgICAgICAgICAgICQuZ2V0KHNuYWNVcmwrXCIvdm9jYWJ1bGFyeT90eXBlPXJlY29yZF90eXBlJnE9U2FtZUFzXCIsIG51bGwsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBzYW1lQXNUZXJtSWQgPSBkYXRhLnJlc3VsdHNbMF0uaWQ7XG4gICAgICAgICAgICAgICAgJChcIiNzYW1lQXNfdHlwZV9pZF9aWlwiKS52YWwoc2FtZUFzVGVybUlkKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkLmdldChzbmFjVXJsK1wiL2VkaXRfcGFydC9cIiskKCcjY29uc3RlbGxhdGlvbmlkJykudmFsKCkrXCIvXCIrJCgnI3ZlcnNpb24nKS52YWwoKStcIj9wYXJ0PXNhbWVBc1wiLCBudWxsLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHNhbWVBc09wZW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgICQoJyNzYW1lQXMnKS5odG1sKGRhdGEpO1xuXG4gICAgICAgICAgICAgICAgdHVybk9uRWRpdERlbGV0ZUJ1dHRvbnMoXCJzYW1lQXNcIik7XG5cbiAgICAgICAgICAgICAgICBpZiAoJCgnI25leHRfc2FtZUFzX2knKS5leGlzdHMoKSkge1xuICAgICAgICAgICAgICAgICAgICBzYW1lQXNpZCA9IHBhcnNlSW50KCQoJyNuZXh0X3NhbWVBc19pJykudGV4dCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJOZXh0IHNhbWVBcyBJRDogXCIgKyBzYW1lQXNpZCk7XG4gICAgICAgICAgICAgICAgaWYgKCQoJyNidG5fYWRkX3NhbWVBcycpLmV4aXN0cygpKXtcbiAgICAgICAgICAgICAgICAgICAgJCgnI2J0bl9hZGRfc2FtZUFzJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldEVkaXRlZEZsYWcodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3NvbWV0aGluZ0hhc0JlZW5FZGl0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSAkKCcjc2FtZUFzX3RlbXBsYXRlJykuY2xvbmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBodG1sID0gdGV4dC5odG1sKCkucmVwbGFjZSgvWlovZywgc2FtZUFzaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2FkZF9zYW1lQXNfZGl2JykuYWZ0ZXIoaHRtbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0dXJuT25CdXR0b25zKFwic2FtZUFzXCIsIHNhbWVBc2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR1cm5PblRvb2x0aXBzKFwic2FtZUFzXCIsIHNhbWVBc2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VFZGl0YWJsZShcInNhbWVBc1wiLCBzYW1lQXNpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzYW1lQXNpZCA9IHNhbWVBc2lkICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdHVybk9uVG9vbHRpcHNGb3JUYWIoXCJzYW1lQXNcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG5cblx0dmFyIGVudGl0eUlEaWQgPSAxO1xuICAgIHZhciBlbnRpdHlJRE9wZW4gPSBmYWxzZTtcblx0aWYgKCQoJyNlbnRpdHlJRHRhYicpLmV4aXN0cygpKXtcblx0XHQkKCcjZW50aXR5SUR0YWInKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAgICAgLy8gRG9uJ3Qgb3BlbiBhIHNlY29uZCB0aW1lXG4gICAgICAgICAgICBpZiAoZW50aXR5SURPcGVuKVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgJC5nZXQoc25hY1VybCtcIi9lZGl0X3BhcnQvXCIrJCgnI2NvbnN0ZWxsYXRpb25pZCcpLnZhbCgpK1wiL1wiKyQoJyN2ZXJzaW9uJykudmFsKCkrXCI/cGFydD1lbnRpdHlJRFwiLCBudWxsLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGVudGl0eUlET3BlbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgJCgnI2VudGl0eUlEJykuaHRtbChkYXRhKTtcblxuICAgICAgICAgICAgICAgIHR1cm5PbkVkaXREZWxldGVCdXR0b25zKFwiZW50aXR5SURcIik7XG5cbiAgICAgICAgICAgICAgICBpZiAoJCgnI25leHRfZW50aXR5SURfaScpLmV4aXN0cygpKSB7XG4gICAgICAgICAgICAgICAgICAgIGVudGl0eUlEaWQgPSBwYXJzZUludCgkKCcjbmV4dF9lbnRpdHlJRF9pJykudGV4dCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJOZXh0IGVudGl0eUlEIElEOiBcIiArIGVudGl0eUlEaWQpO1xuICAgICAgICAgICAgICAgIGlmICgkKCcjYnRuX2FkZF9lbnRpdHlJRCcpLmV4aXN0cygpKXtcbiAgICAgICAgICAgICAgICAgICAgJCgnI2J0bl9hZGRfZW50aXR5SUQnKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0RWRpdGVkRmxhZyh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vc29tZXRoaW5nSGFzQmVlbkVkaXRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9ICQoJyNlbnRpdHlJRF90ZW1wbGF0ZScpLmNsb25lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbCA9IHRleHQuaHRtbCgpLnJlcGxhY2UoL1paL2csIGVudGl0eUlEaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2FkZF9lbnRpdHlJRF9kaXYnKS5hZnRlcihodG1sKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR1cm5PbkJ1dHRvbnMoXCJlbnRpdHlJRFwiLCBlbnRpdHlJRGlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR1cm5PblRvb2x0aXBzKFwiZW50aXR5SURcIiwgZW50aXR5SURpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYWtlRWRpdGFibGUoXCJlbnRpdHlJRFwiLCBlbnRpdHlJRGlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVudGl0eUlEaWQgPSBlbnRpdHlJRGlkICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdHVybk9uVG9vbHRpcHNGb3JUYWIoXCJlbnRpdHlJRFwiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cblx0dmFyIHNvdXJjZWlkID0gMTtcbiAgICB2YXIgc291cmNlT3BlbiA9IGZhbHNlO1xuXHRpZiAoJCgnI3NvdXJjZXN0YWInKS5leGlzdHMoKSl7XG5cdFx0JCgnI3NvdXJjZXN0YWInKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAgICAgLy8gRG9uJ3Qgb3BlbiBhIHNlY29uZCB0aW1lXG4gICAgICAgICAgICBpZiAoc291cmNlT3BlbilcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgICQuZ2V0KHNuYWNVcmwrXCIvZWRpdF9wYXJ0L1wiKyQoJyNjb25zdGVsbGF0aW9uaWQnKS52YWwoKStcIi9cIiskKCcjdmVyc2lvbicpLnZhbCgpK1wiP3BhcnQ9c291cmNlc1wiLCBudWxsLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHNvdXJjZU9wZW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgICQoJyNzb3VyY2VzJykuaHRtbChkYXRhKTtcblxuICAgICAgICAgICAgICAgIHR1cm5PbkVkaXREZWxldGVCdXR0b25zKFwic291cmNlc1wiKTtcblxuICAgICAgICAgICAgICAgIGlmICgkKCcjbmV4dF9zb3VyY2VfaScpLmV4aXN0cygpKSB7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZWlkID0gcGFyc2VJbnQoJCgnI25leHRfc291cmNlX2knKS50ZXh0KCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk5leHQgc291cmNlIElEOiBcIiArIHNvdXJjZWlkKTtcbiAgICAgICAgICAgICAgICBpZiAoJCgnI2J0bl9hZGRfc291cmNlJykuZXhpc3RzKCkpe1xuICAgICAgICAgICAgICAgICAgICAkKCcjYnRuX2FkZF9zb3VyY2UnKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0RWRpdGVkRmxhZyh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vc29tZXRoaW5nSGFzQmVlbkVkaXRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9ICQoJyNzb3VyY2VfdGVtcGxhdGUnKS5jbG9uZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWwgPSB0ZXh0Lmh0bWwoKS5yZXBsYWNlKC9aWi9nLCBzb3VyY2VpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcjYWRkX3NvdXJjZV9kaXYnKS5hZnRlcihodG1sKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR1cm5PbkJ1dHRvbnMoXCJzb3VyY2VcIiwgc291cmNlaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHVybk9uVG9vbHRpcHMoXCJzb3VyY2VcIiwgc291cmNlaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFrZUVkaXRhYmxlKFwic291cmNlXCIsIHNvdXJjZWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZWlkID0gc291cmNlaWQgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0dXJuT25Ub29sdGlwc0ZvclRhYihcInNvdXJjZXNcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG5cdHZhciByZXNvdXJjZVJlbGF0aW9uaWQgPSAxO1xuICAgIHZhciByZXNvdXJjZVJlbGF0aW9uT3BlbiA9IGZhbHNlO1xuXHRpZiAoJCgnI3Jlc291cmNlUmVsYXRpb25zdGFiJykuZXhpc3RzKCkpe1xuXHRcdCQoJyNyZXNvdXJjZVJlbGF0aW9uc3RhYicpLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAvLyBEb24ndCBvcGVuIGEgc2Vjb25kIHRpbWVcbiAgICAgICAgICAgIGlmIChyZXNvdXJjZVJlbGF0aW9uT3BlbilcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgICQuZ2V0KHNuYWNVcmwrXCIvZWRpdF9wYXJ0L1wiKyQoJyNjb25zdGVsbGF0aW9uaWQnKS52YWwoKStcIi9cIiskKCcjdmVyc2lvbicpLnZhbCgpK1wiP3BhcnQ9cmVzb3VyY2VSZWxhdGlvbnNcIiwgbnVsbCwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXNvdXJjZVJlbGF0aW9uT3BlbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgJCgnI3Jlc291cmNlUmVsYXRpb25zJykuaHRtbChkYXRhKTtcblxuICAgICAgICAgICAgICAgIHR1cm5PbkVkaXREZWxldGVCdXR0b25zKFwicmVzb3VyY2VSZWxhdGlvbnNcIik7XG5cbiAgICAgICAgICAgICAgICBpZiAoJCgnI25leHRfcmVzb3VyY2VSZWxhdGlvbl9pJykuZXhpc3RzKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2VSZWxhdGlvbmlkID0gcGFyc2VJbnQoJCgnI25leHRfcmVzb3VyY2VSZWxhdGlvbl9pJykudGV4dCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJOZXh0IHJlc291cmNlUmVsYXRpb24gSUQ6IFwiICsgcmVzb3VyY2VSZWxhdGlvbmlkKTtcbiAgICAgICAgICAgICAgICAgaWYgKCQoJyNidG5fY3JlYXRlX3Jlc291cmNlUmVsYXRpb24nKS5leGlzdHMoKSl7XG4gICAgICAgICAgICAgICAgICAgICQoJyNidG5fY3JlYXRlX3Jlc291cmNlUmVsYXRpb24nKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJpZCA9ICQoJ2lucHV0W25hbWU9cmVzb3VyY2VDaG9pY2VdOmNoZWNrZWQnLCAnI3Jlc291cmNlX3NlYXJjaF9mb3JtJykudmFsKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmlkICE9IG51bGwgJiYgcmVzb3VyY2VSZXN1bHRzICE9IG51bGwgJiYgcmlkICE9ICduZXcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0RWRpdGVkRmxhZyh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3NvbWV0aGluZ0hhc0JlZW5FZGl0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gJCgnI3Jlc291cmNlUmVsYXRpb25fdGVtcGxhdGUnKS5jbG9uZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBodG1sID0gdGV4dC5odG1sKCkucmVwbGFjZSgvWlovZywgcmVzb3VyY2VSZWxhdGlvbmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjYWRkX3Jlc291cmNlUmVsYXRpb25fZGl2JykuYWZ0ZXIoaHRtbCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHJlc291cmNlUmVzdWx0c1tyaWRdLmlkICE9PSAndW5kZWZpbmVkJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3Jlc291cmNlUmVsYXRpb25fcmVzb3VyY2VpZF8nK3Jlc291cmNlUmVsYXRpb25pZCkudmFsKHJlc291cmNlUmVzdWx0c1tyaWRdLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHJlc291cmNlUmVzdWx0c1tyaWRdLnZlcnNpb24gIT09ICd1bmRlZmluZWQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjcmVzb3VyY2VSZWxhdGlvbl9yZXNvdXJjZXZlcnNpb25fJytyZXNvdXJjZVJlbGF0aW9uaWQpLnZhbChyZXNvdXJjZVJlc3VsdHNbcmlkXS52ZXJzaW9uKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVzb3VyY2VSZXN1bHRzW3JpZF0ubGluayAhPT0gJ3VuZGVmaW5lZCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNyZXNvdXJjZVJlbGF0aW9uX2xpbmtUZXh0XycrcmVzb3VyY2VSZWxhdGlvbmlkKS5odG1sKFwiPGEgdGFyZ2V0PSdfYmxhbmsnIGhyZWY9J1wiK3Jlc291cmNlUmVzdWx0c1tyaWRdLmxpbmsrXCInPlwiK3Jlc291cmNlUmVzdWx0c1tyaWRdLmxpbmsrXCI8L2E+XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgPGEgY2xhc3M9J2xhYmVsIGxhYmVsLWluZm8nIHRhcmdldD0nX2JsYW5rJyBocmVmPSdcIityZXNvdXJjZVJlc3VsdHNbcmlkXS5saW5rK1wiJz5WaWV3PC9hPlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHJlc291cmNlUmVzdWx0c1tyaWRdLmRpc3BsYXlFbnRyeSAhPT0gJ3VuZGVmaW5lZCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNyZXNvdXJjZVJlbGF0aW9uX2Rpc3BsYXlFbnRyeVRleHRfJytyZXNvdXJjZVJlbGF0aW9uaWQpLnRleHQocmVzb3VyY2VSZXN1bHRzW3JpZF0uZGlzcGxheUVudHJ5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHJlc291cmNlUmVzdWx0c1tyaWRdLnRpdGxlICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjcmVzb3VyY2VSZWxhdGlvbl90aXRsZVRleHRfJytyZXNvdXJjZVJlbGF0aW9uaWQpLnRleHQocmVzb3VyY2VSZXN1bHRzW3JpZF0udGl0bGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVQaWN0dXJlVGl0bGUoJ3Jlc291cmNlUmVsYXRpb24nLCByZXNvdXJjZVJlbGF0aW9uaWQsIHJlc291cmNlUmVzdWx0c1tyaWRdLnRpdGxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiByZXNvdXJjZVJlc3VsdHNbcmlkXS5hYnN0cmFjdCAhPT0gJ3VuZGVmaW5lZCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNyZXNvdXJjZVJlbGF0aW9uX2Fic3RyYWN0VGV4dF8nK3Jlc291cmNlUmVsYXRpb25pZCkudGV4dChyZXNvdXJjZVJlc3VsdHNbcmlkXS5hYnN0cmFjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiByZXNvdXJjZVJlc3VsdHNbcmlkXS5leHRlbnQgIT09ICd1bmRlZmluZWQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjcmVzb3VyY2VSZWxhdGlvbl9leHRlbnRUZXh0XycrcmVzb3VyY2VSZWxhdGlvbmlkKS50ZXh0KHJlc291cmNlUmVzdWx0c1tyaWRdLmV4dGVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgKHR5cGVvZiByZXNvdXJjZVJlc3VsdHNbcmlkXS5kYXRlICE9PSAndW5kZWZpbmVkJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgJCgnI3Jlc291cmNlUmVsYXRpb25fZGF0ZVRleHRfJytyZXNvdXJjZVJlbGF0aW9uaWQpLnRleHQocmVzb3VyY2VSZXN1bHRzW3JpZF0uZGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiByZXNvdXJjZVJlc3VsdHNbcmlkXS5kb2N1bWVudFR5cGUgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiByZXNvdXJjZVJlc3VsdHNbcmlkXS5kb2N1bWVudFR5cGUudGVybSAhPT0gJ3VuZGVmaW5lZCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNyZXNvdXJjZVJlbGF0aW9uX2RvY3VtZW50VHlwZVRleHRfJytyZXNvdXJjZVJlbGF0aW9uaWQpLnRleHQocmVzb3VyY2VSZXN1bHRzW3JpZF0uZG9jdW1lbnRUeXBlLnRlcm0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3Jlc291cmNlUmVsYXRpb25fbGlua1RleHRfJytyZXNvdXJjZVJlbGF0aW9uaWQpLmFmdGVyKFwiPGEgY2xhc3M9J2NvbnRyb2wtbGFiZWwtc3VidGV4dCcgdGFyZ2V0PSdfYmxhbmsnIGhyZWY9J1wiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc25hY1VybCtcIi92b2NhYl9hZG1pbmlzdHJhdG9yL3Jlc291cmNlcy9cIityZXNvdXJjZVJlc3VsdHNbcmlkXS5pZCtcIic+VmlldyBpbiBTTkFDPC9hPlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0dXJuT25CdXR0b25zKFwicmVzb3VyY2VSZWxhdGlvblwiLCByZXNvdXJjZVJlbGF0aW9uaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR1cm5PblRvb2x0aXBzKFwicmVzb3VyY2VSZWxhdGlvblwiLCByZXNvdXJjZVJlbGF0aW9uaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VFZGl0YWJsZShcInJlc291cmNlUmVsYXRpb25cIiwgcmVzb3VyY2VSZWxhdGlvbmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvdXJjZVJlbGF0aW9uaWQgPSByZXNvdXJjZVJlbGF0aW9uaWQgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoXCIjcmVzb3VyY2UtcmVzdWx0cy1ib3hcIikuaHRtbChcIlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKCQoJyNidG5fb3Blbl9jcmVhdGVfcmVzb3VyY2UnKS5leGlzdHMoKSl7XG4gICAgICAgICAgICAgICAgICAgICQoJyNidG5fb3Blbl9jcmVhdGVfcmVzb3VyY2UnKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2xvc2UgdGhpcyBtb2RhbCBhbmQgb3BlbiB0aGUgbmV3IG1vZGFsXG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiI3Jlc291cmNlU2VhcmNoUGFuZVwiKS5tb2RhbChcImhpZGVcIik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCBhIDUwMG1zIHRpbWVvdXQgdG8gZ2l2ZSB0aGUgaGlkZGVuIHNlYXJjaCBwYW5lIHRpbWUgdG8gZnVsbHkgY2xvc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7JChcIiNyZXNvdXJjZUNyZWF0ZVBhbmVcIikubW9kYWwoXCJzaG93XCIpO30sIDUwMCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdyYWIgdGhlIGVtcHR5IHRlbXBsYXRlIGFuZCByZXBsYWNlXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9ICQoJyNyZXNvdXJjZV90ZW1wbGF0ZScpLmNsb25lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbCA9IHRleHQuaHRtbCgpLnJlcGxhY2UoL1paL2csIDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3Jlc291cmNlLWNyZWF0ZS1ib3gnKS5odG1sKGh0bWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRyZXNvdXJjZUZvcm0gPSAkKFwiI3Jlc291cmNlX2NyZWF0ZV9mb3JtXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29weSB0aGUgc2VhcmNoIGNvbnRlbnRzIHRvIHRpdGxlIG9yIGhyZWZcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkKFwiI3Jlc291cmNlLXNlYXJjaGJveFwiKS52YWwoKS5pbmRleE9mKFwiaHR0cFwiKSA9PSAtMSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVzb3VyY2VGb3JtLmZpbmQoXCIjcmVzb3VyY2UtdGl0bGVcIikudmFsKCQoXCIjcmVzb3VyY2Utc2VhcmNoYm94XCIpLnZhbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVzb3VyY2VGb3JtLmZpbmQoXCIjcmVzb3VyY2UtdXJsXCIpLnZhbCgkKFwiI3Jlc291cmNlLXNlYXJjaGJveFwiKS52YWwoKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICRyZXNvdXJjZUZvcm0uZmluZCgnW2RhdGEtdG9nZ2xlPVwicG9wb3ZlclwiXScpLnBvcG92ZXIoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJpZ2dlcjogJ2hvdmVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lcjogJ2JvZHknXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRWb2NhYlNlbGVjdE9wdGlvbnMoJHJlc291cmNlRm9ybS5maW5kKFwiI3Jlc291cmNlLXR5cGUtc2VsZWN0XCIpLCBcImRvY3VtZW50X3R5cGVcIiwgXCJSZXNvdXJjZSBUeXBlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdm9jYWJfc2VsZWN0X3JlcGxhY2UoJHJlc291cmNlRm9ybS5maW5kKFwiI3Jlc291cmNlLXJlcG9cIiksIFwiXCIsIFwiaG9sZGluZ1wiLCAzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyZXNvdXJjZUZvcm0uZmluZChcIiNuZXctcmVzb3VyY2UtbGFuZ3VhZ2UtYnRuXCIpLm9uKFwiY2xpY2tcIiwgbmV3UmVzb3VyY2VMYW5ndWFnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcmVzb3VyY2VGb3JtLmZpbmQoXCIjbWFnaWMtcmVzb3VyY2UtbGFuZ3VhZ2UtYnRuXCIpLm9uKFwiY2xpY2tcIiwgbWFnaWNOZXdSZXNvdXJjZUxhbmd1YWdlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3NlYXJjaC1yZXN1bHRzLWJveCcpLm9uKFwiY2xpY2tcIiwgXCJhLmxpc3QtZ3JvdXAtaXRlbVwiLCBzZWxlY3RIb2xkaW5nUmVwb3NpdG9yeSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGltZW91dElEID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyZXNvdXJjZUZvcm0uZmluZCgnI3NlYXJjaGJveCcpLmtleXVwKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SUQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVvdXRJRCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7IHNldFNlYXJjaFBvc2l0aW9uKDApOyBzZWFyY2hBbmRVcGRhdGUoKTsgfSwgNTAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgdGhlIHNlYXJjaCByZXN1bHRzIGZyb20gdGhlIG90aGVyIG1vZGFsXG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiI3Jlc291cmNlLXJlc3VsdHMtYm94XCIpLmh0bWwoXCJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICgkKCcjYnRuX2NyZWF0ZV9yZXNvdXJjZScpLmV4aXN0cygpKXtcbiAgICAgICAgICAgICAgICAgICAgJCgnI3Jlc291cmNlX2NyZWF0ZV9mb3JtJykub24oXCJzdWJtaXRcIiwgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgbGVhZGluZyBhbmQgdHJhaWxpbmcgd2hpdGVzcGFjZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkKFwiI3Jlc291cmNlX2NyZWF0ZV9mb3JtICNyZXNvdXJjZS11cmxcIikudmFsKCkgPT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNvbmZpcm0oJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBzYXZlIHdpdGhvdXQgYW4gSFJFRj8nKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoXCIjcmVzb3VyY2VfY3JlYXRlX2Zvcm0gaW5wdXQsIHRleHRhcmVhXCIpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykudmFsKCQudHJpbSgkKHRoaXMpLnZhbCgpKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0RGVsZXRlZFJlc291cmNlTGFuZ3VhZ2VPcGVyYXRpb25zKCQoXCIjcmVzb3VyY2VfY3JlYXRlX2Zvcm1cIikpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJC5wb3N0KHNuYWNVcmwrXCIvc2F2ZV9yZXNvdXJjZVwiLCAkKFwiI3Jlc291cmNlX2NyZWF0ZV9mb3JtXCIpLnNlcmlhbGl6ZSgpLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRhdGEucmVzdWx0ICE9PSAndW5kZWZpbmVkJyAmJiBkYXRhLnJlc3VsdCAhPT0gJ2ZhbHNlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0RWRpdGVkRmxhZyh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vc29tZXRoaW5nSGFzQmVlbkVkaXRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9ICQoJyNyZXNvdXJjZVJlbGF0aW9uX3RlbXBsYXRlJykuY2xvbmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBodG1sID0gdGV4dC5odG1sKCkucmVwbGFjZSgvWlovZywgcmVzb3VyY2VSZWxhdGlvbmlkKTsgLy8gY2xvbmVzIERPTSwgcmVwbGFjZXMgenogd2l0aCBuZXh0IGlkc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2FkZF9yZXNvdXJjZVJlbGF0aW9uX2RpdicpLmFmdGVyKGh0bWwpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRhdGEucmVzb3VyY2UuaWQgIT09ICd1bmRlZmluZWQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNyZXNvdXJjZVJlbGF0aW9uX3Jlc291cmNlaWRfJytyZXNvdXJjZVJlbGF0aW9uaWQpLnZhbChkYXRhLnJlc291cmNlLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZGF0YS5yZXNvdXJjZS52ZXJzaW9uICE9PSAndW5kZWZpbmVkJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjcmVzb3VyY2VSZWxhdGlvbl9yZXNvdXJjZXZlcnNpb25fJytyZXNvdXJjZVJlbGF0aW9uaWQpLnZhbChkYXRhLnJlc291cmNlLnZlcnNpb24pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRhdGEucmVzb3VyY2UubGluayAhPT0gJ3VuZGVmaW5lZCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3Jlc291cmNlUmVsYXRpb25fbGlua1RleHRfJytyZXNvdXJjZVJlbGF0aW9uaWQpLmh0bWwoXCI8YSB0YXJnZXQ9J19ibGFuaycgaHJlZj0nXCIrZGF0YS5yZXNvdXJjZS5saW5rK1wiJz5cIitkYXRhLnJlc291cmNlLmxpbmsrXCI8L2E+XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiA8YSBjbGFzcz0nbGFiZWwgbGFiZWwtaW5mbycgdGFyZ2V0PSdfYmxhbmsnIGhyZWY9J1wiK2RhdGEucmVzb3VyY2UubGluaytcIic+VmlldzwvYT5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRhdGEucmVzb3VyY2UuZGlzcGxheUVudHJ5ICE9PSAndW5kZWZpbmVkJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjcmVzb3VyY2VSZWxhdGlvbl9kaXNwbGF5RW50cnlUZXh0XycrcmVzb3VyY2VSZWxhdGlvbmlkKS50ZXh0KGRhdGEucmVzb3VyY2UuZGlzcGxheUVudHJ5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZGF0YS5yZXNvdXJjZS50aXRsZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjcmVzb3VyY2VSZWxhdGlvbl90aXRsZVRleHRfJytyZXNvdXJjZVJlbGF0aW9uaWQpLnRleHQoZGF0YS5yZXNvdXJjZS50aXRsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlUGljdHVyZVRpdGxlKCdyZXNvdXJjZVJlbGF0aW9uJywgcmVzb3VyY2VSZWxhdGlvbmlkLCBkYXRhLnJlc291cmNlLnRpdGxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZGF0YS5yZXNvdXJjZS5hYnN0cmFjdCAhPT0gJ3VuZGVmaW5lZCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3Jlc291cmNlUmVsYXRpb25fYWJzdHJhY3RUZXh0XycrcmVzb3VyY2VSZWxhdGlvbmlkKS50ZXh0KGRhdGEucmVzb3VyY2UuYWJzdHJhY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBkYXRhLnJlc291cmNlLmV4dGVudCAhPT0gJ3VuZGVmaW5lZCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3Jlc291cmNlUmVsYXRpb25fZXh0ZW50VGV4dF8nK3Jlc291cmNlUmVsYXRpb25pZCkudGV4dChkYXRhLnJlc291cmNlLmV4dGVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRhdGEucmVzb3VyY2UuZG9jdW1lbnRUeXBlICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgZGF0YS5yZXNvdXJjZS5kb2N1bWVudFR5cGUudGVybSAhPT0gJ3VuZGVmaW5lZCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3Jlc291cmNlUmVsYXRpb25fZG9jdW1lbnRUeXBlVGV4dF8nK3Jlc291cmNlUmVsYXRpb25pZCkudGV4dChkYXRhLnJlc291cmNlLmRvY3VtZW50VHlwZS50ZXJtKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3Jlc291cmNlUmVsYXRpb25fbGlua1RleHRfJytyZXNvdXJjZVJlbGF0aW9uaWQpLmFmdGVyKFwiPGEgY2xhc3M9J2NvbnRyb2wtbGFiZWwtc3VidGV4dCcgdGFyZ2V0PSdfYmxhbmsnIGhyZWY9J1wiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbmFjVXJsK1wiL3ZvY2FiX2FkbWluaXN0cmF0b3IvcmVzb3VyY2VzL1wiK2RhdGEucmVzb3VyY2UuaWQrXCInPlZpZXcgaW4gU05BQzwvYT5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0dXJuT25CdXR0b25zKFwicmVzb3VyY2VSZWxhdGlvblwiLCByZXNvdXJjZVJlbGF0aW9uaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHVybk9uVG9vbHRpcHMoXCJyZXNvdXJjZVJlbGF0aW9uXCIsIHJlc291cmNlUmVsYXRpb25pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWtlRWRpdGFibGUoXCJyZXNvdXJjZVJlbGF0aW9uXCIsIHJlc291cmNlUmVsYXRpb25pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvdXJjZVJlbGF0aW9uaWQgPSByZXNvdXJjZVJlbGF0aW9uaWQgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJChcIiNyZXNvdXJjZUNyZWF0ZVBhbmVcIikubW9kYWwoXCJoaWRlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3Jlc291cmNlLWNyZWF0ZS1ib3gnKS5odG1sKFwiXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0dXJuT25Ub29sdGlwc0ZvclRhYihcInJlc291cmNlUmVsYXRpb25zXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuXG5cdHZhciBjb25zdGVsbGF0aW9uUmVsYXRpb25pZCA9IDE7XG4gICAgdmFyIGNvbnN0ZWxsYXRpb25SZWxhdGlvbk9wZW4gPSBmYWxzZTtcblx0aWYgKCQoJyNjb25zdGVsbGF0aW9uUmVsYXRpb25zdGFiJykuZXhpc3RzKCkpe1xuXHRcdCQoJyNjb25zdGVsbGF0aW9uUmVsYXRpb25zdGFiJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIC8vIERvbid0IG9wZW4gYSBzZWNvbmQgdGltZVxuICAgICAgICAgICAgaWYgKGNvbnN0ZWxsYXRpb25SZWxhdGlvbk9wZW4pXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICAkLmdldChzbmFjVXJsK1wiL2VkaXRfcGFydC9cIiskKCcjY29uc3RlbGxhdGlvbmlkJykudmFsKCkrXCIvXCIrJCgnI3ZlcnNpb24nKS52YWwoKStcIj9wYXJ0PWNvbnN0ZWxsYXRpb25SZWxhdGlvbnNcIiwgbnVsbCwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBjb25zdGVsbGF0aW9uUmVsYXRpb25PcGVuID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAkKCcjY29uc3RlbGxhdGlvblJlbGF0aW9ucycpLmh0bWwoZGF0YSk7XG5cbiAgICAgICAgICAgICAgICB0dXJuT25FZGl0RGVsZXRlQnV0dG9ucyhcImNvbnN0ZWxsYXRpb25SZWxhdGlvbnNcIik7XG5cbiAgICAgICAgICAgICAgICBpZiAoJCgnI25leHRfY29uc3RlbGxhdGlvblJlbGF0aW9uX2knKS5leGlzdHMoKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdGVsbGF0aW9uUmVsYXRpb25pZCA9IHBhcnNlSW50KCQoJyNuZXh0X2NvbnN0ZWxsYXRpb25SZWxhdGlvbl9pJykudGV4dCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJOZXh0IGNvbnN0ZWxsYXRpb25SZWxhdGlvbiBJRDogXCIgKyBjb25zdGVsbGF0aW9uUmVsYXRpb25pZCk7XG4gICAgICAgICAgICAgICAgaWYgKCQoJyNidG5fY3JlYXRlX2NvbnN0ZWxsYXRpb25SZWxhdGlvbicpLmV4aXN0cygpKXtcbiAgICAgICAgICAgICAgICAgICAgJCgnI2J0bl9jcmVhdGVfY29uc3RlbGxhdGlvblJlbGF0aW9uJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaWQgPSAkKCdpbnB1dFtuYW1lPXJlbGF0aW9uQ2hvaWNlXTpjaGVja2VkJywgJyNyZWxhdGlvbl9zZWFyY2hfZm9ybScpLnZhbCgpXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2lkICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRFZGl0ZWRGbGFnKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vc29tZXRoaW5nSGFzQmVlbkVkaXRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSAkKCcjY29uc3RlbGxhdGlvblJlbGF0aW9uX3RlbXBsYXRlJykuY2xvbmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbCA9IHRleHQuaHRtbCgpLnJlcGxhY2UoL1paL2csIGNvbnN0ZWxsYXRpb25SZWxhdGlvbmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjYWRkX2NvbnN0ZWxsYXRpb25SZWxhdGlvbl9kaXYnKS5hZnRlcihodG1sKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjY29uc3RlbGxhdGlvblJlbGF0aW9uX3RhcmdldElEXycrY29uc3RlbGxhdGlvblJlbGF0aW9uaWQpLnZhbChjaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNjb25zdGVsbGF0aW9uUmVsYXRpb25fY29udGVudF8nK2NvbnN0ZWxsYXRpb25SZWxhdGlvbmlkKS52YWwoJCgnI3JlbGF0aW9uQ2hvaWNlX25hbWVFbnRyeV8nK2NpZCkudmFsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNjb25zdGVsbGF0aW9uUmVsYXRpb25fdGFyZ2V0QXJrSURfJytjb25zdGVsbGF0aW9uUmVsYXRpb25pZCkudmFsKCQoJyNyZWxhdGlvbkNob2ljZV9hcmtJRF8nK2NpZCkudmFsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNjb25zdGVsbGF0aW9uUmVsYXRpb25fdGFyZ2V0RW50aXR5VHlwZV8nK2NvbnN0ZWxsYXRpb25SZWxhdGlvbmlkKS52YWwoJCgnI3JlbGF0aW9uQ2hvaWNlX2VudGl0eVR5cGVfJytjaWQpLnZhbCgpKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVBpY3R1cmVJY29uKCdjb25zdGVsbGF0aW9uUmVsYXRpb24nLCBjb25zdGVsbGF0aW9uUmVsYXRpb25pZCwgJCgnI3JlbGF0aW9uQ2hvaWNlX2VudGl0eVR5cGVUZXh0XycrY2lkKS52YWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlUGljdHVyZVRpdGxlKCdjb25zdGVsbGF0aW9uUmVsYXRpb24nLCBjb25zdGVsbGF0aW9uUmVsYXRpb25pZCwgJCgnI3JlbGF0aW9uQ2hvaWNlX25hbWVFbnRyeV8nK2NpZCkudmFsKCkpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2NvbnN0ZWxsYXRpb25SZWxhdGlvbl9jb250ZW50VGV4dF8nK2NvbnN0ZWxsYXRpb25SZWxhdGlvbmlkKS50ZXh0KCQoJyNyZWxhdGlvbkNob2ljZV9uYW1lRW50cnlfJytjaWQpLnZhbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjY29uc3RlbGxhdGlvblJlbGF0aW9uX3RhcmdldEFya0lEVGV4dF8nK2NvbnN0ZWxsYXRpb25SZWxhdGlvbmlkKS50ZXh0KCQoJyNyZWxhdGlvbkNob2ljZV9hcmtJRF8nK2NpZCkudmFsKCkpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHVybk9uQnV0dG9ucyhcImNvbnN0ZWxsYXRpb25SZWxhdGlvblwiLCBjb25zdGVsbGF0aW9uUmVsYXRpb25pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHVybk9uVG9vbHRpcHMoXCJjb25zdGVsbGF0aW9uUmVsYXRpb25cIiwgY29uc3RlbGxhdGlvblJlbGF0aW9uaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VFZGl0YWJsZShcImNvbnN0ZWxsYXRpb25SZWxhdGlvblwiLCBjb25zdGVsbGF0aW9uUmVsYXRpb25pZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdGVsbGF0aW9uUmVsYXRpb25pZCA9IGNvbnN0ZWxsYXRpb25SZWxhdGlvbmlkICsgMTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0dXJuT25Ub29sdGlwc0ZvclRhYihcImNvbnN0ZWxsYXRpb25SZWxhdGlvbnNcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG5cdHZhciBsYW5ndWFnZWlkID0gMTtcbiAgICB2YXIgbGFuZ3VhZ2VPcGVuID0gZmFsc2U7XG5cdGlmICgkKCcjbGFuZ3VhZ2VzVXNlZHRhYicpLmV4aXN0cygpKXtcblx0XHQkKCcjbGFuZ3VhZ2VzVXNlZHRhYicpLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAvLyBEb24ndCBvcGVuIGEgc2Vjb25kIHRpbWVcbiAgICAgICAgICAgIGlmIChsYW5ndWFnZU9wZW4pXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICAkLmdldChzbmFjVXJsK1wiL2VkaXRfcGFydC9cIiskKCcjY29uc3RlbGxhdGlvbmlkJykudmFsKCkrXCIvXCIrJCgnI3ZlcnNpb24nKS52YWwoKStcIj9wYXJ0PWxhbmd1YWdlc1VzZWRcIiwgbnVsbCwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBsYW5ndWFnZU9wZW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgICQoJyNsYW5ndWFnZXNVc2VkJykuaHRtbChkYXRhKTtcblxuICAgICAgICAgICAgICAgIHR1cm5PbkVkaXREZWxldGVCdXR0b25zKFwibGFuZ3VhZ2VzVXNlZFwiKTtcblxuICAgICAgICAgICAgICAgIGlmICgkKCcjbmV4dF9sYW5ndWFnZV9pJykuZXhpc3RzKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgbGFuZ3VhZ2VpZCA9IHBhcnNlSW50KCQoJyNuZXh0X2xhbmd1YWdlX2knKS50ZXh0KCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk5leHQgbGFuZ3VhZ2UgSUQ6IFwiICsgbGFuZ3VhZ2VpZCk7XG4gICAgICAgICAgICAgICAgaWYgKCQoJyNidG5fYWRkX2xhbmd1YWdlJykuZXhpc3RzKCkpe1xuICAgICAgICAgICAgICAgICAgICAkKCcjYnRuX2FkZF9sYW5ndWFnZScpLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRFZGl0ZWRGbGFnKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9zb21ldGhpbmdIYXNCZWVuRWRpdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gJCgnI2xhbmd1YWdlX3RlbXBsYXRlJykuY2xvbmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBodG1sID0gdGV4dC5odG1sKCkucmVwbGFjZSgvWlovZywgbGFuZ3VhZ2VpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcjYWRkX2xhbmd1YWdlX2RpdicpLmFmdGVyKGh0bWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHVybk9uQnV0dG9ucyhcImxhbmd1YWdlXCIsIGxhbmd1YWdlaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHVybk9uVG9vbHRpcHMoXCJsYW5ndWFnZVwiLCBsYW5ndWFnZWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VFZGl0YWJsZShcImxhbmd1YWdlXCIsIGxhbmd1YWdlaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFuZ3VhZ2VpZCA9IGxhbmd1YWdlaWQgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0dXJuT25Ub29sdGlwc0ZvclRhYihcImxhbmd1YWdlc1VzZWRcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG5cdHZhciBzdWJqZWN0aWQgPSAxO1xuICAgIHZhciBzdWJqZWN0T3BlbiA9IGZhbHNlO1xuXHRpZiAoJCgnI3N1YmplY3RzdGFiJykuZXhpc3RzKCkpe1xuXHRcdCQoJyNzdWJqZWN0c3RhYicpLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAvLyBEb24ndCBvcGVuIGEgc2Vjb25kIHRpbWVcbiAgICAgICAgICAgIGlmIChzdWJqZWN0T3BlbilcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgICQuZ2V0KHNuYWNVcmwrXCIvZWRpdF9wYXJ0L1wiKyQoJyNjb25zdGVsbGF0aW9uaWQnKS52YWwoKStcIi9cIiskKCcjdmVyc2lvbicpLnZhbCgpK1wiP3BhcnQ9c3ViamVjdHNcIiwgbnVsbCwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBzdWJqZWN0T3BlbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgJCgnI3N1YmplY3RzJykuaHRtbChkYXRhKTtcblxuICAgICAgICAgICAgICAgIHR1cm5PbkVkaXREZWxldGVCdXR0b25zKFwic3ViamVjdHNcIik7XG5cbiAgICAgICAgICAgICAgICBpZiAoJCgnI25leHRfc3ViamVjdF9pJykuZXhpc3RzKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgc3ViamVjdGlkID0gcGFyc2VJbnQoJCgnI25leHRfc3ViamVjdF9pJykudGV4dCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJOZXh0IHN1YmplY3QgSUQ6IFwiICsgc3ViamVjdGlkKTtcbiAgICAgICAgICAgICAgICBpZiAoJCgnI2J0bl9hZGRfc3ViamVjdCcpLmV4aXN0cygpKXtcbiAgICAgICAgICAgICAgICAgICAgJCgnI2J0bl9hZGRfc3ViamVjdCcpLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRFZGl0ZWRGbGFnKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9zb21ldGhpbmdIYXNCZWVuRWRpdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gJCgnI3N1YmplY3RfdGVtcGxhdGUnKS5jbG9uZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWwgPSB0ZXh0Lmh0bWwoKS5yZXBsYWNlKC9aWi9nLCBzdWJqZWN0aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2FkZF9zdWJqZWN0X2RpdicpLmFmdGVyKGh0bWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHVybk9uQnV0dG9ucyhcInN1YmplY3RcIiwgc3ViamVjdGlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR1cm5PblRvb2x0aXBzKFwic3ViamVjdFwiLCBzdWJqZWN0aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFrZUVkaXRhYmxlKFwic3ViamVjdFwiLCBzdWJqZWN0aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3ViamVjdGlkID0gc3ViamVjdGlkICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdHVybk9uVG9vbHRpcHNGb3JUYWIoXCJzdWJqZWN0c1wiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cblx0dmFyIG5hdGlvbmFsaXR5aWQgPSAxO1xuICAgIHZhciBuYXRpb25hbGl0eU9wZW4gPSBmYWxzZTtcblx0aWYgKCQoJyNuYXRpb25hbGl0aWVzdGFiJykuZXhpc3RzKCkpe1xuXHRcdCQoJyNuYXRpb25hbGl0aWVzdGFiJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIC8vIERvbid0IG9wZW4gYSBzZWNvbmQgdGltZVxuICAgICAgICAgICAgaWYgKG5hdGlvbmFsaXR5T3BlbilcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgICQuZ2V0KHNuYWNVcmwrXCIvZWRpdF9wYXJ0L1wiKyQoJyNjb25zdGVsbGF0aW9uaWQnKS52YWwoKStcIi9cIiskKCcjdmVyc2lvbicpLnZhbCgpK1wiP3BhcnQ9bmF0aW9uYWxpdGllc1wiLCBudWxsLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIG5hdGlvbmFsaXR5T3BlbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgJCgnI25hdGlvbmFsaXRpZXMnKS5odG1sKGRhdGEpO1xuXG4gICAgICAgICAgICAgICAgdHVybk9uRWRpdERlbGV0ZUJ1dHRvbnMoXCJuYXRpb25hbGl0aWVzXCIpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCQoJyNuZXh0X25hdGlvbmFsaXR5X2knKS5leGlzdHMoKSkge1xuICAgICAgICAgICAgICAgICAgICBuYXRpb25hbGl0eWlkID0gcGFyc2VJbnQoJCgnI25leHRfbmF0aW9uYWxpdHlfaScpLnRleHQoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTmV4dCBuYXRpb25hbGl0eSBJRDogXCIgKyBuYXRpb25hbGl0eWlkKTtcbiAgICAgICAgICAgICAgICBpZiAoJCgnI2J0bl9hZGRfbmF0aW9uYWxpdHknKS5leGlzdHMoKSl7XG4gICAgICAgICAgICAgICAgICAgICQoJyNidG5fYWRkX25hdGlvbmFsaXR5JykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldEVkaXRlZEZsYWcodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3NvbWV0aGluZ0hhc0JlZW5FZGl0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSAkKCcjbmF0aW9uYWxpdHlfdGVtcGxhdGUnKS5jbG9uZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWwgPSB0ZXh0Lmh0bWwoKS5yZXBsYWNlKC9aWi9nLCBuYXRpb25hbGl0eWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJyNhZGRfbmF0aW9uYWxpdHlfZGl2JykuYWZ0ZXIoaHRtbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0dXJuT25CdXR0b25zKFwibmF0aW9uYWxpdHlcIiwgbmF0aW9uYWxpdHlpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0dXJuT25Ub29sdGlwcyhcIm5hdGlvbmFsaXR5XCIsIG5hdGlvbmFsaXR5aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFrZUVkaXRhYmxlKFwibmF0aW9uYWxpdHlcIiwgbmF0aW9uYWxpdHlpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYXRpb25hbGl0eWlkID0gbmF0aW9uYWxpdHlpZCArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHR1cm5PblRvb2x0aXBzRm9yVGFiKFwibmF0aW9uYWxpdGllc1wiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cblx0dmFyIGZ1bmN0aW9uaWQgPSAxO1xuICAgIHZhciBmdW5jdGlvbk9wZW4gPSBmYWxzZTtcblx0aWYgKCQoJyNmdW5jdGlvbnN0YWInKS5leGlzdHMoKSl7XG5cdFx0JCgnI2Z1bmN0aW9uc3RhYicpLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAvLyBEb24ndCBvcGVuIGEgc2Vjb25kIHRpbWVcbiAgICAgICAgICAgIGlmIChmdW5jdGlvbk9wZW4pXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICAkLmdldChzbmFjVXJsK1wiL2VkaXRfcGFydC9cIiskKCcjY29uc3RlbGxhdGlvbmlkJykudmFsKCkrXCIvXCIrJCgnI3ZlcnNpb24nKS52YWwoKStcIj9wYXJ0PWZ1bmN0aW9uc1wiLCBudWxsLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uT3BlbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgJCgnI2Z1bmN0aW9ucycpLmh0bWwoZGF0YSk7XG5cbiAgICAgICAgICAgICAgICB0dXJuT25FZGl0RGVsZXRlQnV0dG9ucyhcImZ1bmN0aW9uc1wiKTtcblxuICAgICAgICAgICAgICAgIGlmICgkKCcjbmV4dF9mdW5jdGlvbl9pJykuZXhpc3RzKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb25pZCA9IHBhcnNlSW50KCQoJyNuZXh0X2Z1bmN0aW9uX2knKS50ZXh0KCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk5leHQgZnVuY3Rpb24gSUQ6IFwiICsgZnVuY3Rpb25pZCk7XG4gICAgICAgICAgICAgICAgaWYgKCQoJyNidG5fYWRkX2Z1bmN0aW9uJykuZXhpc3RzKCkpe1xuICAgICAgICAgICAgICAgICAgICAkKCcjYnRuX2FkZF9mdW5jdGlvbicpLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRFZGl0ZWRGbGFnKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9zb21ldGhpbmdIYXNCZWVuRWRpdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gJCgnI2Z1bmN0aW9uX3RlbXBsYXRlJykuY2xvbmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBodG1sID0gdGV4dC5odG1sKCkucmVwbGFjZSgvWlovZywgZnVuY3Rpb25pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcjYWRkX2Z1bmN0aW9uX2RpdicpLmFmdGVyKGh0bWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHVybk9uQnV0dG9ucyhcImZ1bmN0aW9uXCIsIGZ1bmN0aW9uaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHVybk9uVG9vbHRpcHMoXCJmdW5jdGlvblwiLCBmdW5jdGlvbmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VFZGl0YWJsZShcImZ1bmN0aW9uXCIsIGZ1bmN0aW9uaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb25pZCA9IGZ1bmN0aW9uaWQgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0dXJuT25Ub29sdGlwc0ZvclRhYihcImZ1bmN0aW9uc1wiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cblx0dmFyIG9jY3VwYXRpb25pZCA9IDE7XG4gICAgdmFyIG9jY3VwYXRpb25PcGVuID0gZmFsc2U7XG5cdGlmICgkKCcjb2NjdXBhdGlvbnN0YWInKS5leGlzdHMoKSl7XG5cdFx0JCgnI29jY3VwYXRpb25zdGFiJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIC8vIERvbid0IG9wZW4gYSBzZWNvbmQgdGltZVxuICAgICAgICAgICAgaWYgKG9jY3VwYXRpb25PcGVuKVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgJC5nZXQoc25hY1VybCtcIi9lZGl0X3BhcnQvXCIrJCgnI2NvbnN0ZWxsYXRpb25pZCcpLnZhbCgpK1wiL1wiKyQoJyN2ZXJzaW9uJykudmFsKCkrXCI/cGFydD1vY2N1cGF0aW9uc1wiLCBudWxsLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIG9jY3VwYXRpb25PcGVuID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAkKCcjb2NjdXBhdGlvbnMnKS5odG1sKGRhdGEpO1xuXG4gICAgICAgICAgICAgICAgdHVybk9uRWRpdERlbGV0ZUJ1dHRvbnMoXCJvY2N1cGF0aW9uc1wiKTtcblxuICAgICAgICAgICAgICAgIGlmICgkKCcjbmV4dF9vY2N1cGF0aW9uX2knKS5leGlzdHMoKSkge1xuICAgICAgICAgICAgICAgICAgICBvY2N1cGF0aW9uaWQgPSBwYXJzZUludCgkKCcjbmV4dF9vY2N1cGF0aW9uX2knKS50ZXh0KCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk5leHQgb2NjdXBhdGlvbiBJRDogXCIgKyBvY2N1cGF0aW9uaWQpO1xuICAgICAgICAgICAgICAgIGlmICgkKCcjYnRuX2FkZF9vY2N1cGF0aW9uJykuZXhpc3RzKCkpe1xuICAgICAgICAgICAgICAgICAgICAkKCcjYnRuX2FkZF9vY2N1cGF0aW9uJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldEVkaXRlZEZsYWcodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3NvbWV0aGluZ0hhc0JlZW5FZGl0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSAkKCcjb2NjdXBhdGlvbl90ZW1wbGF0ZScpLmNsb25lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbCA9IHRleHQuaHRtbCgpLnJlcGxhY2UoL1paL2csIG9jY3VwYXRpb25pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcjYWRkX29jY3VwYXRpb25fZGl2JykuYWZ0ZXIoaHRtbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0dXJuT25CdXR0b25zKFwib2NjdXBhdGlvblwiLCBvY2N1cGF0aW9uaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHVybk9uVG9vbHRpcHMoXCJvY2N1cGF0aW9uXCIsIG9jY3VwYXRpb25pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYWtlRWRpdGFibGUoXCJvY2N1cGF0aW9uXCIsIG9jY3VwYXRpb25pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBvY2N1cGF0aW9uaWQgPSBvY2N1cGF0aW9uaWQgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0dXJuT25Ub29sdGlwc0ZvclRhYihcIm9jY3VwYXRpb25zXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuXHR2YXIgbGVnYWxTdGF0dXNpZCA9IDE7XG4gICAgdmFyIGxlZ2FsU3RhdHVzT3BlbiA9IGZhbHNlO1xuXHRpZiAoJCgnI2xlZ2FsU3RhdHVzZXN0YWInKS5leGlzdHMoKSl7XG5cdFx0JCgnI2xlZ2FsU3RhdHVzZXN0YWInKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAgICAgLy8gRG9uJ3Qgb3BlbiBhIHNlY29uZCB0aW1lXG4gICAgICAgICAgICBpZiAobGVnYWxTdGF0dXNPcGVuKVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgJC5nZXQoc25hY1VybCtcIi9lZGl0X3BhcnQvXCIrJCgnI2NvbnN0ZWxsYXRpb25pZCcpLnZhbCgpK1wiL1wiKyQoJyN2ZXJzaW9uJykudmFsKCkrXCI/cGFydD1sZWdhbFN0YXR1c2VzXCIsIG51bGwsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgbGVnYWxTdGF0dXNPcGVuID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAkKCcjbGVnYWxTdGF0dXNlcycpLmh0bWwoZGF0YSk7XG5cbiAgICAgICAgICAgICAgICB0dXJuT25FZGl0RGVsZXRlQnV0dG9ucyhcImxlZ2FsU3RhdHVzZXNcIik7XG5cbiAgICAgICAgICAgICAgICBpZiAoJCgnI25leHRfbGVnYWxTdGF0dXNfaScpLmV4aXN0cygpKSB7XG4gICAgICAgICAgICAgICAgICAgIGxlZ2FsU3RhdHVzaWQgPSBwYXJzZUludCgkKCcjbmV4dF9sZWdhbFN0YXR1c19pJykudGV4dCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJOZXh0IGxlZ2FsU3RhdHVzIElEOiBcIiArIGxlZ2FsU3RhdHVzaWQpO1xuICAgICAgICAgICAgICAgIGlmICgkKCcjYnRuX2FkZF9sZWdhbFN0YXR1cycpLmV4aXN0cygpKXtcbiAgICAgICAgICAgICAgICAgICAgJCgnI2J0bl9hZGRfbGVnYWxTdGF0dXMnKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0RWRpdGVkRmxhZyh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vc29tZXRoaW5nSGFzQmVlbkVkaXRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9ICQoJyNsZWdhbFN0YXR1c190ZW1wbGF0ZScpLmNsb25lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbCA9IHRleHQuaHRtbCgpLnJlcGxhY2UoL1paL2csIGxlZ2FsU3RhdHVzaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2FkZF9sZWdhbFN0YXR1c19kaXYnKS5hZnRlcihodG1sKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR1cm5PbkJ1dHRvbnMoXCJsZWdhbFN0YXR1c1wiLCBsZWdhbFN0YXR1c2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR1cm5PblRvb2x0aXBzKFwibGVnYWxTdGF0dXNcIiwgbGVnYWxTdGF0dXNpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYWtlRWRpdGFibGUoXCJsZWdhbFN0YXR1c1wiLCBsZWdhbFN0YXR1c2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlZ2FsU3RhdHVzaWQgPSBsZWdhbFN0YXR1c2lkICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdHVybk9uVG9vbHRpcHNGb3JUYWIoXCJsZWdhbFN0YXR1c2VzXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuXHR2YXIgcGxhY2VpZCA9IDE7XG4gICAgdmFyIHBsYWNlT3BlbiA9IGZhbHNlO1xuXHRpZiAoJCgnI3BsYWNlc3RhYicpLmV4aXN0cygpKXtcblx0XHQkKCcjcGxhY2VzdGFiJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIC8vIERvbid0IG9wZW4gYSBzZWNvbmQgdGltZVxuICAgICAgICAgICAgaWYgKHBsYWNlT3BlbilcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgICQuZ2V0KHNuYWNVcmwrXCIvZWRpdF9wYXJ0L1wiKyQoJyNjb25zdGVsbGF0aW9uaWQnKS52YWwoKStcIi9cIiskKCcjdmVyc2lvbicpLnZhbCgpK1wiP3BhcnQ9cGxhY2VzXCIsIG51bGwsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgcGxhY2VPcGVuID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAkKCcjcGxhY2VzJykuaHRtbChkYXRhKTtcblxuICAgICAgICAgICAgICAgIC8vIExvYWQgdGhlIHBsYWNlIGNhY2hlLCBpZiBuZWVkZWRcbiAgICAgICAgICAgICAgICBsb2FkR2VvUGxhY2VSZXN1bHRDYWNoZSgpO1xuXG4gICAgICAgICAgICAgICAgdHVybk9uRWRpdERlbGV0ZUJ1dHRvbnMoXCJwbGFjZXNcIik7XG5cbiAgICAgICAgICAgICAgICBpZiAoJCgnI25leHRfcGxhY2VfaScpLmV4aXN0cygpKSB7XG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaWQgPSBwYXJzZUludCgkKCcjbmV4dF9wbGFjZV9pJykudGV4dCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJOZXh0IHBsYWNlIElEOiBcIiArIHBsYWNlaWQpO1xuICAgICAgICAgICAgICAgIGlmICgkKCcjYnRuX2FkZF9wbGFjZScpLmV4aXN0cygpKXtcbiAgICAgICAgICAgICAgICAgICAgJCgnI2J0bl9hZGRfcGxhY2UnKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0RWRpdGVkRmxhZyh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vc29tZXRoaW5nSGFzQmVlbkVkaXRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9ICQoJyNwbGFjZV90ZW1wbGF0ZScpLmNsb25lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbCA9IHRleHQuaHRtbCgpLnJlcGxhY2UoL1paL2csIHBsYWNlaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2FkZF9wbGFjZV9kaXYnKS5hZnRlcihodG1sKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR1cm5PbkJ1dHRvbnMoXCJwbGFjZVwiLCBwbGFjZWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR1cm5PblRvb2x0aXBzKFwicGxhY2VcIiwgcGxhY2VpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYWtlRWRpdGFibGUoXCJwbGFjZVwiLCBwbGFjZWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaWQgPSBwbGFjZWlkICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdHVybk9uVG9vbHRpcHNGb3JUYWIoXCJwbGFjZXNcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG5cdHZhciBjb252ZW50aW9uRGVjbGFyYXRpb25pZCA9IDE7XG4gICAgdmFyIGNvbnZlbnRpb25EZWNsYXJhdGlvbk9wZW4gPSBmYWxzZTtcblx0aWYgKCQoJyNjb252ZW50aW9uRGVjbGFyYXRpb25zdGFiJykuZXhpc3RzKCkpe1xuXHRcdCQoJyNjb252ZW50aW9uRGVjbGFyYXRpb25zdGFiJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIC8vIERvbid0IG9wZW4gYSBzZWNvbmQgdGltZVxuICAgICAgICAgICAgaWYgKGNvbnZlbnRpb25EZWNsYXJhdGlvbk9wZW4pXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICAkLmdldChzbmFjVXJsK1wiL2VkaXRfcGFydC9cIiskKCcjY29uc3RlbGxhdGlvbmlkJykudmFsKCkrXCIvXCIrJCgnI3ZlcnNpb24nKS52YWwoKStcIj9wYXJ0PWNvbnZlbnRpb25EZWNsYXJhdGlvbnNcIiwgbnVsbCwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBjb252ZW50aW9uRGVjbGFyYXRpb25PcGVuID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAkKCcjY29udmVudGlvbkRlY2xhcmF0aW9ucycpLmh0bWwoZGF0YSk7XG5cbiAgICAgICAgICAgICAgICB0dXJuT25FZGl0RGVsZXRlQnV0dG9ucyhcImNvbnZlbnRpb25EZWNsYXJhdGlvbnNcIik7XG5cbiAgICAgICAgICAgICAgICBpZiAoJCgnI25leHRfY29udmVudGlvbkRlY2xhcmF0aW9uX2knKS5leGlzdHMoKSkge1xuICAgICAgICAgICAgICAgICAgICBjb252ZW50aW9uRGVjbGFyYXRpb25pZCA9IHBhcnNlSW50KCQoJyNuZXh0X2NvbnZlbnRpb25EZWNsYXJhdGlvbl9pJykudGV4dCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJOZXh0IGNvbnZlbnRpb25EZWNsYXJhdGlvbiBJRDogXCIgKyBjb252ZW50aW9uRGVjbGFyYXRpb25pZCk7XG4gICAgICAgICAgICAgICAgaWYgKCQoJyNidG5fYWRkX2NvbnZlbnRpb25EZWNsYXJhdGlvbicpLmV4aXN0cygpKXtcbiAgICAgICAgICAgICAgICAgICAgJCgnI2J0bl9hZGRfY29udmVudGlvbkRlY2xhcmF0aW9uJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldEVkaXRlZEZsYWcodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3NvbWV0aGluZ0hhc0JlZW5FZGl0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSAkKCcjY29udmVudGlvbkRlY2xhcmF0aW9uX3RlbXBsYXRlJykuY2xvbmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBodG1sID0gdGV4dC5odG1sKCkucmVwbGFjZSgvWlovZywgY29udmVudGlvbkRlY2xhcmF0aW9uaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2FkZF9jb252ZW50aW9uRGVjbGFyYXRpb25fZGl2JykuYWZ0ZXIoaHRtbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0dXJuT25CdXR0b25zKFwiY29udmVudGlvbkRlY2xhcmF0aW9uXCIsIGNvbnZlbnRpb25EZWNsYXJhdGlvbmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR1cm5PblRvb2x0aXBzKFwiY29udmVudGlvbkRlY2xhcmF0aW9uXCIsIGNvbnZlbnRpb25EZWNsYXJhdGlvbmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VFZGl0YWJsZShcImNvbnZlbnRpb25EZWNsYXJhdGlvblwiLCBjb252ZW50aW9uRGVjbGFyYXRpb25pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb252ZW50aW9uRGVjbGFyYXRpb25pZCA9IGNvbnZlbnRpb25EZWNsYXJhdGlvbmlkICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdHVybk9uVG9vbHRpcHNGb3JUYWIoXCJjb252ZW50aW9uRGVjbGFyYXRpb25zXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuXHR2YXIgZ2VuZXJhbENvbnRleHRpZCA9IDE7XG4gICAgdmFyIGdlbmVyYWxDb250ZXh0T3BlbiA9IGZhbHNlO1xuXHRpZiAoJCgnI2dlbmVyYWxDb250ZXh0c3RhYicpLmV4aXN0cygpKXtcblx0XHQkKCcjZ2VuZXJhbENvbnRleHRzdGFiJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIC8vIERvbid0IG9wZW4gYSBzZWNvbmQgdGltZVxuICAgICAgICAgICAgaWYgKGdlbmVyYWxDb250ZXh0T3BlbilcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgICQuZ2V0KHNuYWNVcmwrXCIvZWRpdF9wYXJ0L1wiKyQoJyNjb25zdGVsbGF0aW9uaWQnKS52YWwoKStcIi9cIiskKCcjdmVyc2lvbicpLnZhbCgpK1wiP3BhcnQ9Z2VuZXJhbENvbnRleHRzXCIsIG51bGwsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgZ2VuZXJhbENvbnRleHRPcGVuID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAkKCcjZ2VuZXJhbENvbnRleHRzJykuaHRtbChkYXRhKTtcblxuICAgICAgICAgICAgICAgIHR1cm5PbkVkaXREZWxldGVCdXR0b25zKFwiZ2VuZXJhbENvbnRleHRzXCIpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCQoJyNuZXh0X2dlbmVyYWxDb250ZXh0X2knKS5leGlzdHMoKSkge1xuICAgICAgICAgICAgICAgICAgICBnZW5lcmFsQ29udGV4dGlkID0gcGFyc2VJbnQoJCgnI25leHRfZ2VuZXJhbENvbnRleHRfaScpLnRleHQoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTmV4dCBnZW5lcmFsQ29udGV4dCBJRDogXCIgKyBnZW5lcmFsQ29udGV4dGlkKTtcbiAgICAgICAgICAgICAgICBpZiAoJCgnI2J0bl9hZGRfZ2VuZXJhbENvbnRleHQnKS5leGlzdHMoKSl7XG4gICAgICAgICAgICAgICAgICAgICQoJyNidG5fYWRkX2dlbmVyYWxDb250ZXh0JykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldEVkaXRlZEZsYWcodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3NvbWV0aGluZ0hhc0JlZW5FZGl0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSAkKCcjZ2VuZXJhbENvbnRleHRfdGVtcGxhdGUnKS5jbG9uZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWwgPSB0ZXh0Lmh0bWwoKS5yZXBsYWNlKC9aWi9nLCBnZW5lcmFsQ29udGV4dGlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJyNhZGRfZ2VuZXJhbENvbnRleHRfZGl2JykuYWZ0ZXIoaHRtbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0dXJuT25CdXR0b25zKFwiZ2VuZXJhbENvbnRleHRcIiwgZ2VuZXJhbENvbnRleHRpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0dXJuT25Ub29sdGlwcyhcImdlbmVyYWxDb250ZXh0XCIsIGdlbmVyYWxDb250ZXh0aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFrZUVkaXRhYmxlKFwiZ2VuZXJhbENvbnRleHRcIiwgZ2VuZXJhbENvbnRleHRpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBnZW5lcmFsQ29udGV4dGlkID0gZ2VuZXJhbENvbnRleHRpZCArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHR1cm5PblRvb2x0aXBzRm9yVGFiKFwiZ2VuZXJhbENvbnRleHRzXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuXHR2YXIgc3RydWN0dXJlT3JHZW5lYWxvZ3lpZCA9IDE7XG4gICAgdmFyIHN0cnVjdHVyZU9yR2VuZWFsb2d5T3BlbiA9IGZhbHNlO1xuXHRpZiAoJCgnI3N0cnVjdHVyZU9yR2VuZWFsb2dpZXN0YWInKS5leGlzdHMoKSl7XG5cdFx0JCgnI3N0cnVjdHVyZU9yR2VuZWFsb2dpZXN0YWInKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAgICAgLy8gRG9uJ3Qgb3BlbiBhIHNlY29uZCB0aW1lXG4gICAgICAgICAgICBpZiAoc3RydWN0dXJlT3JHZW5lYWxvZ3lPcGVuKVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgJC5nZXQoc25hY1VybCtcIi9lZGl0X3BhcnQvXCIrJCgnI2NvbnN0ZWxsYXRpb25pZCcpLnZhbCgpK1wiL1wiKyQoJyN2ZXJzaW9uJykudmFsKCkrXCI/cGFydD1zdHJ1Y3R1cmVPckdlbmVhbG9naWVzXCIsIG51bGwsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgc3RydWN0dXJlT3JHZW5lYWxvZ3lPcGVuID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAkKCcjc3RydWN0dXJlT3JHZW5lYWxvZ2llcycpLmh0bWwoZGF0YSk7XG5cbiAgICAgICAgICAgICAgICB0dXJuT25FZGl0RGVsZXRlQnV0dG9ucyhcInN0cnVjdHVyZU9yR2VuZWFsb2dpZXNcIik7XG5cbiAgICAgICAgICAgICAgICBpZiAoJCgnI25leHRfc3RydWN0dXJlT3JHZW5lYWxvZ3lfaScpLmV4aXN0cygpKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0cnVjdHVyZU9yR2VuZWFsb2d5aWQgPSBwYXJzZUludCgkKCcjbmV4dF9zdHJ1Y3R1cmVPckdlbmVhbG9neV9pJykudGV4dCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJOZXh0IHN0cnVjdHVyZU9yR2VuZWFsb2d5IElEOiBcIiArIHN0cnVjdHVyZU9yR2VuZWFsb2d5aWQpO1xuICAgICAgICAgICAgICAgIGlmICgkKCcjYnRuX2FkZF9zdHJ1Y3R1cmVPckdlbmVhbG9neScpLmV4aXN0cygpKXtcbiAgICAgICAgICAgICAgICAgICAgJCgnI2J0bl9hZGRfc3RydWN0dXJlT3JHZW5lYWxvZ3knKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0RWRpdGVkRmxhZyh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vc29tZXRoaW5nSGFzQmVlbkVkaXRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9ICQoJyNzdHJ1Y3R1cmVPckdlbmVhbG9neV90ZW1wbGF0ZScpLmNsb25lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbCA9IHRleHQuaHRtbCgpLnJlcGxhY2UoL1paL2csIHN0cnVjdHVyZU9yR2VuZWFsb2d5aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2FkZF9zdHJ1Y3R1cmVPckdlbmVhbG9neV9kaXYnKS5hZnRlcihodG1sKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR1cm5PbkJ1dHRvbnMoXCJzdHJ1Y3R1cmVPckdlbmVhbG9neVwiLCBzdHJ1Y3R1cmVPckdlbmVhbG9neWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR1cm5PblRvb2x0aXBzKFwic3RydWN0dXJlT3JHZW5lYWxvZ3lcIiwgc3RydWN0dXJlT3JHZW5lYWxvZ3lpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYWtlRWRpdGFibGUoXCJzdHJ1Y3R1cmVPckdlbmVhbG9neVwiLCBzdHJ1Y3R1cmVPckdlbmVhbG9neWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdHVyZU9yR2VuZWFsb2d5aWQgPSBzdHJ1Y3R1cmVPckdlbmVhbG9neWlkICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdHVybk9uVG9vbHRpcHNGb3JUYWIoXCJzdHJ1Y3R1cmVPckdlbmVhbG9naWVzXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuXHR2YXIgbWFuZGF0ZWlkID0gMTtcbiAgICB2YXIgbWFuZGF0ZU9wZW4gPSBmYWxzZTtcblx0aWYgKCQoJyNtYW5kYXRlc3RhYicpLmV4aXN0cygpKXtcblx0XHQkKCcjbWFuZGF0ZXN0YWInKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAgICAgLy8gRG9uJ3Qgb3BlbiBhIHNlY29uZCB0aW1lXG4gICAgICAgICAgICBpZiAobWFuZGF0ZU9wZW4pXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICAkLmdldChzbmFjVXJsK1wiL2VkaXRfcGFydC9cIiskKCcjY29uc3RlbGxhdGlvbmlkJykudmFsKCkrXCIvXCIrJCgnI3ZlcnNpb24nKS52YWwoKStcIj9wYXJ0PW1hbmRhdGVzXCIsIG51bGwsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgbWFuZGF0ZU9wZW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgICQoJyNtYW5kYXRlcycpLmh0bWwoZGF0YSk7XG5cbiAgICAgICAgICAgICAgICB0dXJuT25FZGl0RGVsZXRlQnV0dG9ucyhcIm1hbmRhdGVzXCIpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCQoJyNuZXh0X21hbmRhdGVfaScpLmV4aXN0cygpKSB7XG4gICAgICAgICAgICAgICAgICAgIG1hbmRhdGVpZCA9IHBhcnNlSW50KCQoJyNuZXh0X21hbmRhdGVfaScpLnRleHQoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTmV4dCBtYW5kYXRlIElEOiBcIiArIG1hbmRhdGVpZCk7XG4gICAgICAgICAgICAgICAgaWYgKCQoJyNidG5fYWRkX21hbmRhdGUnKS5leGlzdHMoKSl7XG4gICAgICAgICAgICAgICAgICAgICQoJyNidG5fYWRkX21hbmRhdGUnKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0RWRpdGVkRmxhZyh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vc29tZXRoaW5nSGFzQmVlbkVkaXRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9ICQoJyNtYW5kYXRlX3RlbXBsYXRlJykuY2xvbmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBodG1sID0gdGV4dC5odG1sKCkucmVwbGFjZSgvWlovZywgbWFuZGF0ZWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJyNhZGRfbWFuZGF0ZV9kaXYnKS5hZnRlcihodG1sKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR1cm5PbkJ1dHRvbnMoXCJtYW5kYXRlXCIsIG1hbmRhdGVpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0dXJuT25Ub29sdGlwcyhcIm1hbmRhdGVcIiwgbWFuZGF0ZWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VFZGl0YWJsZShcIm1hbmRhdGVcIiwgbWFuZGF0ZWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hbmRhdGVpZCA9IG1hbmRhdGVpZCArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHR1cm5PblRvb2x0aXBzRm9yVGFiKFwibWFuZGF0ZXNcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG5cdHZhciBiaW9nSGlzdGlkID0gMTtcbiAgICB2YXIgYmlvZ0hpc3RPcGVuID0gZmFsc2U7XG5cdGlmICgkKCcjYmlvZ0hpc3RzdGFiJykuZXhpc3RzKCkpe1xuXHRcdCQoJyNiaW9nSGlzdHN0YWInKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAgICAgLy8gRG9uJ3Qgb3BlbiBhIHNlY29uZCB0aW1lXG4gICAgICAgICAgICBpZiAoYmlvZ0hpc3RPcGVuKVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgJC5nZXQoc25hY1VybCtcIi9lZGl0X3BhcnQvXCIrJCgnI2NvbnN0ZWxsYXRpb25pZCcpLnZhbCgpK1wiL1wiKyQoJyN2ZXJzaW9uJykudmFsKCkrXCI/cGFydD1iaW9nSGlzdHNcIiwgbnVsbCwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBiaW9nSGlzdE9wZW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgICQoJyNiaW9nSGlzdHMnKS5odG1sKGRhdGEpO1xuXG4gICAgICAgICAgICAgICAgdHVybk9uRWRpdERlbGV0ZUJ1dHRvbnMoXCJiaW9nSGlzdHNcIik7XG5cbiAgICAgICAgICAgICAgICBpZiAoJCgnI25leHRfYmlvZ0hpc3RfaScpLmV4aXN0cygpKSB7XG4gICAgICAgICAgICAgICAgICAgIGJpb2dIaXN0aWQgPSBwYXJzZUludCgkKCcjbmV4dF9iaW9nSGlzdF9pJykudGV4dCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJOZXh0IGJpb2dIaXN0IElEOiBcIiArIGJpb2dIaXN0aWQpO1xuICAgICAgICAgICAgICAgIGlmICgkKCcjYnRuX2FkZF9iaW9nSGlzdCcpLmV4aXN0cygpKXtcbiAgICAgICAgICAgICAgICAgICAgJCgnI2J0bl9hZGRfYmlvZ0hpc3QnKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0RWRpdGVkRmxhZyh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vc29tZXRoaW5nSGFzQmVlbkVkaXRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9ICQoJyNiaW9nSGlzdF90ZW1wbGF0ZScpLmNsb25lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbCA9IHRleHQuaHRtbCgpLnJlcGxhY2UoL1paL2csIGJpb2dIaXN0aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2FkZF9iaW9nSGlzdF9kaXYnKS5hZnRlcihodG1sKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR1cm5PbkJ1dHRvbnMoXCJiaW9nSGlzdFwiLCBiaW9nSGlzdGlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR1cm5PblRvb2x0aXBzKFwiYmlvZ0hpc3RcIiwgYmlvZ0hpc3RpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYWtlRWRpdGFibGUoXCJiaW9nSGlzdFwiLCBiaW9nSGlzdGlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJpb2dIaXN0aWQgPSBiaW9nSGlzdGlkICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdHVybk9uVG9vbHRpcHNGb3JUYWIoXCJiaW9nSGlzdHNcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgdHVybk9uVG9vbHRpcHNGb3JUYWIoKTtcblxuXG4gICAgJChcIiNpbmZvLWRyb3Bkb3duXCIpLmNsaWNrKGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS50b2dnbGVDbGFzcyhcIm9wZW5cIik7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgfSk7XG5cbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7Ozs7Ozs7Ozs7O0FBV0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFGQTtBQUxBO0FBQ0E7QUFZQTs7Ozs7OztBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBVUE7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7OztBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7OztBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7OztBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7QUFXQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7QUFjQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFRQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7QUFhQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7O0FBVUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFYQTtBQUNBO0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7OztBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTs7Ozs7Ozs7OztBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7O0FBV0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7O0FBV0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7OztBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7OztBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7O0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUdBO0FBQ0E7QUFDQTs7Ozs7OztBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7O0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7OztBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7OztBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQU9BO0FBQ0E7QUFDQTtBQUhBO0FBT0E7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQURBO0FBR0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUFZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7OztBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUFZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQVlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU1BO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///3\n");

/***/ })

/******/ })));